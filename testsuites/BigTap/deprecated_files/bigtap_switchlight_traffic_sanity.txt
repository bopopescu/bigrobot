*Settings
Documentation  BigTap SwitchLight Traffic Test Suite
Suite Setup  bigtap suite setup
Suite Teardown   bigtap suite teardown
Test Setup   traffic test setup
Test Teardown  traffic teardown 
Force Tags   platform Sanity
Library  keywords/BsnCommon.py
Library  keywords/AppController.py
Library  keywords/BigTap.py
Library  keywords/SwitchLight.py
Library  keywords/Ixia.py

* Variable
${policy_name_1}  TLB9
${filter_1}  ethernet1  
${filter_nick_1}  ixia-2-3
${delivery_1}  ethernet2  
${delivery_nick_1}  ixia-2-4

${policy_name_2}  TLY2
${filter_2}  ethernet1  
${filter_nick_2}  ixia-4-2
${delivery_2}  ethernet2  
${delivery_nick_2}  ixia-4-3

${policy_name_3}  TAS4600
${filter_3}  ethernet1  
${filter_nick_3}  ixia-2-1
${delivery_3}  ethernet2  
${delivery_nick_3}  ixia-2-2

${policy_name_4}  TAS5610
${filter_4}  ethernet1  
${filter_nick_4}  ixia-1-1
${delivery_4}  ethernet2  
${delivery_nick_4}  ixia-1-2

${policy_name_5}  TAS5710
${filter_5}  ethernet1  
${filter_nick_5}  ixia-1-5
${delivery_5}  ethernet2  
${delivery_nick_5}  ixia-1-6

${policy_name_6}  TS4810
${filter_6}  ethernet1  
${filter_nick_6}  ixia-1-4
${delivery_6}  ethernet2  
${delivery_nick_6}  ixia-1-3

*Test Case

### L2 Traffic
#### L2 Traffic: Frame Size 64 Bytes
Verify L2 traffic on LB9: frame size 64 bytes
    ${verify_policy1}=  rest verify bigtap policy  ${policy_name_1}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy1}
    ${stream}=  L2 add  flow=a->b  line_rate=100  frame_size=64  name=a_b_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  a  b  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  lb9  fs64  

Verify L2 traffic on LY2: frame size 64 bytes
    ${verify_policy2}=  rest verify bigtap policy  ${policy_name_2}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy2}
    ${stream}=  L2 add  flow=c->d  line_rate=100  frame_size=64  name=c_d_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  c  d  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ly2  fs64  

Verify L2 traffic on Accton 4600: frame size 64 bytes
    ${verify_policy3}=  rest verify bigtap policy  ${policy_name_3}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy3}
    ${stream}=  L2 add  flow=e->f  line_rate=100  frame_size=64  name=e_f_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  e  f  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac4600  fs64

Verify L2 traffic on Accton 5610: frame size 64 bytes
    ${verify_policy4}=  rest verify bigtap policy  ${policy_name_4}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy4}
    ${stream}=  L2 add  flow=g->h  line_rate=100  frame_size=64  name=g_h_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  g  h  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac5610  fs64

Verify L2 traffic on Accton 5710: frame size 64 bytes
    ${verify_policy5}=  rest verify bigtap policy  ${policy_name_5}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy5}
    ${stream}=  L2 add  flow=i->j  frame_rate=100000  frame_size=64  name=i_j_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  i  j  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac5710  fs64


Verify L2 traffic on Dell S4810: frame size 64 bytes
    ${verify_policy6}=  rest verify bigtap policy  ${policy_name_6}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy6}
    ${stream_s4810}=  L2 add  flow=k->l  line_rate=100  frame_size=64  name=k_l_flow
    clear stats    
    start traffic  ${stream_s4810}
    sleep  10
    verify results  k  l  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream_s4810}
    [Tags]  l2  s4810  fs64
    
#### L2 Traffic: Frame Size 128 Bytes
Verify L2 traffic on LB9: frame size 128 bytes
    ${verify_policy1}=  rest verify bigtap policy  ${policy_name_1}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy1}
    ${stream}=  L2 add  flow=a->b  line_rate=100  frame_size=128  name=a_b_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  a  b  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  lb9  fs128  

Verify L2 traffic on LY2: frame size 128 bytes
    ${verify_policy2}=  rest verify bigtap policy  ${policy_name_2}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy2}
    ${stream}=  L2 add  flow=c->d  line_rate=100  frame_size=128  name=c_d_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  c  d  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ly2  fs128  

Verify L2 traffic on Accton 4600: frame size 128 bytes
    ${verify_policy3}=  rest verify bigtap policy  ${policy_name_3}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy3}
    ${stream}=  L2 add  flow=e->f  line_rate=100  frame_size=128  name=e_f_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  e  f  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac4600  fs128

Verify L2 traffic on Accton 5610: frame size 128 bytes
    ${verify_policy4}=  rest verify bigtap policy  ${policy_name_4}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy4}
    ${stream}=  L2 add  flow=g->h  line_rate=100  frame_size=128  name=g_h_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  g  h  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac5610  fs128

Verify L2 traffic on Accton 5710: frame size 128 bytes
    ${verify_policy5}=  rest verify bigtap policy  ${policy_name_5}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy5}
    ${stream}=  L2 add  flow=i->j  frame_rate=100000  frame_size=128  name=i_j_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  i  j  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac5710  fs128


Verify L2 traffic on Dell S4810: frame size 128 bytes
    ${verify_policy6}=  rest verify bigtap policy  ${policy_name_6}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy6}
    ${stream_s4810}=  L2 add  flow=k->l  line_rate=100  frame_size=128  name=k_l_flow
    clear stats    
    start traffic  ${stream_s4810}
    sleep  10
    verify results  k  l  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream_s4810}
    [Tags]  l2  s4810  fs128
    
#### L2 Traffic: Frame Size 256 Bytes

Verify L2 traffic on LB9: frame size 256 bytes
    ${verify_policy1}=  rest verify bigtap policy  ${policy_name_1}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy1}
    ${stream}=  L2 add  flow=a->b  line_rate=100  frame_size=256  name=a_b_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  a  b  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  lb9  fs256  

Verify L2 traffic on LY2: frame size 256 bytes
    ${verify_policy2}=  rest verify bigtap policy  ${policy_name_2}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy2}
    ${stream}=  L2 add  flow=c->d  line_rate=100  frame_size=256  name=c_d_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  c  d  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ly2  fs256  

Verify L2 traffic on Accton 4600: frame size 256 bytes
    ${verify_policy3}=  rest verify bigtap policy  ${policy_name_3}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy3}
    ${stream}=  L2 add  flow=e->f  line_rate=100  frame_size=256  name=e_f_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  e  f  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac4600  fs256

Verify L2 traffic on Accton 5610: frame size 256 bytes
    ${verify_policy4}=  rest verify bigtap policy  ${policy_name_4}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy4}
    ${stream}=  L2 add  flow=g->h  line_rate=100  frame_size=256  name=g_h_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  g  h  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac5610  fs256

Verify L2 traffic on Accton 5710: frame size 256 bytes
    ${verify_policy5}=  rest verify bigtap policy  ${policy_name_5}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy5}
    ${stream}=  L2 add  flow=i->j  frame_rate=100000  frame_size=256  name=i_j_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  i  j  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac5710  fs256


Verify L2 traffic on Dell S4810: frame size 256 bytes
    ${verify_policy6}=  rest verify bigtap policy  ${policy_name_6}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy6}
    ${stream_s4810}=  L2 add  flow=k->l  line_rate=100  frame_size=256  name=k_l_flow
    clear stats    
    start traffic  ${stream_s4810}
    sleep  10
    verify results  k  l  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream_s4810}
    [Tags]  l2  s4810  fs256
    
#### L2 Traffic : Frame Size 512 Bytes

Verify L2 traffic on LB9: frame size 512 bytes
    ${verify_policy1}=  rest verify bigtap policy  ${policy_name_1}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy1}
    ${stream}=  L2 add  flow=a->b  line_rate=100  frame_size=512  name=a_b_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  a  b  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  lb9  fs512  

Verify L2 traffic on LY2: frame size 512 bytes
    ${verify_policy2}=  rest verify bigtap policy  ${policy_name_2}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy2}
    ${stream}=  L2 add  flow=c->d  line_rate=512  frame_size=256  name=c_d_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  c  d  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ly2  fs512  

Verify L2 traffic on Accton 4600: frame size 512 bytes
    ${verify_policy3}=  rest verify bigtap policy  ${policy_name_3}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy3}
    ${stream}=  L2 add  flow=e->f  line_rate=100  frame_size=512  name=e_f_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  e  f  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac4600  fs512

Verify L2 traffic on Accton 5610: frame size 512 bytes
    ${verify_policy4}=  rest verify bigtap policy  ${policy_name_4}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy4}
    ${stream}=  L2 add  flow=g->h  line_rate=100  frame_size=512  name=g_h_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  g  h  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac5610  fs512

Verify L2 traffic on Accton 5710: frame size 512 bytes
    ${verify_policy5}=  rest verify bigtap policy  ${policy_name_5}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy5}
    ${stream}=  L2 add  flow=i->j  frame_rate=100000  frame_size=512  name=i_j_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  i  j  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac5710  fs512


Verify L2 traffic on Dell S4810: frame size 512 bytes
    ${verify_policy6}=  rest verify bigtap policy  ${policy_name_6}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy6}
    ${stream_s4810}=  L2 add  flow=k->l  line_rate=100  frame_size=512  name=k_l_flow
    clear stats    
    start traffic  ${stream_s4810}
    sleep  10
    verify results  k  l  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream_s4810}
    [Tags]  l2  s4810  fs512
    
#### L2 Traffic : Frame Size 1024 Bytes

Verify L2 traffic on LB9: frame size 1024 bytes
    ${verify_policy1}=  rest verify bigtap policy  ${policy_name_1}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy1}
    ${stream}=  L2 add  flow=a->b  line_rate=100  frame_size=1024  name=a_b_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  a  b  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  lb9  fs1024  

Verify L2 traffic on LY2: frame size 1024 bytes
    ${verify_policy2}=  rest verify bigtap policy  ${policy_name_2}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy2}
    ${stream}=  L2 add  flow=c->d  line_rate=512  frame_size=1024  name=c_d_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  c  d  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ly2  fs1024  

Verify L2 traffic on Accton 4600: frame size 1024 bytes
    ${verify_policy3}=  rest verify bigtap policy  ${policy_name_3}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy3}
    ${stream}=  L2 add  flow=e->f  line_rate=100  frame_size=1024  name=e_f_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  e  f  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac4600  fs1024

Verify L2 traffic on Accton 5610: frame size 1024 bytes
    ${verify_policy4}=  rest verify bigtap policy  ${policy_name_4}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy4}
    ${stream}=  L2 add  flow=g->h  line_rate=100  frame_size=1024  name=g_h_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  g  h  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac5610  fs1024

Verify L2 traffic on Accton 5710: frame size 1024 bytes
    ${verify_policy5}=  rest verify bigtap policy  ${policy_name_5}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy5}
    ${stream}=  L2 add  flow=i->j  frame_rate=100000  frame_size=1024  name=i_j_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  i  j  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac5710  fs1024


Verify L2 traffic on Dell S4810: frame size 1024 bytes
    ${verify_policy6}=  rest verify bigtap policy  ${policy_name_6}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy6}
    ${stream_s4810}=  L2 add  flow=k->l  line_rate=100  frame_size=1024  name=k_l_flow
    clear stats    
    start traffic  ${stream_s4810}
    sleep  10
    verify results  k  l  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream_s4810}
    [Tags]  l2  s4810  fs1024
    
#### L2 Traffic : Frame Size 1280 Bytes

Verify L2 traffic on LB9: frame size 1280 bytes
    ${verify_policy1}=  rest verify bigtap policy  ${policy_name_1}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy1}
    ${stream}=  L2 add  flow=a->b  line_rate=100  frame_size=1280  name=a_b_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  a  b  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  lb9  fs1280  

Verify L2 traffic on LY2: frame size 1280 bytes
    ${verify_policy2}=  rest verify bigtap policy  ${policy_name_2}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy2}
    ${stream}=  L2 add  flow=c->d  line_rate=512  frame_size=1280  name=c_d_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  c  d  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ly2  fs1280  

Verify L2 traffic on Accton 4600: frame size 1280 bytes
    ${verify_policy3}=  rest verify bigtap policy  ${policy_name_3}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy3}
    ${stream}=  L2 add  flow=e->f  line_rate=100  frame_size=1280  name=e_f_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  e  f  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac4600  fs1280

Verify L2 traffic on Accton 5610: frame size 1280 bytes
    ${verify_policy4}=  rest verify bigtap policy  ${policy_name_4}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy4}
    ${stream}=  L2 add  flow=g->h  line_rate=100  frame_size=1280  name=g_h_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  g  h  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac5610  fs1280

Verify L2 traffic on Accton 5710: frame size 1280 bytes
    ${verify_policy5}=  rest verify bigtap policy  ${policy_name_5}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy5}
    ${stream}=  L2 add  flow=i->j  frame_rate=100000  frame_size=1280  name=i_j_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  i  j  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac5710  fs1280

Verify L2 traffic on Dell S4810: frame size 1280 bytes
    ${verify_policy6}=  rest verify bigtap policy  ${policy_name_6}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy6}
    ${stream_s4810}=  L2 add  flow=k->l  line_rate=100  frame_size=1280  name=k_l_flow
    clear stats    
    start traffic  ${stream_s4810}
    sleep  10
    verify results  k  l  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream_s4810}
    [Tags]  l2  s4810  fs1280
    
#### L2 Traffic : Frame Size 1518 Bytes

Verify L2 traffic on LB9: frame size 1518 bytes
    ${verify_policy1}=  rest verify bigtap policy  ${policy_name_1}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy1}
    ${stream}=  L2 add  flow=a->b  line_rate=100  frame_size=1518  name=a_b_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  a  b  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  lb9  fs1518  

Verify L2 traffic on LY2: frame size 1518 bytes
    ${verify_policy2}=  rest verify bigtap policy  ${policy_name_2}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy2}
    ${stream}=  L2 add  flow=c->d  line_rate=512  frame_size=1518  name=c_d_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  c  d  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ly2  fs1518  

Verify L2 traffic on Accton 4600: frame size 1518 bytes
    ${verify_policy3}=  rest verify bigtap policy  ${policy_name_3}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy3}
    ${stream}=  L2 add  flow=e->f  line_rate=100  frame_size=1518  name=e_f_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  e  f  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac4600  fs1518

Verify L2 traffic on Accton 5610: frame size 1518 bytes
    ${verify_policy4}=  rest verify bigtap policy  ${policy_name_4}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy4}
    ${stream}=  L2 add  flow=g->h  line_rate=100  frame_size=1518  name=g_h_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  g  h  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac5610  fs1518

Verify L2 traffic on Accton 5710: frame size 1518 bytes
    ${verify_policy5}=  rest verify bigtap policy  ${policy_name_5}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy5}
    ${stream}=  L2 add  flow=i->j  frame_rate=100000  frame_size=1518  name=i_j_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  i  j  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac5710  fs1518


Verify L2 traffic on Dell S4810: frame size 1518 bytes
    ${verify_policy6}=  rest verify bigtap policy  ${policy_name_6}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy6}
    ${stream_s4810}=  L2 add  flow=k->l  line_rate=100  frame_size=1518  name=k_l_flow
    clear stats    
    start traffic  ${stream_s4810}
    sleep  10
    verify results  k  l  transmitted_frame_rate  received_valid_frame_rate    
    stop traffic  ${stream_s4810}
    [Tags]  l2  s4810  fs1518
    
#### L2 Traffic : Frame Size 9216 Bytes

Verify L2 traffic on LB9: frame size 9216 bytes
    ${verify_policy1}=  rest verify bigtap policy  ${policy_name_1}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy1}
    ${stream}=  L2 add  flow=a->b  line_rate=100  frame_size=9216  name=a_b_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  a  b  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  lb9  jumbo9216  

Verify L2 traffic on LY2: frame size 9216 bytes
    ${verify_policy2}=  rest verify bigtap policy  ${policy_name_2}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy2}
    ${stream}=  L2 add  flow=c->d  line_rate=512  frame_size=9216  name=c_d_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  c  d  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ly2  jumbo9216  

Verify L2 traffic on Accton 4600: frame size 9216 bytes
    ${verify_policy3}=  rest verify bigtap policy  ${policy_name_3}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy3}
    ${stream}=  L2 add  flow=e->f  line_rate=100  frame_size=9216  name=e_f_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  e  f  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac4600  jumbo9216

Verify L2 traffic on Accton 5610: frame size 9216 bytes
    ${verify_policy4}=  rest verify bigtap policy  ${policy_name_4}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy4}
    ${stream}=  L2 add  flow=g->h  line_rate=100  frame_size=9216  name=g_h_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  g  h  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac5610  jumbo9216

Verify L2 traffic on Accton 5710: frame size 9216 bytes
    ${verify_policy5}=  rest verify bigtap policy  ${policy_name_5}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy5}
    ${stream}=  L2 add  flow=i->j  frame_rate=100000  frame_size=9216  name=i_j_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  i  j  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac5710  jumbo9216


Verify L2 traffic on Dell S4810: frame size 9216 bytes
    ${verify_policy6}=  rest verify bigtap policy  ${policy_name_6}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy6}
    ${stream_s4810}=  L2 add  flow=k->l  line_rate=100  frame_size=9216  name=k_l_flow
    clear stats    
    start traffic  ${stream_s4810}
    sleep  10
    verify results  k  l  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream_s4810}
    [Tags]  l2  s4810  jumbo9216

    
#### L2 Vlan Tagged Traffic : Frame Size 1518 Bytes

Verify L2 vlan tagged traffic on LB9: frame size 1518 bytes
    #ixia initialize  tg1  init=true
    ${verify_policy1}=  rest verify bigtap policy  ${policy_name_1}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy1}
    ${stream}=  L2 add  flow=a->b  line_rate=100  frame_size=1518  ethertype=8100  vlan_id=2048  name=a_b_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  a  b  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  lb9  vlantagged  

Verify L2 vlan tagged traffic on LY2: frame size 1518 bytes
    ${verify_policy2}=  rest verify bigtap policy  ${policy_name_2}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy2}
    ${stream}=  L2 add  flow=c->d  line_rate=512  frame_size=1518  ethertype=8100  vlan_id=2048    name=c_d_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  c  d  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ly2  vlantagged  

Verify L2 vlan tagged traffic on Accton 4600: frame size 1518 bytes
    ${verify_policy3}=  rest verify bigtap policy  ${policy_name_3}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy3}
    ${stream}=  L2 add  flow=e->f  line_rate=100  frame_size=1518  ethertype=8100  vlan_id=2048  name=e_f_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  e  f  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac4600  vlantagged

Verify L2 vlan tagged traffic on Accton 5610: frame size 1518 bytes
    ${verify_policy4}=  rest verify bigtap policy  ${policy_name_4}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy4}
    ${stream}=  L2 add  flow=g->h  line_rate=100  frame_size=1518  ethertype=8100  vlan_id=2048  name=g_h_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  g  h  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac5610  vlantagged

Verify L2 vlan tagged traffic on Accton 5710: frame size 1518 bytes
    ${verify_policy5}=  rest verify bigtap policy  ${policy_name_5}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy5}
    ${stream}=  L2 add  flow=i->j  frame_rate=100000  frame_size=1518  ethertype=8100  vlan_id=2048  name=i_j_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  i  j  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac5710  vlantagged


Verify L2 vlan tagged traffic on Dell S4810: frame size 1518 bytes
    ${verify_policy6}=  rest verify bigtap policy  ${policy_name_6}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy6}
    ${stream_s4810}=  L2 add  flow=k->l  line_rate=100  frame_size=1518  ethertype=8100  vlan_id=2048  name=k_l_flow
    clear stats    
    start traffic  ${stream_s4810}
    sleep  10
    verify results  k  l  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream_s4810}
    [Tags]  l2  s4810  vlantagged

###  L2 Traffic with CRC Errors: Frame Size 1518 Bytes


Verify L2 Traffic with CRC Errors on LB9: frame size 1518 bytes
    ${verify_policy1}=  rest verify bigtap policy  ${policy_name_1}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy1}
    ${stream}=  L2 add  flow=a->b  line_rate=100  frame_size=1518  ethertype=0800  crc=True  name=a_b_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  a  b  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  lb9  l2crc  

Verify L2 Traffic with CRC Errors on LY2: frame size 1518 bytes
    ${verify_policy2}=  rest verify bigtap policy  ${policy_name_2}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy2}
    ${stream}=  L2 add  flow=c->d  line_rate=512  frame_size=1518  ethertype=0800  crc=True    name=c_d_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  c  d  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ly2  l2crc  

Verify L2 Traffic with CRC Errors on Accton 4600: frame size 1518 bytes
    ${verify_policy3}=  rest verify bigtap policy  ${policy_name_3}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy3}
    ${stream}=  L2 add  flow=e->f  line_rate=100  frame_size=1518  ethertype=0800  crc=True  name=e_f_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  e  f  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac4600  l2crc

Verify L2 Traffic with CRC Errors on Accton 5610: frame size 1518 bytes
    ${verify_policy4}=  rest verify bigtap policy  ${policy_name_4}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy4}
    ${stream}=  L2 add  flow=g->h  line_rate=100  frame_size=1518  ethertype=0800  crc=True  name=g_h_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  g  h  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac5610  l2crc

Verify L2 Traffic with CRC Errors on Accton 5710: frame size 1518 bytes
    ${verify_policy5}=  rest verify bigtap policy  ${policy_name_5}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy5}
    ${stream}=  L2 add  flow=i->j  frame_rate=100000  frame_size=1518  ethertype=0800  crc=True  name=i_j_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  i  j  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac5710  l2crc


Verify L2 Traffic with CRC Errors on Dell S4810: frame size 1518 bytes
    ${verify_policy6}=  rest verify bigtap policy  ${policy_name_6}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy6}
    ${stream_s4810}=  L2 add  flow=k->l  line_rate=100  frame_size=1518  ethertype=0800  crc=True  name=k_l_flow
    clear stats    
    start traffic  ${stream_s4810}
    sleep  10
    verify results  k  l  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream_s4810}
    [Tags]  l2  s4810  l2crc

### L2 Traffic :  Spanning Tree Protocol (for bridges) IEEE 802.1D
Verify L2 Traffic on Quanta LB9: Spanning Tree Protocol (for bridges) IEEE 802.1D
    ${verify_policy1}=  rest verify bigtap policy  ${policy_name_1}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy1}
    ${stream}=  L2 add  flow=a->b  line_rate=100  frame_size=1518  ethertype=0802  src_mac=5C:16:C7:13:14:01  dst_mac=01:80:c2:00:00:00  name=a_b_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  a  b  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  lb9  l2stp  

Verify L2 Traffic on LY2: Spanning Tree Protocol (for bridges) IEEE 802.1D
    ${verify_policy2}=  rest verify bigtap policy  ${policy_name_2}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy2}
    ${stream}=  L2 add  flow=c->d  line_rate=512  frame_size=1518  ethertype=0802  src_mac=5C:16:C7:13:14:01  dst_mac=01:80:c2:00:00:00  name=c_d_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  c  d  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ly2  l2stp  

Verify L2 Traffic on Accton 4600: Spanning Tree Protocol (for bridges) IEEE 802.1D
    ${verify_policy3}=  rest verify bigtap policy  ${policy_name_3}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy3}
    ${stream}=  L2 add  flow=e->f  line_rate=100  frame_size=1518  ethertype=0802  src_mac=5C:16:C7:13:14:01  dst_mac=01:80:c2:00:00:00  name=e_f_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  e  f  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac4600  l2stp

Verify L2 Traffic on Accton 5610: Spanning Tree Protocol (for bridges) IEEE 802.1D
    ${verify_policy4}=  rest verify bigtap policy  ${policy_name_4}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy4}
    ${stream}=  L2 add  flow=g->h  line_rate=100  frame_size=1518  ethertype=0802  src_mac=5C:16:C7:13:14:01  dst_mac=01:80:c2:00:00:00  name=g_h_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  g  h  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac5610  l2stp

Verify L2 Traffic on Accton 5710: Spanning Tree Protocol (for bridges) IEEE 802.1D
    ${verify_policy5}=  rest verify bigtap policy  ${policy_name_5}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy5}
    ${stream}=  L2 add  flow=i->j  frame_rate=100000  frame_size=1518  ethertype=0802  src_mac=5C:16:C7:13:14:01  dst_mac=01:80:c2:00:00:00  name=i_j_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  i  j  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac5710  l2stp


Verify L2 Traffic on Dell S4810: Spanning Tree Protocol (for bridges) IEEE 802.1D
    ${verify_policy6}=  rest verify bigtap policy  ${policy_name_6}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy6}
    ${stream_s4810}=  L2 add  flow=k->l  line_rate=100  frame_size=1518  ethertype=0802  src_mac=5C:16:C7:13:14:01  dst_mac=01:80:c2:00:00:00  name=k_l_flow
    clear stats    
    start traffic  ${stream_s4810}
    sleep  10
    verify results  k  l  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream_s4810}
    [Tags]  l2  s4810  l2stp
    
### L2 Traffic :  LLDP with ethernet ethertype
Verify L2 Traffic on Quanta LB9: LLDP with ethernet ethertype
    ${verify_policy1}=  rest verify bigtap policy  ${policy_name_1}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy1}
    ${stream}=  L2 add  flow=a->b  line_rate=100  frame_size=1518  ethertype=0800  src_mac=5C:16:C7:13:14:01  dst_mac=01:80:c2:00:00:0E  name=a_b_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  a  b  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  lb9  lldp  

Verify L2 Traffic on LY2: LLDP with ethernet ethertype
    ${verify_policy2}=  rest verify bigtap policy  ${policy_name_2}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy2}
    ${stream}=  L2 add  flow=c->d  line_rate=512  frame_size=1518  ethertype=0800  src_mac=5C:16:C7:13:14:01  dst_mac=01:80:c2:00:00:0E  name=c_d_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  c  d  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ly2  lldp  

Verify L2 Traffic on Accton 4600: LLDP with ethernet ethertype
    ${verify_policy3}=  rest verify bigtap policy  ${policy_name_3}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy3}
    ${stream}=  L2 add  flow=e->f  line_rate=100  frame_size=1518  ethertype=0800  src_mac=5C:16:C7:13:14:01  dst_mac=01:80:c2:00:00:0E  name=e_f_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  e  f  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac4600  lldp

Verify L2 Traffic on Accton 5610: LLDP with ethernet ethertype
    ${verify_policy4}=  rest verify bigtap policy  ${policy_name_4}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy4}
    ${stream}=  L2 add  flow=g->h  line_rate=100  frame_size=1518  ethertype=0800  src_mac=5C:16:C7:13:14:01  dst_mac=01:80:c2:00:00:0E  name=g_h_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  g  h  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac5610  lldp

Verify L2 Traffic on Accton 5710: LLDP with ethernet ethertype
    ${verify_policy5}=  rest verify bigtap policy  ${policy_name_5}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy5}
    ${stream}=  L2 add  flow=i->j  frame_rate=100000  frame_size=1518  ethertype=0800  src_mac=5C:16:C7:13:14:01  dst_mac=01:80:c2:00:00:0E  name=i_j_flow
    clear stats    
    start traffic  ${stream}
    sleep  10
    verify results  i  j  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream}
    [Tags]  l2  ac5710  lldp

Verify L2 Traffic on Dell S4810: LLDP with ethernet ethertype
    ${verify_policy6}=  rest verify bigtap policy  ${policy_name_6}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy6}
    ${stream_s4810}=  L2 add  flow=k->l  line_rate=100  frame_size=1518  ethertype=0800  src_mac=5C:16:C7:13:14:01  dst_mac=01:80:c2:00:00:0E  name=k_l_flow
    clear stats    
    start traffic  ${stream_s4810}
    sleep  10
    verify results  k  l  transmitted_frame_rate  received_frame_rate    
    stop traffic  ${stream_s4810}
    [Tags]  l2  s4810  lldp
    
### L3 Traffic    
#### L3 Traffic : Frame Size 68 Bytes
        
Verify L3 traffic on Quanta LB9: frame size 68 bytes
    ${verify_policy1}=  rest verify bigtap policy  ${policy_name_1}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy1}
    ${stream_l3_lb9}=  L3 add  flow=a->b  line_rate=100  frame_size=68  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=a_b_flow
    clear stats  
    start traffic  ${stream_l3_lb9}
    sleep  10
    verify results  a  b  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_lb9}
    [Tags]  l3  lb9  fs64

                                       
Verify L3 traffic on Quanta LY2: frame size 68 bytes
    ${verify_policy2}=  rest verify bigtap policy  ${policy_name_2}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy2}
    ${stream_l3_ly2}=  L3 add  flow=c->d  line_rate=100  frame_size=68  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=c_d_flow
    clear stats  
    start traffic  ${stream_l3_ly2}
    sleep  10
    verify results  c  d  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ly2}
    [Tags]  l3  ly2  fs64
    
Verify L3 traffic on Accton 4600: frame size 68 bytes
    ${verify_policy3}=  rest verify bigtap policy  ${policy_name_3}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy3}
    ${stream_l3_ac4600}=  L3 add  flow=e->f  line_rate=100  frame_size=68  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=e_f_flow
    clear stats  
    start traffic  ${stream_l3_ac4600}
    sleep  10
    verify results  e  f  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ac4600}
    [Tags]  l3  ac4600  fs64
    
Verify L3 traffic on Accton 5610: frame size 68 bytes
    ${verify_policy4}=  rest verify bigtap policy  ${policy_name_4}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy4}
    ${stream_l3_ac5610}=  L3 add  flow=g->h  line_rate=100  frame_size=68  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=g_h_flow
    clear stats  
    start traffic  ${stream_l3_ac5610}
    sleep  10
    verify results  g  h  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ac5610}
    [Tags]  l3  ac5610  fs64

Verify L3 traffic on Accton 5710: frame size 68 bytes
    ${verify_policy5}=  rest verify bigtap policy  ${policy_name_5}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy5}
    ${stream_l3_ac5710}=  L3 add  flow=i->j  frame_rate=100000  frame_size=68  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=i_j_flow
    clear stats  
    start traffic  ${stream_l3_ac5710}
    sleep  10
    verify results  i  j  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ac5710}
    [Tags]  l3  ac5710  fs64

Verify L3 traffic on Dell S4810: frame size 68 bytes
    ${verify_policy6}=  rest verify bigtap policy  ${policy_name_6}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy6}
    ${stream_l3_s4810}=  L3 add  flow=k->l  line_rate=100  frame_size=68  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=k_l_flow
    clear stats  
    start traffic  ${stream_l3_s4810}
    sleep  10
    verify results  k  l  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_s4810}
    [Tags]  l3  s4810  fs64

#### L3 Traffic : Frame Size 128 Bytes

Verify L3 traffic on Quanta LB9: frame size 128 bytes
    ${verify_policy1}=  rest verify bigtap policy  ${policy_name_1}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy1}
    ${stream_l3_lb9}=  L3 add  flow=a->b  line_rate=100  frame_size=128  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=a_b_flow
    clear stats  
    start traffic  ${stream_l3_lb9}
    sleep  10
    verify results  a  b  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_lb9}
    [Tags]  l3  lb9  fs128

                                       
Verify L3 traffic on Quanta LY2: frame size 128 bytes
    ${verify_policy2}=  rest verify bigtap policy  ${policy_name_2}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy2}
    ${stream_l3_ly2}=  L3 add  flow=c->d  line_rate=100  frame_size=128  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=c_d_flow
    clear stats  
    start traffic  ${stream_l3_ly2}
    sleep  10
    verify results  c  d  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ly2}
    [Tags]  l3  ly2  fs128
    
Verify L3 traffic on Accton 4600: frame size 128 bytes
    ${verify_policy3}=  rest verify bigtap policy  ${policy_name_3}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy3}
    ${stream_l3_ac4600}=  L3 add  flow=e->f  line_rate=100  frame_size=128  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=e_f_flow
    clear stats  
    start traffic  ${stream_l3_ac4600}
    sleep  10
    verify results  e  f  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ac4600}
    [Tags]  l3  ac4600  fs128
    
Verify L3 traffic on Accton 5610: frame size 128 bytes
    ${verify_policy4}=  rest verify bigtap policy  ${policy_name_4}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy4}
    ${stream_l3_ac5610}=  L3 add  flow=g->h  line_rate=100  frame_size=128  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=g_h_flow
    clear stats  
    start traffic  ${stream_l3_ac5610}
    sleep  10
    verify results  g  h  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ac5610}
    [Tags]  l3  ac5610  fs128

Verify L3 traffic on Accton 5710: frame size 128 bytes
    ${verify_policy5}=  rest verify bigtap policy  ${policy_name_5}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy5}
    ${stream_l3_ac5710}=  L3 add  flow=i->j  frame_rate=100000  frame_size=128  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=i_j_flow
    clear stats  
    start traffic  ${stream_l3_ac5710}
    sleep  10
    verify results  i  j  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ac5710}
    [Tags]  l3  ac5710  fs128

Verify L3 traffic on Dell S4810: frame size 128 bytes
    ${verify_policy6}=  rest verify bigtap policy  ${policy_name_6}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy6}
    ${stream_l3_s4810}=  L3 add  flow=k->l  line_rate=100  frame_size=128  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=k_l_flow
    clear stats  
    start traffic  ${stream_l3_s4810}
    sleep  10
    verify results  k  l  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_s4810}
    [Tags]  l3  s4810  fs128

#### L3 Traffic : Frame Size 256 Bytes

Verify L3 traffic on Quanta LB9: frame size 256 bytes
    ${verify_policy1}=  rest verify bigtap policy  ${policy_name_1}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy1}
    ${stream_l3_lb9}=  L3 add  flow=a->b  line_rate=100  frame_size=256  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=a_b_flow
    clear stats  
    start traffic  ${stream_l3_lb9}
    sleep  10
    verify results  a  b  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_lb9}
    [Tags]  l3  lb9  fs256

                                       
Verify L3 traffic on Quanta LY2: frame size 256 bytes
    ${verify_policy2}=  rest verify bigtap policy  ${policy_name_2}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy2}
    ${stream_l3_ly2}=  L3 add  flow=c->d  line_rate=100  frame_size=256  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=c_d_flow
    clear stats  
    start traffic  ${stream_l3_ly2}
    sleep  10
    verify results  c  d  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ly2}
    [Tags]  l3  ly2  fs256
    
Verify L3 traffic on Accton 4600: frame size 256 bytes
    ${verify_policy3}=  rest verify bigtap policy  ${policy_name_3}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy3}
    ${stream_l3_ac4600}=  L3 add  flow=e->f  line_rate=100  frame_size=256  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=e_f_flow
    clear stats  
    start traffic  ${stream_l3_ac4600}
    sleep  10
    verify results  e  f  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ac4600}
    [Tags]  l3  ac4600  fs256
    
Verify L3 traffic on Accton 5610: frame size 256 bytes
    ${verify_policy4}=  rest verify bigtap policy  ${policy_name_4}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy4}
    ${stream_l3_ac5610}=  L3 add  flow=g->h  line_rate=100  frame_size=256  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=g_h_flow
    clear stats  
    start traffic  ${stream_l3_ac5610}
    sleep  10
    verify results  g  h  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ac5610}
    [Tags]  l3  ac5610  fs256

Verify L3 traffic on Accton 5710: frame size 256 bytes
    ${verify_policy5}=  rest verify bigtap policy  ${policy_name_5}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy5}
    ${stream_l3_ac5710}=  L3 add  flow=i->j  frame_rate=100000  frame_size=256  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=i_j_flow
    clear stats  
    start traffic  ${stream_l3_ac5710}
    sleep  10
    verify results  i  j  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ac5710}
    [Tags]  l3  ac5710  fs256

Verify L3 traffic on Dell S4810: frame size 256 bytes
    ${verify_policy6}=  rest verify bigtap policy  ${policy_name_6}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy6}
    ${stream_l3_s4810}=  L3 add  flow=k->l  line_rate=100  frame_size=256  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=k_l_flow
    clear stats  
    start traffic  ${stream_l3_s4810}
    sleep  10
    verify results  k  l  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_s4810}
    [Tags]  l3  s4810  fs256
    
#### L3 Traffic : Frame Size 512 Bytes
    
Verify L3 traffic on Quanta LB9: frame size 512 bytes
    ${verify_policy1}=  rest verify bigtap policy  ${policy_name_1}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy1}
    ${stream_l3_lb9}=  L3 add  flow=a->b  line_rate=100  frame_size=512  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=a_b_flow
    clear stats  
    start traffic  ${stream_l3_lb9}
    sleep  10
    verify results  a  b  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_lb9}
    [Tags]  l3  lb9  fs512

                                       
Verify L3 traffic on Quanta LY2: frame size 512 bytes
    ${verify_policy2}=  rest verify bigtap policy  ${policy_name_2}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy2}
    ${stream_l3_ly2}=  L3 add  flow=c->d  line_rate=100  frame_size=512  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=c_d_flow
    clear stats  
    start traffic  ${stream_l3_ly2}
    sleep  10
    verify results  c  d  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ly2}
    [Tags]  l3  ly2  fs512
    
Verify L3 traffic on Accton 4600: frame size 512 bytes
    ${verify_policy3}=  rest verify bigtap policy  ${policy_name_3}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy3}
    ${stream_l3_ac4600}=  L3 add  flow=e->f  line_rate=100  frame_size=512  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=e_f_flow
    clear stats  
    start traffic  ${stream_l3_ac4600}
    sleep  10
    verify results  e  f  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ac4600}
    [Tags]  l3  ac4600  fs512
    
Verify L3 traffic on Accton 5610: frame size 512 bytes
    ${verify_policy4}=  rest verify bigtap policy  ${policy_name_4}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy4}
    ${stream_l3_ac5610}=  L3 add  flow=g->h  line_rate=100  frame_size=512  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=g_h_flow
    clear stats  
    start traffic  ${stream_l3_ac5610}
    sleep  10
    verify results  g  h  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ac5610}
    [Tags]  l3  ac5610  fs512

Verify L3 traffic on Accton 5710: frame size 512 bytes
    ${verify_policy5}=  rest verify bigtap policy  ${policy_name_5}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy5}
    ${stream_l3_ac5710}=  L3 add  flow=i->j  frame_rate=100000  frame_size=512  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=i_j_flow
    clear stats  
    start traffic  ${stream_l3_ac5710}
    sleep  10
    verify results  i  j  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ac5710}
    [Tags]  l3  ac5710  fs512

Verify L3 traffic on Dell S4810: frame size 512 bytes
    ${verify_policy6}=  rest verify bigtap policy  ${policy_name_6}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy6}
    ${stream_l3_s4810}=  L3 add  flow=k->l  line_rate=100  frame_size=512  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=k_l_flow
    clear stats  
    start traffic  ${stream_l3_s4810}
    sleep  10
    verify results  k  l  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_s4810}
    [Tags]  l3  s4810  fs512
    
#### L3 Traffic : Frame Size 1024 Bytes

Verify L3 traffic on Quanta LB9: frame size 1024 bytes
    ${verify_policy1}=  rest verify bigtap policy  ${policy_name_1}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy1}
    ${stream_l3_lb9}=  L3 add  flow=a->b  line_rate=100  frame_size=1024  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=a_b_flow
    clear stats  
    start traffic  ${stream_l3_lb9}
    sleep  10
    verify results  a  b  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_lb9}
    [Tags]  l3  lb9  fs1024

                                       
Verify L3 traffic on Quanta LY2: frame size 1024 bytes
    ${verify_policy2}=  rest verify bigtap policy  ${policy_name_2}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy2}
    ${stream_l3_ly2}=  L3 add  flow=c->d  line_rate=100  frame_size=1024  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=c_d_flow
    clear stats  
    start traffic  ${stream_l3_ly2}
    sleep  10
    verify results  c  d  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ly2}
    [Tags]  l3  ly2  fs1024
    
Verify L3 traffic on Accton 4600: frame size 1024 bytes
    ${verify_policy3}=  rest verify bigtap policy  ${policy_name_3}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy3}
    ${stream_l3_ac4600}=  L3 add  flow=e->f  line_rate=100  frame_size=1024  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=e_f_flow
    clear stats  
    start traffic  ${stream_l3_ac4600}
    sleep  10
    verify results  e  f  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ac4600}
    [Tags]  l3  ac4600  fs1024
    
Verify L3 traffic on Accton 5610: frame size 1024 bytes
    ${verify_policy4}=  rest verify bigtap policy  ${policy_name_4}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy4}
    ${stream_l3_ac5610}=  L3 add  flow=g->h  line_rate=100  frame_size=1024  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=g_h_flow
    clear stats  
    start traffic  ${stream_l3_ac5610}
    sleep  10
    verify results  g  h  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ac5610}
    [Tags]  l3  ac5610  fs1024

Verify L3 traffic on Accton 5710: frame size 1024 bytes
    ${verify_policy5}=  rest verify bigtap policy  ${policy_name_5}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy5}
    ${stream_l3_ac5710}=  L3 add  flow=i->j  frame_rate=100000  frame_size=1024  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=i_j_flow
    clear stats  
    start traffic  ${stream_l3_ac5710}
    sleep  10
    verify results  i  j  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ac5710}
    [Tags]  l3  ac5710  fs1024

Verify L3 traffic on Dell S4810: frame size 1024 bytes
    ${verify_policy6}=  rest verify bigtap policy  ${policy_name_6}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy6}
    ${stream_l3_s4810}=  L3 add  flow=k->l  line_rate=100  frame_size=1024  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=k_l_flow
    clear stats  
    start traffic  ${stream_l3_s4810}
    sleep  10
    verify results  k  l  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_s4810}
    [Tags]  l3  s4810  fs1024
    
#### L3 Traffic : Frame Size 1280 Bytes

Verify L3 traffic on Quanta LB9: frame size 1280 bytes
    #ixia initialize  tg1  init=true
    ${verify_policy1}=  rest verify bigtap policy  ${policy_name_1}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy1}
    ${stream_l3_lb9}=  L3 add  flow=a->b  line_rate=100  frame_size=1280  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=a_b_flow
    clear stats  
    start traffic  ${stream_l3_lb9}
    sleep  10
    verify results  a  b  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_lb9}
    [Tags]  l3  lb9  fs1280

                                       
Verify L3 traffic on Quanta LY2: frame size 1280 bytes
    ${verify_policy2}=  rest verify bigtap policy  ${policy_name_2}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy2}
    ${stream_l3_ly2}=  L3 add  flow=c->d  line_rate=100  frame_size=1280  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=c_d_flow
    clear stats  
    start traffic  ${stream_l3_ly2}
    sleep  10
    verify results  c  d  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ly2}
    [Tags]  l3  ly2  fs1280
    
Verify L3 traffic on Accton 4600: frame size 1280 bytes
    ${verify_policy3}=  rest verify bigtap policy  ${policy_name_3}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy3}
    ${stream_l3_ac4600}=  L3 add  flow=e->f  line_rate=100  frame_size=1280  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=e_f_flow
    clear stats  
    start traffic  ${stream_l3_ac4600}
    sleep  10
    verify results  e  f  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ac4600}
    [Tags]  l3  ac4600  fs1280
    
Verify L3 traffic on Accton 5610: frame size 1280 bytes
    ${verify_policy4}=  rest verify bigtap policy  ${policy_name_4}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy4}
    ${stream_l3_ac5610}=  L3 add  flow=g->h  line_rate=100  frame_size=1280  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=g_h_flow
    clear stats  
    start traffic  ${stream_l3_ac5610}
    sleep  10
    verify results  g  h  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ac5610}
    [Tags]  l3  ac5610  fs1280

Verify L3 traffic on Accton 5710: frame size 1280 bytes
    ${verify_policy5}=  rest verify bigtap policy  ${policy_name_5}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy5}
    ${stream_l3_ac5710}=  L3 add  flow=i->j  frame_rate=100000  frame_size=1280  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=i_j_flow
    clear stats  
    start traffic  ${stream_l3_ac5710}
    sleep  10
    verify results  i  j  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ac5710}
    [Tags]  l3  ac5710  fs1280

Verify L3 traffic on Dell S4810: frame size 1280 bytes
    ${verify_policy6}=  rest verify bigtap policy  ${policy_name_6}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy6}
    ${stream_l3_s4810}=  L3 add  flow=k->l  line_rate=100  frame_size=1280  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=k_l_flow
    clear stats  
    start traffic  ${stream_l3_s4810}
    sleep  10
    verify results  k  l  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_s4810}
    [Tags]  l3  s4810  fs1280

#### L3 Traffic : Frame Size 1518 Bytes

Verify L3 traffic on Quanta LB9: frame size 1518 bytes
    ${verify_policy1}=  rest verify bigtap policy  ${policy_name_1}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy1}
    ${stream_l3_lb9}=  L3 add  flow=a->b  line_rate=100  frame_size=1518  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=a_b_flow
    clear stats  
    start traffic  ${stream_l3_lb9}
    sleep  10
    verify results  a  b  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_lb9}
    [Tags]  l3  lb9  fs1518

                                       
Verify L3 traffic on Quanta LY2: frame size 1518 bytes
    ${verify_policy2}=  rest verify bigtap policy  ${policy_name_2}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy2}
    ${stream_l3_ly2}=  L3 add  flow=c->d  line_rate=100  frame_size=1518  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=c_d_flow
    clear stats  
    start traffic  ${stream_l3_ly2}
    sleep  10
    verify results  c  d  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ly2}
    [Tags]  l3  ly2  fs1518
    
Verify L3 traffic on Accton 4600: frame size 1518 bytes
    ${verify_policy3}=  rest verify bigtap policy  ${policy_name_3}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy3}
    ${stream_l3_ac4600}=  L3 add  flow=e->f  line_rate=100  frame_size=1518  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=e_f_flow
    clear stats  
    start traffic  ${stream_l3_ac4600}
    sleep  10
    verify results  e  f  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ac4600}
    [Tags]  l3  ac4600  fs1518
    
Verify L3 traffic on Accton 5610: frame size 1518 bytes
    ${verify_policy4}=  rest verify bigtap policy  ${policy_name_4}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy4}
    ${stream_l3_ac5610}=  L3 add  flow=g->h  line_rate=100  frame_size=1518  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=g_h_flow
    clear stats  
    start traffic  ${stream_l3_ac5610}
    sleep  10
    verify results  g  h  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ac5610}
    [Tags]  l3  ac5610  fs1518

Verify L3 traffic on Accton 5710: frame size 1518 bytes
    ${verify_policy5}=  rest verify bigtap policy  ${policy_name_5}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy5}
    ${stream_l3_ac5710}=  L3 add  flow=i->j  frame_rate=100000  frame_size=1518  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=i_j_flow
    clear stats  
    start traffic  ${stream_l3_ac5710}
    sleep  10
    verify results  i  j  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ac5710}
    [Tags]  l3  ac5710  fs1518

Verify L3 traffic on Dell S4810: frame size 1518 bytes
    ${verify_policy6}=  rest verify bigtap policy  ${policy_name_6}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy6}
    ${stream_l3_s4810}=  L3 add  flow=k->l  line_rate=100  frame_size=1518  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=k_l_flow
    clear stats  
    start traffic  ${stream_l3_s4810}
    sleep  10
    verify results  k  l  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_s4810}
    [Tags]  l3  s4810  fs1518
    
#### L3 Traffic : Frame Size 9150 Bytes

Verify L3 traffic on Quanta LB9: frame size 9150 bytes
    ${verify_policy1}=  rest verify bigtap policy  ${policy_name_1}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy1}
    ${stream_l3_lb9}=  L3 add  flow=a->b  line_rate=100  frame_size=9150  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=a_b_flow
    clear stats  
    start traffic  ${stream_l3_lb9}
    sleep  10
    verify results  a  b  transmitted_frame_rate  received_frame_rate        
    stop traffic  ${stream_l3_lb9}
    [Tags]  l3  lb9  jumbo9150
      
Verify L3 traffic on Quanta LY2: frame size 9150 bytes
    ${verify_policy2}=  rest verify bigtap policy  ${policy_name_2}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy2}
    ${stream_l3_ly2}=  L3 add  flow=c->d  line_rate=100  frame_size=9150  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=c_d_flow
    clear stats  
    start traffic  ${stream_l3_ly2}
    sleep  10
    verify results  c  d  transmitted_frame_rate  received_frame_rate        
    stop traffic  ${stream_l3_ly2}
    [Tags]  l3  ly2  jumbo9150
    
Verify L3 traffic on Accton 4600: frame size 9150 bytes
    ${verify_policy3}=  rest verify bigtap policy  ${policy_name_3}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy3}
    ${stream_l3_ac4600}=  L3 add  flow=e->f  line_rate=100  frame_size=9150  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=e_f_flow
    clear stats  
    start traffic  ${stream_l3_ac4600}
    sleep  10
    verify results  e  f  transmitted_frame_rate  received_frame_rate        
    stop traffic  ${stream_l3_ac4600}
    [Tags]  l3  ac4600  jumbo9150
    
Verify L3 traffic on Accton 5610: frame size 9150 bytes
    ${verify_policy4}=  rest verify bigtap policy  ${policy_name_4}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy4}
    ${stream_l3_ac5610}=  L3 add  flow=g->h  line_rate=100  frame_size=9150  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=g_h_flow
    clear stats  
    start traffic  ${stream_l3_ac5610}
    sleep  10
    verify results  g  h  transmitted_frame_rate  received_frame_rate        
    stop traffic  ${stream_l3_ac5610}
    [Tags]  l3  ac5610  jumbo9150

Verify L3 traffic on Accton 5710: frame size 9150 bytes
    ${verify_policy5}=  rest verify bigtap policy  ${policy_name_6}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy5}
    ${stream_l3_ac5710}=  L3 add  flow=i->j  frame_rate=100000  frame_size=9150  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=i_j_flow
    clear stats  
    start traffic  ${stream_l3_ac5710}
    sleep  10
    verify results  i  j  transmitted_frame_rate  received_frame_rate        
    stop traffic  ${stream_l3_ac5710}
    [Tags]  l3  ac5710  jumbo9150

Verify L3 traffic on Dell S4810: frame size 9150 bytes
    ${verify_policy6}=  rest verify bigtap policy  ${policy_name_6}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy6}
    ${stream_l3_s4810}=  L3 add  flow=k->l  line_rate=100  frame_size=9150  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=k_l_flow
    clear stats  
    start traffic  ${stream_l3_s4810}
    sleep  10
    verify results  k  l  transmitted_frame_rate  received_frame_rate        
    stop traffic  ${stream_l3_s4810}
    [Tags]  l3  s4810  jumbo9150    
    
#### L3 Vlan Tagged Traffic : Frame Size 1518 Bytes

Verify L3 vlan tagged traffic on Quanta LB9: frame size 1518 bytes
    ${verify_policy1}=  rest verify bigtap policy  ${policy_name_1}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy1}
    ${stream_l3_lb9}=  L3 add  flow=a->b  line_rate=100  frame_size=1518  ethertype=8100  vlan_id=2048  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=a_b_flow
    clear stats  
    start traffic  ${stream_l3_lb9}
    sleep  10
    verify results  a  b  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_lb9}
    [Tags]  l3  lb9  vlantagged

                                       
Verify L3 vlan tagged traffic on Quanta LY2: frame size 1518 bytes
    ${verify_policy2}=  rest verify bigtap policy  ${policy_name_2}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy2}
    ${stream_l3_ly2}=  L3 add  flow=c->d  line_rate=100  frame_size=1518  ethertype=8100  vlan_id=2048  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=c_d_flow
    clear stats  
    start traffic  ${stream_l3_ly2}
    sleep  10
    verify results  c  d  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ly2}
    [Tags]  l3  ly2  vlantagged
    
Verify L3 vlan tagged traffic on Accton 4600: frame size 1518 bytes
    ${verify_policy3}=  rest verify bigtap policy  ${policy_name_3}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy3}
    ${stream_l3_ac4600}=  L3 add  flow=e->f  line_rate=100  frame_size=1518  ethertype=8100  vlan_id=2048  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=e_f_flow
    clear stats  
    start traffic  ${stream_l3_ac4600}
    sleep  10
    verify results  e  f  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ac4600}
    [Tags]  l3  ac4600  vlantagged
    
Verify L3 vlan tagged traffic on Accton 5610: frame size 1518 bytes
    ${verify_policy4}=  rest verify bigtap policy  ${policy_name_4}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy4}
    ${stream_l3_ac5610}=  L3 add  flow=g->h  line_rate=100  frame_size=1518  ethertype=8100  vlan_id=2048  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=g_h_flow
    clear stats  
    start traffic  ${stream_l3_ac5610}
    sleep  10
    verify results  g  h  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ac5610}
    [Tags]  l3  ac5610  vlantagged

Verify L3 vlan tagged traffic on Accton 5710: frame size 1518 bytes
    ${verify_policy5}=  rest verify bigtap policy  ${policy_name_5}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy5}
    ${stream_l3_ac5710}=  L3 add  flow=i->j  frame_rate=100000  frame_size=1518  ethertype=8100  vlan_id=2048  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=i_j_flow
    clear stats  
    start traffic  ${stream_l3_ac5710}
    sleep  10
    verify results  i  j  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_ac5710}
    [Tags]  l3  ac5710  vlantagged

Verify L3 vlan tagged traffic on Dell S4810: frame size 1518 bytes
    ${verify_policy6}=  rest verify bigtap policy  ${policy_name_6}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy6}
    ${stream_l3_s4810}=  L3 add  flow=k->l  line_rate=100  frame_size=1518  ethertype=8100  vlan_id=2048  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=k_l_flow
    clear stats  
    start traffic  ${stream_l3_s4810}
    sleep  10
    verify results  k  l  transmitted_frame_rate  received_valid_frame_rate        
    stop traffic  ${stream_l3_s4810}
    [Tags]  l3  s4810  vlantagged

## Negative Tests
### Flap ingress/filter interface and verify traffic
Flap Filter Interface on LB9 and verify traffic: frame size 1518 bytes
    #ixia initialize  tg1  init=true
    ${verify_policy1}=  rest verify bigtap policy  ${policy_name_1}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy1}
    ${stream_l3_lb9}=  L3 add  flow=a->b  line_rate=100  frame_size=1518  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=a_b_flow
    clear stats  
    start traffic  ${stream_l3_lb9}
    sleep  5
    verify results  a  b  transmitted_frame_rate  received_frame_rate
    cli disable interface  s1  ${filter_1}
    sleep  5
    cli enable interface  s1  ${filter_1}
    sleep  5
    ${verify_policy1}=  rest verify bigtap policy  ${policy_name_1}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy1}
    verify results  a  b  transmitted_frame_rate  received_frame_rate               
    stop traffic  ${stream_l3_lb9}
    [Tags]  l3  lb9  flapIntf

Flap Filter Interface on LY2 and verify traffic: frame size 1518 bytes
    ${verify_policy2}=  rest verify bigtap policy  ${policy_name_2}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy2}
    ${stream_l3_ly2}=  L3 add  flow=c->d  line_rate=100  frame_size=1518  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=c_d_flow
    clear stats  
    start traffic  ${stream_l3_ly2}
    sleep  5
    verify results  c  d  transmitted_frame_rate  received_frame_rate        
    cli disable interface  s2  ${filter_2}
    sleep  5
    cli enable interface  s2  ${filter_2}
    sleep  60
    ${verify_policy2}=  rest verify bigtap policy  ${policy_name_2}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy2}
    verify results  c  d  transmitted_frame_rate  received_frame_rate        
    stop traffic  ${stream_l3_ly2}
    [Tags]  l3  ly2  flapIntf
    
Flap Filter Interface on Accton 4600 and verify traffic: frame size 1518 bytes
    ${verify_policy3}=  rest verify bigtap policy  ${policy_name_3}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy3}
    ${stream_l3_ac4600}=  L3 add  flow=e->f  line_rate=100  frame_size=1518  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=e_f_flow
    clear stats  
    start traffic  ${stream_l3_ac4600}
    sleep  5
    verify results  e  f  transmitted_frame_rate  received_frame_rate        
    cli disable interface  s3  ${filter_3}
    sleep  5
    cli enable interface  s3  ${filter_3}
    sleep  60
    ${verify_policy3}=  rest verify bigtap policy  ${policy_name_3}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy3}
    verify results  e  f  transmitted_frame_rate  received_frame_rate        
    stop traffic  ${stream_l3_ac4600}
    [Tags]  l3  ac4600  flapIntf
    
Flap Filter Interface on Accton 5610 and verify traffic: frame size 1518 bytes
    ${verify_policy4}=  rest verify bigtap policy  ${policy_name_4}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy4}
    ${stream_l3_ac5610}=  L3 add  flow=g->h  line_rate=100  frame_size=1518  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=g_h_flow
    clear stats  
    start traffic  ${stream_l3_ac5610}
    sleep  5
    verify results  g  h  transmitted_frame_rate  received_frame_rate        
    cli disable interface  s4  ${filter_4}
    sleep  5
    cli enable interface  s4  ${filter_4}
    sleep  60
    ${verify_policy4}=  rest verify bigtap policy  ${policy_name_4}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy4}
    verify results  g  h  transmitted_frame_rate  received_frame_rate        
    stop traffic  ${stream_l3_ac5610}
    [Tags]  l3  ac5610  flapIntf

Flap Filter Interface on Accton 5710 and verify traffic: frame size 1518 bytes
    ${verify_policy5}=  rest verify bigtap policy  ${policy_name_4}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy5}
    ${stream_l3_ac5710}=  L3 add  flow=i->j  frame_rate=100000  frame_size=1518  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=i_j_flow
    clear stats  
    start traffic  ${stream_l3_ac5710}
    sleep  5
    verify results  i  j  transmitted_frame_rate  received_frame_rate        
    cli disable interface  s5  ${filter_5}
    sleep  5
    cli enable interface  s5  ${filter_5}
    sleep  60
    ${verify_policy5}=  rest verify bigtap policy  ${policy_name_5}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy5}
    verify results  i  j  transmitted_frame_rate  received_frame_rate        
    stop traffic  ${stream_l3_ac5710}
    [Tags]  l3  ac5710  flapIntf

Flap Filter Interface on Dell S4810 and verify traffic: frame size 1518 bytes
    ${verify_policy6}=  rest verify bigtap policy  ${policy_name_6}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy6}
    ${stream_l3_s4810}=  L3 add  flow=k->l  line_rate=100  frame_size=1518  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=k_l_flow
    clear stats  
    start traffic  ${stream_l3_s4810}
    sleep  5
    verify results  k  l  transmitted_frame_rate  received_frame_rate        
    cli disable interface  s6  ${filter_6}
    sleep  5
    cli enable interface  s6  ${filter_6}
    sleep  60
    ${verify_policy6}=  rest verify bigtap policy  ${policy_name_6}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy6}
    verify results  k  l  transmitted_frame_rate  received_frame_rate        
    stop traffic  ${stream_l3_s4810}
    [Tags]  l3  s4810  flapIntf

### Flap egress/delivery interface and verify traffic
Flap Delivery Interface on LB9 and verify traffic: frame size 1518 bytes
    ${verify_policy1}=  rest verify bigtap policy  ${policy_name_1}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy1}
    ${stream_l3_lb9}=  L3 add  flow=a->b  line_rate=100  frame_size=1518  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=a_b_flow
    clear stats  
    start traffic  ${stream_l3_lb9}
    sleep  5
    verify results  a  b  transmitted_frame_rate  received_frame_rate
    cli disable interface  s1  ${delivery_1}
    sleep  5
    cli enable interface  s1  ${delivery_1}
    sleep  60
    ${verify_policy1}=  rest verify bigtap policy  ${policy_name_1}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy1}
    verify results  a  b  transmitted_frame_rate  received_frame_rate               
    stop traffic  ${stream_l3_lb9}
    [Tags]  l3  lb9  flapIntf

Flap Delivery Interface on LY2 and verify traffic: frame size 1518 bytes
    ${verify_policy2}=  rest verify bigtap policy  ${policy_name_2}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy2}
    ${stream_l3_ly2}=  L3 add  flow=c->d  line_rate=100  frame_size=1518  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=c_d_flow
    clear stats  
    start traffic  ${stream_l3_ly2}
    sleep  5
    verify results  c  d  transmitted_frame_rate  received_frame_rate        
    cli disable interface  s2  ${delivery_2}
    sleep  5
    cli enable interface  s2  ${delivery_2}
    sleep  60
    ${verify_policy2}=  rest verify bigtap policy  ${policy_name_2}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy2}
    verify results  c  d  transmitted_frame_rate  received_frame_rate        
    stop traffic  ${stream_l3_ly2}
    [Tags]  l3  ly2  flapIntf
    
Flap Delivery Interface on Accton 4600 and verify traffic: frame size 1518 bytes
    ${verify_policy3}=  rest verify bigtap policy  ${policy_name_3}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy3}
    ${stream_l3_ac4600}=  L3 add  flow=e->f  line_rate=100  frame_size=1518  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=e_f_flow
    clear stats  
    start traffic  ${stream_l3_ac4600}
    sleep  5
    verify results  e  f  transmitted_frame_rate  received_frame_rate        
    cli disable interface  s3  ${delivery_3}
    sleep  5
    cli enable interface  s3  ${delivery_3}
    sleep  60
    ${verify_policy3}=  rest verify bigtap policy  ${policy_name_3}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy3}
    verify results  e  f  transmitted_frame_rate  received_frame_rate        
    stop traffic  ${stream_l3_ac4600}
    [Tags]  l3  ac4600  flapIntf
    
Flap Delivery Interface on Accton 5610 and verify traffic: frame size 1518 bytes
    ${verify_policy4}=  rest verify bigtap policy  ${policy_name_4}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy4}
    ${stream_l3_ac5610}=  L3 add  flow=g->h  line_rate=100  frame_size=1518  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=g_h_flow
    clear stats  
    start traffic  ${stream_l3_ac5610}
    sleep  5
    verify results  g  h  transmitted_frame_rate  received_frame_rate        
    cli disable interface  s4  ${delivery_4}
    sleep  5
    cli enable interface  s4  ${delivery_4}
    sleep  60
    ${verify_policy4}=  rest verify bigtap policy  ${policy_name_4}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy4}
    verify results  g  h  transmitted_frame_rate  received_frame_rate        
    stop traffic  ${stream_l3_ac5610}
    [Tags]  l3  ac5610  flapIntf

Flap Delivery Interface on Accton 5710 and verify traffic: frame size 1518 bytes
    ${verify_policy5}=  rest verify bigtap policy  ${policy_name_4}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy5}
    ${stream_l3_ac5710}=  L3 add  flow=i->j  frame_rate=100000  frame_size=1518  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=i_j_flow
    clear stats  
    start traffic  ${stream_l3_ac5710}
    sleep  5
    verify results  i  j  transmitted_frame_rate  received_frame_rate        
    cli disable interface  s5  ${delivery_5}
    sleep  5
    cli enable interface  s5  ${delivery_5}
    sleep  60
    ${verify_policy5}=  rest verify bigtap policy  ${policy_name_5}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy5}
    verify results  i  j  transmitted_frame_rate  received_frame_rate        
    stop traffic  ${stream_l3_ac5710}
    [Tags]  l3  ac5710  flapIntf

Flap Delivery Interface on Dell S4810 and verify traffic: frame size 1518 bytes
    ${verify_policy6}=  rest verify bigtap policy  ${policy_name_6}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy6}
    ${stream_l3_s4810}=  L3 add  flow=k->l  line_rate=100  frame_size=1518  
    ...     src_mac=00:02:03:04:05:06  dst_mac=00:02:03:04:05:07  no_arp=True
    ...     src_ip=100.1.1.1  dst_ip=100.1.1.2  name=k_l_flow
    clear stats  
    start traffic  ${stream_l3_s4810}
    sleep  5
    verify results  k  l  transmitted_frame_rate  received_frame_rate        
    cli disable interface  s6  ${delivery_6}
    sleep  5
    cli enable interface  s6  ${delivery_6}
    sleep  60
    ${verify_policy6}=  rest verify bigtap policy  ${policy_name_6}  num_filter_intf=1  num_delivery_intf=1
    Should be true  ${verify_policy6}
    verify results  k  l  transmitted_frame_rate  received_frame_rate        
    stop traffic  ${stream_l3_s4810}
    [Tags]  l3  s4810  flapIntf
                                                        
* Keywords

bigtap suite setup
    base suite setup         
    rest add interface role  s1  ${filter_1}  filter  ${filter_nick_1}   
    rest add interface role  s1  ${delivery_1}  delivery  ${delivery_nick_1}
    rest add interface role  s2  ${filter_2}  filter  ${filter_nick_2}   
    rest add interface role  s2  ${delivery_2}  delivery  ${delivery_nick_2}    
    rest add interface role  s3  ${filter_3}  filter  ${filter_nick_3}   
    rest add interface role  s3  ${delivery_3}  delivery  ${delivery_nick_3}
    rest add interface role  s4  ${filter_4}  filter  ${filter_nick_4}   
    rest add interface role  s4  ${delivery_4}  delivery  ${delivery_nick_4}
    rest add interface role  s5  ${filter_5}  filter  ${filter_nick_5}   
    rest add interface role  s5  ${delivery_5}  delivery  ${delivery_nick_5}
    rest add interface role  s6  ${filter_6}  filter  ${filter_nick_6}   
    rest add interface role  s6  ${delivery_6}  delivery  ${delivery_nick_6}                
    Sleep  5
    rest add policy  admin-view  ${policy_name_1}  forward
    rest add policy match  admin-view  ${policy_name_1}  1  {"any-traffic": true, "sequence": 1}
    rest add policy interface  admin-view  ${policy_name_1}  ${filter_nick_1}  filter
    rest add policy interface  admin-view  ${policy_name_1}  ${delivery_nick_1}  delivery
    rest add policy  admin-view  ${policy_name_2}  forward
    rest add policy match  admin-view  ${policy_name_2}  1  {"any-traffic": true, "sequence": 1}
    rest add policy interface  admin-view  ${policy_name_2}  ${filter_nick_2}  filter
    rest add policy interface  admin-view  ${policy_name_2}  ${delivery_nick_2}  delivery
    rest add policy  admin-view  ${policy_name_3}  forward
    rest add policy match  admin-view  ${policy_name_3}  1  {"any-traffic": true, "sequence": 1}
    rest add policy interface  admin-view  ${policy_name_3}  ${filter_nick_3}  filter
    rest add policy interface  admin-view  ${policy_name_3}  ${delivery_nick_3}  delivery
    rest add policy  admin-view  ${policy_name_4}  forward
    rest add policy match  admin-view  ${policy_name_4}  1  {"any-traffic": true, "sequence": 1}
    rest add policy interface  admin-view  ${policy_name_4}  ${filter_nick_4}  filter
    rest add policy interface  admin-view  ${policy_name_4}  ${delivery_nick_4}  delivery
    rest add policy  admin-view  ${policy_name_5}  forward
    rest add policy match  admin-view  ${policy_name_5}  1  {"any-traffic": true, "sequence": 1}
    rest add policy interface  admin-view  ${policy_name_5}  ${filter_nick_5}  filter
    rest add policy interface  admin-view  ${policy_name_5}  ${delivery_nick_5}  delivery
    rest add policy  admin-view  ${policy_name_6}  forward
    rest add policy match  admin-view  ${policy_name_6}  1  {"any-traffic": true, "sequence": 1}
    rest add policy interface  admin-view  ${policy_name_6}  ${filter_nick_6}  filter
    rest add policy interface  admin-view  ${policy_name_6}  ${delivery_nick_6}  delivery
    Sleep  5

traffic test setup
    ixia initialize  tg1  init=true
        
verify results   [Arguments]  ${send_port}  ${recv_port}  ${transmitted_frames}  ${received_valid_frames}
    Sleep  5
    ${report}=  fetch port stats
    ${tx_value}=  verify dict key  ${report}  ${send_port}  ${transmitted_frames}
    ${rx_value}=  verify dict key  ${report}  ${recv_port}  ${received_valid_frames}
    ${in_range}=  ixia verify traffic rate  ${tx_value}  ${rx_value}
    Should be true  ${in_range}
    
traffic teardown
    delete traffic
    sleep  2
    
bigtap suite teardown
    rest delete policy  admin-view  ${policy_name_1}
    rest delete policy  admin-view  ${policy_name_2}
    rest delete policy  admin-view  ${policy_name_3}
    rest delete policy  admin-view  ${policy_name_4}
    rest delete policy  admin-view  ${policy_name_5}
    rest delete policy  admin-view  ${policy_name_6}                    
    rest delete interface role  s1  ${filter_1}  filter  ${filter_nick_1} 
    rest delete interface role  s1  ${delivery_1}  delivery  ${delivery_nick_1}
    rest delete interface role  s2  ${filter_2}  filter  ${filter_nick_2} 
    rest delete interface role  s2  ${delivery_2}  delivery  ${delivery_nick_2}
    rest delete interface role  s3  ${filter_3}  filter  ${filter_nick_3} 
    rest delete interface role  s3  ${delivery_3}  delivery  ${delivery_nick_3}
    rest delete interface role  s4  ${filter_4}  filter  ${filter_nick_4} 
    rest delete interface role  s4  ${delivery_4}  delivery  ${delivery_nick_4}
    rest delete interface role  s5  ${filter_5}  filter  ${filter_nick_5} 
    rest delete interface role  s5  ${delivery_5}  delivery  ${delivery_nick_5}
    rest delete interface role  s6  ${filter_6}  filter  ${filter_nick_6} 
    rest delete interface role  s6  ${delivery_6}  delivery  ${delivery_nick_6}                    
    rest delete interface  s1  ${filter_1}
    rest delete interface  s1  ${delivery_1}
    rest delete interface  s2  ${filter_2}
    rest delete interface  s2  ${delivery_2}
    rest delete interface  s3  ${filter_3}
    rest delete interface  s3  ${delivery_3}
    rest delete interface  s4  ${filter_4}
    rest delete interface  s4  ${delivery_4}
    rest delete interface  s5  ${filter_5}
    rest delete interface  s5  ${delivery_5}
    rest delete interface  s6  ${filter_6}
    rest delete interface  s6  ${delivery_6}                    
    rest delete switch  s1
    rest delete switch  s2
    rest delete switch  s3
    rest delete switch  s4
    rest delete switch  s5
    rest delete switch  s6    
    base suite teardown        