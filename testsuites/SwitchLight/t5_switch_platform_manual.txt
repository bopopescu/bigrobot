* Settings
Documentation     T5  Switch Platform Test suite- Iron Horse
#Suite Setup       T5 switch platform test setup
#Suite Teardown    T5 switch platform test teardown
Test Setup        base test setup
Force Tags        T5  switch  Platform  IronHorse 
...             
...            
...                        
Library         keywords/BsnCommon.py
Library         keywords/SwitchLight.py
Library         keywords/AppController.py
Library         keywords/Ixia.py 
Library         keywords/T5.py   
Library         keywords_dev/kranti/ironhorse/T5SwitchPlatform.py  
Library         String
#Resource        keywords_dev/kranti/ironhorse/snake_traffic_test_variables.txt


*Variables
${switchlight_version}  SwitchLight
${netmask}  18
${gateway}  10.192.64.1
${dns_server}  10.192.3.1
${dns_domain}  bigswitch.com
${j}    1
${switch1_name}=  spine01
${switch2_name}=  leaf01
${switch3_name}=  leaf02
${tenant}=        testTenant 
${vns}=           v1
${vlan}=          -1
${intf_1}=        ethernet1
${intf_2}=        ethernet2
${intf_3}=        ethernet3
${intf_4}=        ethernet4

${intf_6}=        ethernet45
${intf_7}=        ethernet46
${intf_8}=        ethernet47
${intf_9}=        ethernet48

${count}=         1 
${ratetolerance}=     10
${tolerance}=         5
${sleepAfter}=    10
${sleepBefore}=   5


### Section A: ONIE, OFAUX Channel  

*Test Case
      
Verify ONIE installed switch gets switchLite installer
    Log     Step 1 - Verify ONIE gets switchLite installer image
    Log     Step 2 - Verify that after the installer you get loader prompt
    [Tags]  T5  switch  install  
    [Tags]  Manual
    Manual passed

Verify switchLight Installer upgrades another switchLite image
    Log     Step 1 - Verify switchLight Installer can upgrade to another swithcLigh image
    [Tags]  T5  switch  install 
    [Tags]  Manual
    Manual passed
    
Verify console connectivity
    Log    Step 1 - Verify access the console through telnet
    [Tags]  T5  switch  install
    [Tags]  Manual
    Manual passed

Verify UBoot version DRAM etc
    Log    Step 1 - Verify the Uboot version
    Log    Step 2 - Verify the DRAM
    [Tags]  T5  switch  install 
    [Tags]  Manual-untested
    Manual untested

Configure Static ip address, gateway, server ip
    Log    Step 1 - Verify the configuration of static Ip address
    Log    Step 2 - Verify the configuration of Gateway 
    Log    Step 3 - Verify the configuration of server ip    
    [Tags]  T5  switch  install 
    [Tags]  Manual
    Manual passed

Reboot Switch and verify the loader parameters like IP, gateway etc
    Log    Step 1 - Verify after reboot configuration of static Ip address
    Log    Step 2 - Verify after reboot configuration of Gateway 
    Log    Step 3 - Verify after reboot the configuration of server ip    
    [Tags]  T5  switch  install 
    [Tags]  Manual
    Manual passed

Verify after loader env configuration Ping to Switch 
    Log    Step 1 - Verify after loader env config , Ping to Switch   
    [Tags]  T5  switch  install 
    [Tags]  Manual
    Manual passed

Verify DHCP address configuration, IP address allocation and PING
    Log    Step 1 - Verify DHCP server configuration at loader
    Log    Step 2 - Verify the IP address allocation 
    Log    Step 3 - Verify the PING 
    [Tags]  T5  switch  install 
    [Tags]  Manual-untested
    Manual untested 
    
Reboot box and Verify the IP address through DHCP server and Ping 
    Log    Step 1 - Verify after reboot IP address allocation thru DHCP 
    Log    Step 2 - Verify the PING connectivity 
    [Tags]  T5  switch  install 
    [Tags]  Manual-untested
    Manual untested 
   
Verify environmental variables for CPU, RAM, PCI, Ethernet, EEPROM at loader 
    Log    Step 1 - Verify the environmrntal variables 
    [Tags]  T5  switch  install 
    [Tags]  Manual-untested
    Manual untested
        
Verify image installation using USB 
    Log    Step 1 - Verify that the USB image installation is supported 
    [Tags]  T5  switch  install 
    [Tags]  Manual-untested
    Manual untested 
    
Verify the recovery procedure of Switch 
    Log    Step 1 - verify that the Switch can be recovered by the defined procedure 
    [Tags]  T5  switch  install 
    [Tags]  Manual-untested
    Manual untested 
    
Verify Customer Deployment method ZTN 
    Log    Step 1 - Verify the package/installation procedure for Switch
    [Tags]  T5  platform  install 
    [Tags]  Manual-untested
    Manual untested
        
### SECTION B: Initial Configuration and ZTN

Verify the Switch configuration after ZTN 
    Log    Step 1 - Verify the Switch Configuration after ZTN
    [Tags]  T5  switch  ZTN
    [Tags]  Manual-untested
    Manual untested 
    
Verify Switch connectivity after ZTN 
    Log    Step 1 - Verify Switch is pingable
    [Tags]  T5  switch  ZTN  
    [Tags]  Manual-untested
    Manual untested 
    
Verify Switch Configuration - Allowed or Not Allowed Configuration 
    Log    Step 1 - Verify the What Switch Configuration are allowwed Not Allowed
    [Tags]  T5  switch  ZTN  
    [Tags]  Manual-untested
    Manual untested 
    
Verify Switch DHCP address - Is it Configurable in ZTN
    [Tags]  T5  switch  ZTN  
    [Tags]  Manual-untested
    Manual untested 
    
Verify invalid out of Subnet address configurable 
    Log    Step 1 - Verify the invalid/out of subnet IP address configurable? 
    Log    Step 2 - Any provision for deletion?
    [Tags]  T5  switch  InitialConfig     
    [Tags]  Manual-untested
    Manual untested 
        
Verify management port comes up after removing and reinserting cable 
    Log    Step 1 - Verify the Management Port config after cable remove and re-insertion
    [Tags]  T5  switch  InitialConfig
    [Tags]  Manual
    Manual Passed
    
Verify multiple SSH connections to Management Port 
    Log    Step 1 - Verify multiple SSH connections to Management Port
    [Tags]  T5  switch  InitialConfig
    [Tags]  Manual 
    Manual Passed
    
Verify multiple telnet connections to Management Port 
    Log    Step 1 - Verify multiple telnet connections to Management Port
    [Tags]  T5  switch  InitialConfig
    [Tags]  Manual
    Manual Passed
    
Verify after failure of Master Controller switch connection with backup is re established
    Log    Step 1 - Both Controller connection is present 
    Log    Step 2 - Master Controller fails and connection is removed 
    Log    Step 3 - Connection to Back up controller is established
    [Tags]  T5  switch  HA 
    [Tags]  Manual
    Manual Passed
    
Verify after Master Controller comes back Connection reestablished 
    Log    Step 1 - Verify connection re-establishes after Master Controller connection comes back 
    Log    Step 2 - Verify the correct information for Master/Backup Controller
    [Tags]  T5  switch  HA 
    [Tags]  Manual
    Manual Passed

    
### Section C : Admin/User Authentication 
### Allowed/Required From Controller Only ??

Verify user admin can be configured with password adminadmin on the box 
    Log    Step 1 - Verify user admin can be configured with password adminadmin on the box
    [Tags]  T5  switch  UserConfig
    [Tags]  Manual
    Manual Passed
    
Verify password for user admin can be changed  
    Log    Step 1 - Verify password for user admin can be changed
    [Tags]  T5  switch  UserConfig 
    [Tags]  Manual
    Manual Passed

Verify password for user admin cannot be of zero length   
    Log    Step 1 - Verify password for user admin cannot be of zero length
    [Tags]  T5  switch  UserConfig  
    [Tags]  Manual-untested
    Manual untested
        
Verify Passwords are case sensitive   
    Log    Step 1 - Verify Passwords are case-sensitive
    [Tags]  T5  switch  UserConfig
    [Tags]  Manual
    Manual Passed

Verify max length for passwords    
    Log    Step 1 - Verify max-length for passwords
    [Tags]  T5  switch  UserConfig   
    [Tags]  Manual-untested
    Manual untested

Verify special characters are allowed in passwords 
    Log    Step 1 - Verify special characters are allowed in passwords
    [Tags]  T5  switch  UserConfig   
    [Tags]  Manual
    Manual Passed
    
Verify user recovery can be configured and user can login using the username password combination
    Log    Step 1 - Verify user recovery can be configured and user can login using the username/password combination
    [Tags]  T5  switch  UserConfig   
    [Tags]  Manual
    Manual Passed

Verify other users except admin or recovery not allowed   
    Log    Step 1 - Verify other users except admin or recovery not allowed
    Log    Step 2 - Verify proper error message is displayed
    [Tags]  T5  switch  UserConfig  
    [Tags]  Manual
    Manual Passed

Restart process ofad and verify users admin and recovery can re login
    Log    Step 1 - Restart process ofad and verify users admin and recovery can re-login
    [Tags]  T5  switch  UserConfig   
    [Tags]  Manual
    Manual Passed
    
    
### Section D: System Admin Operation
### What is allowed from Controller and What is allowed from Switch??

Verify NTP Config / Sync
    Log    Step 1 - Verify NTP Config / Sync
    [Tags]  T5  switch  ntp
    [Tags]  Manual
    Manual Passed
    
Config admin save/reload operation 
    Log    Step 1 - Config admin save/reload operation
    [Tags]  T5  switch  SysAdminOperation   
    [Tags]  Manual-untested
    Manual untested
    
Config upload/ ftp / reload operation 
    Log    Step 1 - Config upload/ ftp / reload operation
    [Tags]  T5  switch  SysAdminOperation 
    [Tags]  Manual-untested
    Manual untested
    
Config upload/ scp / reload operation 
    Log    Step 1 - Config upload/ scp / reload operation
    [Tags]  T5  switch  SysAdminOperation 
    [Tags]  Manual-untested
    Manual untested
    
Verify Syslog Server config - logs creation/ rollover / after reboot verification
    Log    Step 1 - Verify Syslog Server config - logs creation/ rollover / after reboot verification
    [Tags]  T5  switch  SysAdminOperation
    [Tags]  Manual-untested
    Manual untested

###
### Section F:Switch Platform Environment Variables 
###

Verify the environment information is displayed
    Log    Step 1 - Verify the environment information is displayed
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed

Verify Power Supply Status
    Log    Step 1 - Verify Power Supply Status
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed

Verify Temperatures are in the appropriate ranges
    Log    Step 1 - Verify Temperatures are in the appropriate ranges
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed

Verify Fans are running at normal speeds
    Log    Step 1 - Verify Fans are running at normal speeds
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed

Verify fans are running at higher speeds when temperature increases
    Log    Step 1 - Verify fans are running at higher speeds when temperature increases
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed

Verify alarms are enerated in syslog in case of fan failure
    Log    Step 1 - Verify alarms are generated in syslog in case of fan failure
    [Tags]  T5  switch  Environment 
    [Tags]  Manual  jira-pan-667
    Manual Failed

Verify time and date information is NOT lost after reboot
    Log    Step 1 - Verify time and date information is NOT lost after reboot
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed

Verify Periodic polling of Temp sensor fans
    Log    Step 1 - Verify Periodic polling of Temp sensor fans
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed

Verify if fan speed/status is updated in output of show sensors
    Log    Step 1 - Verify if fan speed/status is updated in output of show sensors
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed

Verify if temperature values and sensor status are updated in output of show sensors
    Log    Step 1 - Verify if temperature values and sensor status are updated in output of show sensors
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed

PSU failure test - Bring up , Failure back up PSU AC ,alarm , messages
    Log    Step 1 - PSU failure test - Bring up , Failure back up PSU ,alarm , messages
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed
    
Verify power output when DUT use one AC power supply
    Log    Step 1 - Verify power output when DUT use one power supply
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed    

Verify power output when DUT use two AC power supplies
    Log    Step 1 - Verify power output when DUT use two power supplies
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed    

With both AC power supplies and system up and running, remove one power supply and verify
    Log    Step 1 - With both power supplies and system up and running, remove one power supply and verify
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed    


Repeat previous testcase with the other AC power supply
    Log    Step 1 - Repeat previous testcase with the other power supply
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed    

With one AC power supply and system up and running, add second power supply and verify
    Log    Step 1 - With one power supply and system up and running, add second power supply and verify
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed    

VErify with PSU2 with the other AC power supply
    Log    Step 1 - Repeat previous testcase with the other power supply
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed    

Verify power output when DUT use one DC power supply
    Log    Step 1 - Verify power output when DUT use one power supply
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed    

Verify power output when DUT use two DC power supplies
    Log    Step 1 - Verify power output when DUT use two power supplies
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed    

With both DC power supplies and system up and running, remove one power supply and verify
    Log    Step 1 - With both power supplies and system up and running, remove one power supply and verify
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed    

Repeat previous testcase with the other DC power supply
    Log    Step 1 - Repeat previous testcase with the other power supply
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed    

With one DC power supply and system up and running, add second power supply and verify
    Log    Step 1 - With one power supply and system up and running, add second power supply and verify
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed    

Verify with PSU2 with the other DC power supply
    Log    Step 1 - Repeat previous testcase with the other power supply
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed
   
### Section G: LED Test 
###
###
Verify LED behavior during and after boot up 
    Log    Step 1 - Verify the LED behavior during and after boot up 
    [Tags]  T5  switch  LED  
    [Tags]  Manual  jira-pan-675
    Manual Failed    

Verify LED behavior when link is up down disable 
    Log    Step 1 - Verify the LED behavior when link is up 
    Log    Step 1 - Verify the LED behavior when link is down
    Log    Step 1 - Verify the LED behavior when link is admin disable 
    [Tags]  T5  switch  LED  
    [Tags]  Manual  jira-pan-675
    Manual Failed

Verify Activity LED and Status LED for a MGMT Port and data ports when no cable is connected
    Log    Step 1 - Verify Activity LED and Status LED for a MGMT Port and data ports when no cable is connected
    [Tags]  T5  switch  LED
    [Tags]  Manual  jira-pan-675
    Manual Failed   

Verify Activity LED and Status LED for a MGMT Port and data ports when port is connected to TG
    Log    Step 1 - Verify Activity LED and Status LED for a MGMT Port and data ports when port is connected to TG
    [Tags]  T5  switch  LED
    [Tags]  Manual  jira-pan-675
    Manual Failed    

Verify Activity LED and Status LED for a MGMT Port and data ports when cable is disconnected from the other end
    Log    Step 1 - Verify Activity LED and Status LED for a MGMT Port and data ports when cable is disconnected from the other end
    [Tags]  T5  switch  LED
    [Tags]  Manual  jira-pan-675
    Manual Failed    

Verify that all the all network LEDs goes off when systems is halted
    Log    Step 1 - Verify that all the all network LEDs goes off when systems is halted
    [Tags]  T5  switch  LED
    [Tags]  Manual  jira-pan-675
    Manual Failed    

###
### Section H: CLI Configuration and Show commands 
### Confirm the CLI from Controller only 
### Some verification require switch side verification
###

Verify Show version
    Log    Step 1 - Verify Show version
    [Tags]  T5  switch  CLI
    [Tags]  Manual
     Manual Passed

Verify Show running-config
    Log    Step 1 - Verify Show running-config
    [Tags]  T5  switch  CLI  Manual  
     Manual Passed
    
Verify Admin save partial save config allowed config load reload merge override
    Log    Step 1 - Verify Admin save partial save config allowed config load reload merge override
    [Tags]  Manual-untested
    Manual untested
    
Verify Config commit error flag invalid config missing config part check 
    Log    Step 1 - Verify Config commit error flag invalid config missing config part check 
    [Tags]  Manual-untested
    Manual untested
    
Verify CLI reload command option - Config persistent after save
    Log    Step 1 - Verify CLI reload command option - Config persistent after save
    [Tags]  T5  switch  CLI  Manual
    Manual Passed
    

###
### Section I : Interface , Optics , LED 
###
###
         

Verify all interfaces show up after sw installation 
    Log    Step 1 - Verify all interfaces show up after sw installation
    [Tags]  Manual  interface
    Manual Passed

Verify that the various transceivers are detected in the uplink module and they are up and running 
    Log    Step 1 - Verify that the various transceivers are detected in the uplink module and they are up and running
    [Tags]  Manual-untested  interface  optics
    Manual untested

Verify interface op is consistent and as per spec in show interfaces op 
    Log    Step 1 - Verify interface op is consistent and as per spec in show interfaces op
    [Tags]  T5  switch  interface
    Manual Passed

Verify end-to-end ping system-test 
    Log    Step 1 - Verify end-to-end ping system-test
    [Tags]  Manual-untested  interface
    Manual untested

Verify auto-negotiation configurations work as expected 
    Log    Step 1 - Verify auto-negotiation configurations work as expected
    [Tags]  Manual-untested  interface
    Manual untested

Verify Auto- negotiation enabled on both ends of interface
    Log    Step 1 - Verify Auto- negotiation enabled on both ends of interface
    [Tags]  Manual-untested  interface
    Manual untested

Verify Speed/Duplex in ports 
    Log    Step 1 - Verify Speed/Duplex in ports
    [Tags]  Manual-untested  interface
    Manual untested

Verify interface state is reported correctly when cable is unplugged. 
    Log    Step 1 - Verify interface state is reported correctly when cable is unplugged. 
    [Tags]  Manual-untested  interface
    Manual untested

Verify that the options are maintained on the interface after the system reboot. 
    Log    Step 1 - Verify that the options are maintained on the interface after the system reboot.
    [Tags]  Manual-untested  interface
    Manual untested

Verify the logging of openflow events in the Switch 
    Log    Step 1 - Verify the openflow events are being Logged in switch syslog 
    [Tags]  Manual-untested  Logging
    Manual untested

Verify the logging of interface events up down disabe in the Switch 
    Log    Step 1 - Verify the interface events are being Logged in switch syslog 
    [Tags]  Manual-untested  Logging
    Manual untested

Verify the logging of process events restart in the Switch 
    Log    Step 1 - Verify the process events are being Logged in switch syslog 
    [Tags]  Manual-untested  Logging
    Manual untested

Verify the logging of PSU insertion removal error events in the Switch 
    Log    Step 1 - Verify the PSU insertion removal error events are being Logged in switch syslog 
    [Tags]  Manual-untested  Logging
    Manual untested

Verify the logging of Error events management failure in the Switch 
    Log    Step 1 - Verify the Error events management failure are being Logged in switch syslog 
    [Tags]  Manual-untested  Logging
    Manual untested

Verify the logging of optics cable type in the Switch 
    Log    Step 1 - Verify the optics cable type are being Logged in switch syslog 
    [Tags]  Manual-untested  Logging
    Manual untested

Verify the logging of fan failure heat sensors high temp in the Switch 
    Log    Step 1 - Verify the fan failure heat sensors high temp are being Logged in switch syslog 
    [Tags]  Manual-untested  Logging
    Manual untested

Verify the debugging of environmental fan failure heat sensors high temp in the Switch 
    Log    Step 1 - Verify the environmental fan failure heat sensors high temp are being shown in switch 
    [Tags]  Manual-untested  Debug
    Manual untested

Verify the debugging of openFlow connection estabish disconnection in the Switch 
    Log    Step 1 - Verify the openFlow connection estabish disconnection are being Logged and show in switch 
    [Tags]  Manual-untested  Debug
    Manual untested

Verify the debugging of interface stats counters status in the Switch 
    Log    Step 1 - Verify the interface stats counters status can be shown in switch
    [Tags]  Manual-untested  Debug
    Manual untested

Verify the debugging of port group lag in the Switch 
    Log    Step 1 - Verify the port group lag can be shown in switch
    [Tags]  Manual-untested  Debug
    Manual untested

Verify the debugging of vlan in the Switch 
    Log    Step 1 - Verify the vlan can be shown in switch
    [Tags]  Manual-untested  Debug
    Manual untested

Verify the debugging of vns in the Switch 
    Log    Step 1 - Verify the vns can be shown in switch
    [Tags]  Manual-untested  Debug
    Manual untested
    
Verify the debugging of forwarding programming in the Switch 
    Log    Step 1 - Verify the forwarding programming can be shown in switch
    [Tags]  Manual-untested  Debug
    Manual untested



* Keywords
      
#T5 switch platform test setup
#   base test setup
#   rest add switch  ${switch1_name}
#   ${swDpid1}=  rest return switch dpid from ip  s1
#   rest add dpid  ${switch1_name}   ${swDpid1}
#   rest add fabric role  ${switch1_name}  spine
#     
#   rest add switch  ${switch2_name}
#   ${swDpid2}=  rest return switch dpid from ip  s2
#   rest add dpid  ${switch2_name}   ${swDpid2}
#   rest add fabric role  ${switch2_name}  leaf
#   
#   rest add switch  ${switch3_name}
#   ${swDpid3}=  rest return switch dpid from ip  s3
#   rest add dpid  ${switch3_name}   ${swDpid3}
#   rest add fabric role  ${switch3_name}  leaf
                
#T5 switch platform test teardown
#   rest delete tenant  ${tenant}  
#   rest delete fabric switch  ${switch1_name} 
#   rest delete fabric switch  ${switch2_name}
#   rest delete fabric switch  ${switch3_name}
#   base test teardown
#   sleep  5   

