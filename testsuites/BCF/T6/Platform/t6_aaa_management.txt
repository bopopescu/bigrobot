*Settings
Documentation   T6 Tacacs Test Suite Release:Jack Frost
Suite Setup     AAA Suite Setup
Suite Teardown  AAA Suite Teardown
Test Setup      AAA Test Setup
Test Teardown   AAA Test Teardown
Force Tags   JackFrost  T6  Platform  AAA
Library  OperatingSystem
Library  keywords/T5.py
Library  keywords/T5Platform.py
Library  keywords/T5Utilities.py
Library  keywords/AppController.py
Library  keywords/BsnCommon.py
Library  keywords/BigTap.py
Library  Collections.py

* Variable
${projectname}  Big Cloud Fabric Appliance
@{radius_servers}  10.2.3.201  10.8.67.3  10.8.67.4
@{tacacs_servers}  10.2.3.201  10.9.18.2  10.8.67.3
@{servers}
${type}
    
* Test Case
T0.0 Verify limit of configurable AAA servers
    Configure Three AAA Servers
    Cli Run  ${master_name}  enable; configure; ${type} server host 4.4.4.4  reauth=True
    Cli Run  ${master_name}  enable; configure; ${type} server host 5.5.5.5  reauth=True
    Run Keyword and Expect Error  *Error: List size exceeds max-elements*
    ...  Cli Run  ${master_name}  enable; configure; ${type} server host 6.6.6.6  reauth=True

T0.1. Zero Configured AAA Servers & Set Authentication to Local
    Set Authentication to Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console

T0.2. Zero Configured AAA Servers & Set Authentication to Remote
    Set Authentication to Remote
    Run Keyword and Expect Error  *  Verify Admin Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Admin Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Local User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console

T0.3. Zero Configured AAA Servers & Set Authentication to Local then Remote
    Set Authentication to Local then Remote
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console

T0.4. Zero Configured AAA Servers & Set Authentication to Remote then Local
    Set Authentication to Remote then Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console

T1.1.1. One Configured & Reachable AAA Server & Correct Secret & Set Authentication to Local
    Configure One AAA Server
    Set Authentication to Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console

T1.1.2. One Configured & Reachable AAA Server & Incorrect Secret & Set Authentication to Local
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console

T1.1.3. One Configured & Unreachable AAA Server & Set Authentication to Local
    Set Authentication to Local
    Configure One Unreachable AAA Server
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console

T1.2.1. One Configured & Reachable AAA Server & Correct Secret & Set Authentication to Remote
    Configure One AAA Server
    Set Authentication to Remote
    Run Keyword and Expect Error  *  Verify Admin Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Admin Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Local User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console

T1.2.2. One Configured & Reachable AAA Server & Incorrect Secret & Set Authentication to Remote
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Remote
    Run Keyword and Expect Error  *  Verify Admin Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Admin Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Local User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console


T1.2.3. One Configured & Unreachable AAA Server & Set Authentication to Remote
    Configure One Unreachable AAA Server
    Set Authentication to Remote
    Run Keyword and Expect Error  *  Verify Admin Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Admin Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Local User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console



T1.3.1. One Configured & Reachable AAA Server & Correct Secret & Set Authentication to Local then Remote
    Configure One AAA Server
    Set Authentication to Local then Remote
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T1.3.2. One Configured & Reachable AAA Server & Incorrect Secret & Set Authentication to Local then Remote
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Local then Remote
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console


T1.3.3. One Configured & Unreachable AAA Server & Set Authentication to Local then Remote
    Configure One Unreachable AAA Server
    Set Authentication to Local then Remote
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console


T1.4.1. One Configured & Reachable AAA Server & Correct Secret & Set Authentication to Remote then Local
    Configure One AAA Server
    Set Authentication to Remote then Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T1.4.2. One Configured & Reachable AAA Server & Incorrect Secret & Set Authentication to Remote then Local
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Remote then Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console


T1.4.3. One Configured & Unreachable AAA Server & Set Authentication to Remote then Local
    Configure One Unreachable AAA Server
    Set Authentication to Remote then Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console



T2.1.1 Two Configured & Reachable AAA Servers & Correct Secret & Set Authentication to Local
    Configure Two AAA Servers
    Set Authentication to Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console


T2.1.2 Two Configured & Reachable AAA Servers & First Correct Secret & Set Authentication to Local
    Configure One AAA Server
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console


T2.1.3 Two Configured & Reachable AAA Servers & Second Correct Secret & Set Authentication to Local
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server
    Set Authentication to Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console


T2.1.4 Two Configured & Reachable AAA Servers & Incorrect Secret & Set Authentication to Local
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console






T2.2.1 Two Configured & Reachable AAA Servers & Correct Secret & Set Authentication to Remote
    Configure Two AAA Servers
    Set Authentication to Remote
    Run Keyword and Expect Error  *  Verify Admin Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Admin Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Local User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T2.2.2 Two Configured & Reachable AAA Servers & First Correct Secret & Set Authentication to Remote
    Configure One AAA Server
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Remote
    Run Keyword and Expect Error  *  Verify Admin Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Admin Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Local User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T2.2.3 Two Configured & Reachable AAA Servers & Second Correct Secret & Set Authentication to Remote
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server
    Set Authentication to Remote
    Run Keyword and Expect Error  *  Verify Admin Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Admin Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Local User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T2.2.4 Two Configured & Reachable AAA Servers & Incorrect Secret & Set Authentication to Remote
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Remote
    Run Keyword and Expect Error  *  Verify Admin Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Admin Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Local User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console



T2.3.1 Two Configured & Reachable AAA Servers & Correct Secret & Set Authentication to Local then Remote
    Configure Two AAA Servers
    Set Authentication to Local then Remote
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T2.3.2 Two Configured & Reachable AAA Servers & First Correct Secret & Set Authentication to Local then Remote
    Configure One AAA Server
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Local then Remote
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T2.3.3 Two Configured & Reachable AAA Servers & Second Correct Secret & Set Authentication to Local then Remote
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server
    Set Authentication to Local then Remote
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T2.3.4 Two Configured & Reachable AAA Servers & Incorrect Secret & Set Authentication to Local then Remote
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Local then Remote
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console



T2.4.1 Two Configured & Reachable AAA Servers & Correct Secret & Set Authentication to Remote then Local
    Configure Two AAA Servers
    Set Authentication to Remote then Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T2.4.2 Two Configured & Reachable AAA Servers & First Correct Secret & Set Authentication to Remote then Local
    Configure One AAA Server
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Remote then Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T2.4.3 Two Configured & Reachable AAA Servers & Second Correct Secret & Set Authentication to Remote then Local
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server
    Set Authentication to Remote then Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T2.4.4 Two Configured & Reachable AAA Servers & Incorrect Secret & Set Authentication to Remote then Local
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Remote then Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console








T2.5.1 Two Configured & First Reachable AAA Servers & Correct Secret & Set Authentication to Local
    Configure One AAA Server
    Configure One Unreachable AAA Server
    Set Authentication to Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console


T2.5.2 Two Configured & First Reachable AAA Servers & Second Correct Secret & Set Authentication to Local
    Configure One AAA Server With Incorrect Secret
    Configure One Unreachable AAA Server
    Set Authentication to Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console





T2.6.1 Two Configured & First Reachable AAA Servers & Correct Secret & Set Authentication to Remote
    Configure One AAA Server
    Configure One Unreachable AAA Server
    Set Authentication to Remote
    Run Keyword and Expect Error  *  Verify Admin Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Admin Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Local User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T2.6.2 Two Configured & First Reachable AAA Servers & Second Correct Secret & Set Authentication to Remote
    Configure One AAA Server With Incorrect Secret
    Configure One Unreachable AAA Server
    Set Authentication to Remote
    Run Keyword and Expect Error  *  Verify Admin Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Admin Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Local User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console



T2.7.1 Two Configured & First Reachable AAA Servers & Correct Secret & Set Authentication to Local then Remote
    Configure One AAA Server
    Configure One Unreachable AAA Server
    Set Authentication to Local then Remote
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T2.7.2 Two Configured & First Reachable AAA Servers & Second Correct Secret & Set Authentication to Local then Remote
    Configure One AAA Server With Incorrect Secret
    Configure One Unreachable AAA Server
    Set Authentication to Local then Remote
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console
# failing in IH+ at "Verify Admin Can Log In via Serial Console" because
# PAM times out before TACACS servers for Accounting return their timeouts


T2.8.1 Two Configured & First Reachable AAA Servers & Correct Secret & Set Authentication to Remote then Local
    Configure One AAA Server
    Configure One Unreachable AAA Server
    Set Authentication to Remote then Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console

T2.8.2 Two Configured & First Reachable AAA Servers & Second Correct Secret & Set Authentication to Remote then Local
    Configure One AAA Server With Incorrect Secret
    Configure One Unreachable AAA Server
    Set Authentication to Remote then Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console
# failing in IH+ at "Verify Admin Can Log In via Serial Console" because
# PAM times out before TACACS servers for Accounting return their timeouts


T2.9.1 Two Configured & Second Reachable AAA Servers & Correct Secret & Set Authentication to Local
    Configure One Unreachable AAA Server
    Configure One AAA Server
    Set Authentication to Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console

T2.9.2 Two Configured & Second Reachable AAA Servers & Incorrect Secret & Set Authentication to Local
    Configure One Unreachable AAA Server
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console



T2.10.1 Two Configured & Second Reachable AAA Servers & Correct Secret & Set Authentication to Remote
    Configure One Unreachable AAA Server
    Configure One AAA Server
    Set Authentication to Remote
    Run Keyword and Expect Error  *  Verify Admin Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Admin Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Local User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T2.10.2 Two Configured & Second Reachable AAA Servers & Incorrect Secret & Set Authentication to Remote
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Remote
    Run Keyword and Expect Error  *  Verify Admin Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Admin Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Local User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console



T2.11.1 Two Configured & Second Reachable AAA Servers & Correct Secret & Set Authentication to Local then Remote
    Configure One Unreachable AAA Server
    Configure One AAA Server
    Set Authentication to Local then Remote
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T2.11.2 Two Configured & Second Reachable AAA Servers & Incorrect Secret & Set Authentication to Local then Remote
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Local then Remote
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console



T2.12.1 Two Configured & Second Reachable AAA Servers & Correct Secret & Set Authentication to Remote then Local
    Configure One Unreachable AAA Server
    Configure One AAA Server
    Set Authentication to Remote then Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console



T2.12.2 Two Configured & Second Reachable AAA Servers & Incorrect Secret & Set Authentication to Remote then Local
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Remote then Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console




T2.13.1 Two Configured & Unreachable AAA Servers & Set Authentication to Local
    Configure One Unreachable AAA Server
    Configure One Unreachable AAA Server
    Set Authentication to Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console

T2.13.2 Two Configured & Unreachable AAA Servers & Set Authentication to Remote
    Configure One Unreachable AAA Server
    Configure One Unreachable AAA Server
    Set Authentication to Remote
    Run Keyword and Expect Error  *  Verify Admin Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Admin Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Local User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console

T2.13.3 Two Configured & Unreachable AAA Servers & Set Authentication to Local then Remote
    Configure One Unreachable AAA Server
    Configure One Unreachable AAA Server
    Set Authentication to Local then Remote
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console
# failing in IH+ at "Verify Admin Can Log In via Serial Console" because
# PAM times out before TACACS servers for Accounting return their timeouts

T2.13.4 Two Configured & Unreachable AAA Servers & Set Authentication to Remote then Local
    Configure One Unreachable AAA Server
    Configure One Unreachable AAA Server
    Set Authentication to Remote then Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console
# failing in IH+ at "Verify Admin Can Log In via Serial Console" because
# PAM times out before TACACS servers for Accounting return their timeouts


T3.1.1 Three Configured & Reachable AAA Servers & Correct Secret & Set Authentication to Local
    Configure Three AAA Servers
    Set Authentication to Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console


T3.1.2 Three Configured & Reachable AAA Servers & First Correct Secret & Set Authentication to Local
    Configure One AAA Server
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console


T3.1.3 Three Configured & Reachable AAA Servers & Second Correct Secret & Set Authentication to Local
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console


T3.1.4 Three Configured & Reachable AAA Servers & Third Correct Secret & Set Authentication to Local
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server
    Set Authentication to Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console


T3.1.5 Three Configured & Reachable AAA Servers & Incorrect Secret & Set Authentication to Local
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console





T3.2.1 Three Configured & Reachable AAA Servers & Correct Secret & Set Authentication to Remote
    Configure Three AAA Servers
    Set Authentication to Remote
    Run Keyword and Expect Error  *  Verify Admin Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Admin Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Local User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T3.2.2 Three Configured & Reachable AAA Servers & First Correct Secret & Set Authentication to Remote
    Configure One AAA Server
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Remote
    Run Keyword and Expect Error  *  Verify Admin Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Admin Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Local User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T3.2.3 Three Configured & Reachable AAA Servers & Second Correct Secret & Set Authentication to Remote
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Remote
    Run Keyword and Expect Error  *  Verify Admin Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Admin Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Local User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T3.2.4 Three Configured & Reachable AAA Servers & Third Correct Secret & Set Authentication to Remote
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server
    Set Authentication to Remote
    Run Keyword and Expect Error  *  Verify Admin Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Admin Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Local User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T3.2.5 Three Configured & Reachable AAA Servers & Incorrect Secret & Set Authentication to Remote
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Remote
    Run Keyword and Expect Error  *  Verify Admin Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Admin Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Local User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console



T3.3.1 Three Configured & Reachable AAA Servers & Correct Secret & Set Authentication to Local then Remote
    Configure Three AAA Servers
    Set Authentication to Local then Remote
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console

    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T3.3.2 Three Configured & Reachable AAA Servers & First Correct Secret & Set Authentication to Local then Remote
    Configure One AAA Server
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Local then Remote
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T3.3.3 Three Configured & Reachable AAA Servers & Second Correct Secret & Set Authentication to Local then Remote
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Local then Remote
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T3.3.4 Three Configured & Reachable AAA Servers & Third Correct Secret & Set Authentication to Local then Remote
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server
    Set Authentication to Local then Remote
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T3.3.5 Three Configured & Reachable AAA Servers & Incorrect Secret & Set Authentication to Local then Remote
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Local then Remote
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console



T3.4.1 Three Configured & Reachable AAA Servers & Correct Secret & Set Authentication to Remote then Local
    Configure Three AAA Servers
    Set Authentication to Remote then Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T3.4.2 Three Configured & Reachable AAA Servers & First Correct Secret & Set Authentication to Remote then Local
    Configure One AAA Server
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Remote then Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T3.4.3 Three Configured & Reachable AAA Servers & Second Correct Secret & Set Authentication to Remote then Local
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Remote then Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T3.4.4 Three Configured & Reachable AAA Servers & Third Correct Secret & Set Authentication to Remote then Local
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server
    Set Authentication to Remote then Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T3.4.5 Three Configured & Reachable AAA Servers & Incorrect Secret & Set Authentication to Remote then Local
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server With Incorrect Secret
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Remote then Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console








T3.5.1 Three Configured & First Reachable AAA Servers & Correct Secret & Set Authentication to Local
    Configure One AAA Server
    Configure One Unreachable AAA Server
    Configure One Unreachable AAA Server
    Set Authentication to Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console



T3.5.2 Three Configured & First Reachable AAA Servers & Incorrect Secret & Set Authentication to Local
    Configure One AAA Server With Incorrect Secret
    Configure One Unreachable AAA Server
    Configure One Unreachable AAA Server
    Set Authentication to Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console





T3.6.1 Three Configured & First Reachable AAA Servers & Correct Secret & Set Authentication to Remote
    Configure One AAA Server
    Configure One Unreachable AAA Server
    Configure One Unreachable AAA Server
    Set Authentication to Remote
    Run Keyword and Expect Error  *  Verify Admin Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Admin Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Local User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T3.6.2 Three Configured & First Reachable AAA Servers & Incorrect Secret & Set Authentication to Remote
    Configure One AAA Server With Incorrect Secret
    Configure One Unreachable AAA Server
    Configure One Unreachable AAA Server
    Set Authentication to Remote
    Run Keyword and Expect Error  *  Verify Admin Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Admin Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Local User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console



T3.7.1 Three Configured & First Reachable AAA Servers & Correct Secret & Set Authentication to Local then Remote
    Configure One AAA Server
    Configure One Unreachable AAA Server
    Configure One Unreachable AAA Server
    Set Authentication to Local then Remote
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console



T3.7.2 Three Configured & First Reachable AAA Servers & Incorrect Secret & Set Authentication to Local then Remote
    Configure One AAA Server With Incorrect Secret
    Configure One Unreachable AAA Server
    Configure One Unreachable AAA Server
    Set Authentication to Local then Remote
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console



T3.8.1 Three Configured & First Reachable AAA Servers & Correct Secret & Set Authentication to Remote then Local
    Configure One AAA Server
    Configure One Unreachable AAA Server
    Configure One Unreachable AAA Server
    Set Authentication to Remote then Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T3.8.2 Three Configured & First Reachable AAA Servers & Incorrect Secret & Set Authentication to Remote then Local
    Configure One AAA Server With Incorrect Secret
    Configure One Unreachable AAA Server
    Configure One Unreachable AAA Server
    Set Authentication to Remote then Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console





T3.9.1 Three Configured & Second Reachable AAA Servers & Correct Secret & Set Authentication to Local
    Configure One Unreachable AAA Server
    Configure One AAA Server
    Configure One Unreachable AAA Server
    Set Authentication to Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console


T3.9.2 Three Configured & Second Reachable AAA Servers & Incorrect Secret & Set Authentication to Local
    Configure One Unreachable AAA Server
    Configure One AAA Server With Incorrect Secret
    Configure One Unreachable AAA Server
    Set Authentication to Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console



T3.10.1 Three Configured & Second Reachable AAA Servers & Correct Secret & Set Authentication to Remote
    Configure One Unreachable AAA Server
    Configure One AAA Server
    Configure One Unreachable AAA Server
    Set Authentication to Remote
    Run Keyword and Expect Error  *  Verify Admin Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Admin Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Local User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console



T3.10.2 Three Configured & Second Reachable AAA Servers & Incorrect Secret & Set Authentication to Remote
    Configure One Unreachable AAA Server
    Configure One AAA Server With Incorrect Secret
    Configure One Unreachable AAA Server
    Set Authentication to Remote
    Run Keyword and Expect Error  *  Verify Admin Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Admin Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Local User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console



T3.11.1 Three Configured & Second Reachable AAA Servers & Correct Secret & Set Authentication to Local then Remote
    Configure One Unreachable AAA Server
    Configure One AAA Server
    Configure One Unreachable AAA Server
    Set Authentication to Local then Remote
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console



T3.11.2 Three Configured & Second Reachable AAA Servers & Incorrect Secret & Set Authentication to Local then Remote
    Configure One Unreachable AAA Server
    Configure One AAA Server With Incorrect Secret
    Configure One Unreachable AAA Server
    Set Authentication to Local then Remote
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console



T3.12.1 Three Configured & Second Reachable AAA Servers & Correct Secret & Set Authentication to Remote then Local
    Configure One Unreachable AAA Server
    Configure One AAA Server
    Configure One Unreachable AAA Server
    Set Authentication to Remote then Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T3.12.2 Three Configured & Second Reachable AAA Servers & Incorrect Secret & Set Authentication to Remote then Local
    Configure One Unreachable AAA Server
    Configure One AAA Server With Incorrect Secret
    Configure One Unreachable AAA Server
    Set Authentication to Remote then Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console



T3.13.1 Three Configured & Third Reachable AAA Servers & Correct Secret & Set Authentication to Local
    Configure One Unreachable AAA Server
    Configure One Unreachable AAA Server
    Configure One AAA Server
    Set Authentication to Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console




T3.13.2 Three Configured & Third Reachable AAA Servers & Incorrect Secret & Set Authentication to Local
    Configure One Unreachable AAA Server
    Configure One Unreachable AAA Server
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console





T3.14.1 Three Configured & Third Reachable AAA Servers & Correct Secret & Set Authentication to Remote
    Configure One Unreachable AAA Server
    Configure One Unreachable AAA Server
    Configure One AAA Server
    Set Authentication to Remote
    Run Keyword and Expect Error  *  Verify Admin Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Admin Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Local User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console




T3.14.2 Three Configured & Third Reachable AAA Servers & Incorrect Secret & Set Authentication to Remote
    Configure One Unreachable AAA Server
    Configure One Unreachable AAA Server
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Remote
    Run Keyword and Expect Error  *  Verify Admin Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Admin Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Local User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console



T3.15.1 Three Configured & Third Reachable AAA Servers & Correct Secret & Set Authentication to Local then Remote
    Configure One Unreachable AAA Server
    Configure One Unreachable AAA Server
    Configure One AAA Server
    Set Authentication to Local then Remote
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console


T3.15.2 Three Configured & Third Reachable AAA Servers & Incorrect Secret & Set Authentication to Local then Remote
    Configure One Unreachable AAA Server
    Configure One Unreachable AAA Server
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Local then Remote
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console



T3.16.1 Three Configured & Third Reachable AAA Servers & Correct Secret & Set Authentication to Remote then Local
    Configure One Unreachable AAA Server
    Configure One Unreachable AAA Server
    Configure One AAA Server
    Set Authentication to Remote then Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Verify Remote User Can Log In via SSH
    Verify Remote User Can Log In via Serial Console



T3.16.2 Three Configured & Third Reachable AAA Servers & Incorrect Secret & Set Authentication to Remote then Local
    Configure One Unreachable AAA Server
    Configure One Unreachable AAA Server
    Configure One AAA Server With Incorrect Secret
    Set Authentication to Remote then Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console

T3.17.1 Three Configured & Unreachable AAA Servers & Set Authentication to Local
    Configure One Unreachable AAA Server
    Configure One Unreachable AAA Server
    Configure One Unreachable AAA Server
    Set Authentication to Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console

T3.17.2 Three Configured & Unreachable AAA Servers & Set Authentication to Remote
    Configure One Unreachable AAA Server
    Configure One Unreachable AAA Server
    Configure One Unreachable AAA Server
    Set Authentication to Remote
    Run Keyword and Expect Error  *  Verify Admin Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Admin Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Local User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console

T3.17.3 Three Configured & Unreachable AAA Servers & Set Authentication to Local then Remote
    Configure One Unreachable AAA Server
    Configure One Unreachable AAA Server
    Configure One Unreachable AAA Server
    Set Authentication to Local then Remote
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console

T3.17.4 Three Configured & Unreachable AAA Servers & Set Authentication to Remote then Local
    Configure One Unreachable AAA Server
    Configure One Unreachable AAA Server
    Configure One Unreachable AAA Server
    Set Authentication to Remote then Local
    Verify Admin Can Log In via SSH
    Verify Admin Can Log In via Serial Console
    Verify Local User Can Log In via SSH
    Verify Local User Can Log In via Serial Console
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via SSH
    Run Keyword and Expect Error  *  Verify Remote User Can Log In via Serial Console

#T4. Misc
T4.1 BSC-4387
    #placeholder
    [Tags]  skipped  BSC-4387
T4.2 Verify that AAA servers use configured timeout
    #placeholder
    [Tags]  skipped
T4.3.1 Verify that Accounting uses round-robin
    #placeholder
    [Tags]  skipped
T4.3.2 Verify that Authorization uses round-robin (if revivew)
    #placeholder
    [Tags]  skipped
T4.4 Verify help texts
    #placeholder
    [Tags]  skipped

* Keywords
Verify Admin Can Log In via SSH
    Cli Run  ${master_name}  show run  reauth=True
    Cli Run  ${slave_name}  show run  reauth=True

Verify Admin Can Log In via Serial Console
    Cli Run  ${master_name}  terminal length 0; show run  console=True
    Cli Run  ${slave_name}  terminal length 0; show run  console=True

Verify Local User Can Log In via SSH
    Cli Run  ${master_name}  show run  user=local  password=local  reauth=True
    Cli Run  ${slave_name}  show run  user=local  password=local  reauth=True

Verify Local User Can Log In via Serial Console
    Cli Run  ${master_name}  terminal length 0; show run  user=local  password=local  console=True
    Cli Run  ${slave_name}  terminal length 0; show run  user=local  password=local  console=True

Verify Remote User Can Log In via SSH
    Cli Run  ${master_name}  show run  user=remote  password=remote  reauth=True
    Cli Run  ${slave_name}  show run  user=remote  password=remote  reauth=True

Verify Remote User Can Log In via Serial Console
    Cli Run  ${master_name}  terminal length 0; show run  user=remote  password=remote  console=True
    Cli Run  ${slave_name}  terminal length 0; show run  user=remote  password=remote  console=True

Verify Recovery Can Log In via SSH
    Cli Run  ${master_name}  free  user=recovery  password=bsn
    Cli Run  ${slave_name}  free  user=recovery  password=bsn

Verify Recovery Can Log In via Serial Console
    Cli Run  ${master_name}  free  user=recovery  password=bsn  console=True
    Cli Run  ${slave_name}  free  user=recovery  password=bsn  console=True

Configure One AAA Server
    ${tmp}=  Get From List  ${servers}  ${server_counter}
    Cli Run  ${master_name}  enable; configure; ${type} server host ${tmp} timeout ${timeout} key ${key}  reauth=True
    Set Test Variable  ${server_counter}  ${server_counter + 1}
Configure Two AAA Servers
    Configure One AAA Server
    Configure One AAA Server
Configure Three AAA Servers
    Configure One AAA Server
    Configure One AAA Server
    Configure One AAA Server
Configure One AAA Server With Incorrect Secret
    ${tmp}=  Get From List  ${servers}  ${server_counter}
    Cli Run  ${master_name}  enable; configure; ${type} server host ${tmp} timeout ${timeout} key foo  reauth=True
    Set Test Variable  ${server_counter}  ${server_counter + 1}
Configure One Unreachable AAA Server
    Cli Run  ${master_name}  enable; configure; ${type} server host 1.1.1.1 timeout ${timeout} key foo  reauth=True
    Set Test Variable  ${server_counter}  ${server_counter + 1}

Configure Local User
    Cli Run  ${master_name}  enable; configure; user local; password local  reauth=True
    Cli Run  ${master_name}  enable; configure; group admin; associate user local  reauth=True

Configure Remote User
    Cli Run  ${master_name}  enable; configure; group admin; associate user remote  reauth=True

Clear User Sessions
    Cli Run  ${master_name}  clear session user remote
    Cli Run  ${master_name}  clear session user local
    Cli Send  ${master_name}  clear session user admin  

Set Authentication to Local
    Cli Run  ${master_name}  enable; configure; aaa authentication login default local; aaa accounting exec default start-stop local  reauth=True
Set Authentication to Remote
    Cli Run  ${master_name}  enable; configure; aaa authentication login default group ${type}; aaa accounting exec default start-stop group ${type}  reauth=True
Set Authentication to Local then Remote
    Cli Run  ${master_name}  enable; configure; aaa authentication login default local group ${type}; aaa accounting exec default start-stop local group ${type}  reauth=True
Set Authentication to Remote then Local
    Cli Run  ${master_name}  enable; configure; aaa authentication login default group ${type} local; aaa accounting exec default start-stop local group ${type}  reauth=True

AAA Suite Setup
    Base Suite Setup
    Set Suite Variable  ${master_name}  c1
    Set Suite Variable  ${slave_name}  c2
    ${status}=  Run Keyword and Return Status  Cli Run  ${master_name}  ena;conf; user aaa_test  reauth=True
    Run Keyword If  '${status}'=='False'
    ...  Set Suite Variable  ${master_name}  c2
    Run Keyword If  '${status}'=='False'
    ...  Set Suite Variable  ${slave_name}  c1
    
    Cli Run  ${master_name}  enable; configure; terminal length 0  reauth=True
    Cli Run  ${master_name}  enable; configure; copy snapshot://firstboot-config running-config  reauth=True
    Configure Local User
    Configure Remote User
    ${tmp}=  Get Environment Variable  AAA_TYPE
    Set Suite Variable  ${type}  ${tmp}
    @{tmp_radius}=  Randomize List  ${radius_servers}
    @{tmp_tacacs}=  Randomize List  ${tacacs_servers}
    Run Keyword If  '${type}'=='RADIUS'
    ...  Set Suite Variable  ${servers}  ${tmp_radius}
    Run Keyword If  '${type}'=='TACACS'
    ...  Set Suite Variable  ${servers}  ${tmp_tacacs}
    Set Suite Variable  ${server_counter}  ${0}
    Set Suite Variable  ${key}  secret
    Set Suite Variable  ${timeout}  1

AAA Test Setup
    Base Test Setup
    #Set Suite Variable  ${master_name}  c1
    #Set Suite Variable  ${slave_name}  c2
    #${tmp}=  BSN Common.Get Node Name  master
    #Set Suite Variable  ${master_name}  ${tmp}
    #${tmp}=  BSN Common.Get Node Name  slave
    #Set Suite Variable  ${slave_name}  ${tmp}
    Cli Run  ${master_name}  enable; configure; copy running-config snapshot://test-config  reauth=True

AAA Test Teardown
    Verify Recovery Can Log In via SSH
    Verify Recovery Can Log In via Serial Console
    Restore Firstboot Config  ${master_name}
    #Run Keyword If  '${status}'=='False'  Clear User Sessions
    Cli Run  ${master_name}  enable; configure; copy snapshot://test-config running-config  reauth=True
    Base Test Teardown


AAA Suite Teardown
    Cli Run  ${master_name}  enable; configure; copy snapshot://firstboot-config running-config  reauth=True
    Base Suite Teardown

