*Settings
Documentation  BigWire Sanity Test	Suite
Suite Setup  bigwire suite setup
Suite Teardown   bigwire suite teardown
Test Setup   base test setup
Test Teardown   base test teardown
Force Tags   HA Scale
Library  keywords/BsnCommon.py
Library  keywords_dev/BsnCommonShow.py
Library  keywords_dev/BsnCommonConfig.py
Library  keywords_dev/BigWireCommon.py

* Variable
${switch1_ip}  10.192.75.225
${switch1_alias}  BW5
${switch2_ip}  10.192.75.226
${switch2_alias}  BW6
${switch3_ip}  10.192.75.227
${switch3_alias}  BW7
${switch4_ip}  10.192.75.228
${switch4_alias}  BW8
${datacenter1}  DC56
${zone1}  Zone1
${datacenter2}  DC78
${zone2}  Zone2
${pseudowire1}   dc56dc78-1
${pseudowire2}   dc56dc78-2
${tenant1}  bw5bw7
${tenant2}  bw6bw8
${switchlight_version}  SwitchLight 1.7-branch


* Test Case
Verify CLI BigWire Summary
	bigwire summary
Verify CLI BigWire Datacenter
	bigwire datacenter
Verify CLI BigWire Tenant
	bigwire tenant
Verify CLI BigWire Pseudowire
	bigwire pseudowire


* Keywords
bigwire suite setup
	${switchDict}=  REST show switch
	
	# Assign Alias to Switch
	${dpid1}=  return switch dpid  ${switchDict}  ${switch1_ip}
	REST set switch alias  ${dpid1}  ${switch1_alias}
	${dpid2}=  return switch dpid  ${switchDict}  ${switch2_ip}
	REST set switch alias  ${dpid2}  ${switch2_alias}
	${dpid3}=  return switch dpid  ${switchDict}  ${switch3_ip}
	REST set switch alias  ${dpid3}  ${switch3_alias}
	${dpid4}=  return switch dpid  ${switchDict}  ${switch4_ip}
	REST set switch alias  ${dpid4}  ${switch4_alias}
	
	# Create Datacenter and assign switch to datacenter
	rest create bigwire datacenter  ${datacenter1}
	rest add switch datacenter  ${datacenter1}  ${dpid1}  ${zone1}
	rest add switch datacenter  ${datacenter1}  ${dpid2}  ${zone2}
	rest create bigwire datacenter  ${datacenter2}
	rest add switch datacenter  ${datacenter2}  ${dpid3}  ${zone1}
	rest add switch datacenter  ${datacenter2}  ${dpid4}  ${zone2}
	
	# Create Pseudowires
	rest create bigwire pseudowire  ${pseudowire1}  ${dpid1}  ethernet7  ${dpid3}  ethernet12
	rest create bigwire pseudowire  ${pseudowire2}  ${dpid2}  ethernet17  ${dpid4}  ethernet15  100
	
	#Create Tenants
	rest create bigwire tenant  ${tenant1}
	rest add switch to tenant  ${tenant1}  ${dpid1}  ethernet22  
	rest add switch to tenant  ${tenant1}  ${dpid3}  ethernet22
	rest create bigwire tenant  ${tenant2}
	rest add switch to tenant  ${tenant2}  ${dpid1}  ethernet28  100
	rest add switch to tenant  ${tenant2}  ${dpid3}  ethernet28  100
	
	sleepnow  30

bigwire summary
	${content}=  REST show bigwire command  summary
	${num-datacenters}=  REST verify dict key  ${content}  0  num-datacenters
	Should Be Equal As Integers  ${num-datacenters}  2
	${num-pseudowires}=  REST verify dict key  ${content}  0  num-pseudowires
	Should Be Equal As Integers  ${num-pseudowires}  2
	${num-tenants}=  REST verify dict key  ${content}  0  num-tenants
	Should Be Equal As Integers  ${num-tenants}  2
	${num-zones}=  REST verify dict key  ${content}   0  num-zones
	Should Be Equal As Integers  ${num-zones}  2
	${state} =  REST verify dict key  ${content}  0  state
	Should Be Equal As Strings  ${state}  OK

bigwire datacenter
    ${content}=  REST show bigwire command  datacenter
    Length Should Be  ${content}  2
    ${dc1}=  REST verify dict key  ${content}  0  name
    Should Be Equal As Strings  ${dc1}  ${datacenter1}
    ${numSwAct} =   REST verify dict key  ${content}  0   num-active-switches
    Should Be Equal As Integers  ${numSwAct}  2
    ${numSwInact} =   REST verify dict key  ${content}  0   num-inactive-switches
    Should Be Equal As Integers  ${numSwInact}  0
    
bigwire tenant
    ${content}=   REST show bigwire command  tenant
    Length Should Be  ${content}  2
    ${name} =   REST verify dict key  ${content}  0   name
    Should Be Equal As Strings  ${name}  ${tenant1}
    ${num-tenant-interface} =   REST verify dict key  ${content}  0   num-tenant-interface
    Should Be Equal As Integers  ${num-tenant-interface}  2
    ${num-tenant-vlan} =   REST verify dict key  ${content}  0   num-tenant-vlan
    Should Be Equal As Integers  ${num-tenant-vlan}  1
   
bigwire pseudowire
    ${content}=   REST show bigwire command  pseudowire
    ${num-active-wires} =   REST verify dict key  ${content}  0   num-active-wires
    Should Be Equal As Integers  ${num-active-wires}  2
    ${num-inactive-wires} =   REST verify dict key  ${content}  0   num-inactive-wires
    Should Be Equal As Integers  ${num-inactive-wires}  0
    ${name} =   REST verify dict key  ${content[0]['pseudowire-wire']}  0   name
    Should Be Equal As Strings  ${name}  ${pseudowire1}
    ${interface1} =   REST verify dict key  ${content[0]['pseudowire-wire']}  0   interface1
    Should Be Equal As Strings  ${interface1}  ethernet7
    ${interface2} =   REST verify dict key  ${content[0]['pseudowire-wire']}  0   interface2
    Should Be Equal As Strings  ${interface2}  ethernet12
    ${state} =   REST verify dict key  ${content[0]['pseudowire-wire']}  0   state
    Should Be Equal As Strings  ${state}  up
    ${vlan} =   REST verify dict key  ${content[0]['pseudowire-wire']}  0   vlan
    Should Be Equal As Integers  ${vlan}  -1
  
bigwire suite teardown
	rest_delete_tenant  ${tenant1}
	rest_delete_tenant  ${tenant2}
	rest_delete_pseudowire  ${pseudowire1}
	rest_delete_pseudowire  ${pseudowire2}
	rest_delete_datacenter  ${datacenter1}
	rest_delete_datacenter  ${datacenter2}
	sleepnow  30
	