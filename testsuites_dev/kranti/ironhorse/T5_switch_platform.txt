* Settings
Documentation     T5  Switch Platform Test suite- Iron Horse
#Suite Setup      T5 switch platform test setup
#Suite Teardown   T5 switch platform test teardown
Test Setup        base test setup
#Test Teardown    atest teardown
Force Tags        T5  switch  Platform 
...             
...            
...                        
Library         keywords/BsnCommon.py
Library         keywords/SwitchLight.py
Library         keywords/AppController.py
Library         keywords/Ixia.py 
Library         keywords/T5.py     
Library         String
Resource        keywords_dev/kranti/ironhorse/snake_traffic_test_variables.txt

*Variables
${switchlight_version}  SwitchLight
${netmask}  18
${gateway}  10.192.64.1
${dns_server}  10.192.3.1
${dns_domain}  bigswitch.com
${j}    1
${switch1_name}=  spine01
${switch2_name}=  leaf01
${switch3_name}=  leaf02
${tenant}=        testTenant 
${vns}=           v1
${vlan}=          -1
${intf_1}=        ethernet1
${intf_2}=        ethernet2
${intf_3}=        ethernet3
${intf_4}=        ethernet4

${intf_6}=        ethernet45
${intf_7}=        ethernet46
${intf_8}=        ethernet47
${intf_9}=        ethernet48

${count}=         1 
${ratetolerance}=     10
${tolerance}=         5
${sleepAfter}=    10
${sleepBefore}=   5


### Section A: ONIE, OFAUX Channel  

*Test Case

Config the switch and controller 
    Log    Step 1 - Configure the base set up according to topology
    T5 switch platform test setup
    [Tags]  T5  switch  setup   

Verify ONIE Installed on Switch
	Log     Step 1 - verify ONIE installed in switch
	verify onie installated on switch  s1
	verify onie installated on switch  s2
	verify onie installated on switch  s3
	[Tags]  T5  switch  install  onie  tc1  jira-pan-772  
            
Verify the openflow aux channel count
	Log    Step 1 - Get the OF aux channel number
	verify openflow aux channel  s1  c1  
	verify openflow aux channel  s2  c1  
	verify openflow aux channel  s3  c1  
    [Tags]  T5  switch  ofaux      
    
Verify ONIE installed switch gets switchLite installer
    Log     Step 1 - Verify ONIE gets switchLite installer image
    Log     Step 2 - Verify that after the installer you get loader prompt
    [Tags]  T5  switch  install  
    [Tags]  Manual
    Manual passed

Verify switchLight Installer upgrades another switchLite image
    Log     Step 1 - Verify switchLight Installer can upgrade to another swithcLigh image
    [Tags]  T5  switch  install 
    [Tags]  Manual
    Manual passed
    
Verify console connectivity
    Log    Step 1 - Verify access the console through telnet
    [Tags]  T5  switch  install
    [Tags]  Manual
    Manual passed

Verify UBoot version DRAM etc
    Log    Step 1 - Verify the Uboot version
    Log    Step 2 - Verify the DRAM
    [Tags]  T5  switch  install 
    [Tags]  Manual-untested
    Manual untested

Configure Static ip address, gateway, server ip
    Log    Step 1 - Verify the configuration of static Ip address
    Log    Step 2 - Verify the configuration of Gateway 
    Log    Step 3 - Verify the configuration of server ip    
    [Tags]  T5  switch  install 
    [Tags]  Manual
    Manual passed

Reboot Switch and verify the loader parameters like IP, gateway etc
    Log    Step 1 - Verify after reboot configuration of static Ip address
    Log    Step 2 - Verify after reboot configuration of Gateway 
    Log    Step 3 - Verify after reboot the configuration of server ip    
    [Tags]  T5  switch  install 
    [Tags]  Manual
    Manual passed

Verify after loader env configuration Ping to Switch 
    Log    Step 1 - Verify after loader env config , Ping to Switch   
    [Tags]  T5  switch  install 
    [Tags]  Manual
    Manual passed

Verify DHCP address configuration, IP address allocation and PING
    Log    Step 1 - Verify DHCP server configuration at loader
    Log    Step 2 - Verify the IP address allocation 
    Log    Step 3 - Verify the PING 
    [Tags]  T5  switch  install 
    [Tags]  Manual-untested
    Manual untested 
    
Reboot box and Verify the IP address through DHCP server and Ping 
    Log    Step 1 - Verify after reboot IP address allocation thru DHCP 
    Log    Step 1 - Verify the PING connectivity 
    [Tags]  T5  switch  install 
    [Tags]  Manual-untested
    Manual untested 
   
Verify environmental variables for CPU, RAM, PCI, Ethernet, EEPROM at loader 
    Log    Step 1 - Verify the environmrntal variables 
    [Tags]  T5  switch  install 
    [Tags]  Manual-untested
    Manual untested
        
Verify image installation using USB 
    Log    Step 1 - Verify that the USB image installation is supported 
    [Tags]  T5  switch  install 
    [Tags]  Manual-untested
    Manual untested 
    
Verify the recovery procedure of Switch 
    Log    Step 1 - verify that the Switch can be recovered by the defined procedure 
    [Tags]  T5  switch  install 
    [Tags]  Manual-untested
    Manual untested 
    
Verify Customer Deployment method
    Log    Step 1 - Verify the package/installation procedure for Switch
    [Tags]  T5  platform  install 
    [Tags]  Manual-untested
    Manual untested
    

    
### SECTION B: Initial Configuration 

Verify one openflow controller can be configured on Spine
    delete existing controllers  s1  c1
    delete existing controllers  s1  c2
    add openflow controller  s1  c1
    verify openflow controller  s1  c1
    [Tags]  t5  platform  InitialConfig  

Verify controller can be modified 
    delete existing controllers  s1  c1
    delete existing controllers  s1  c2
    add openflow controller  s1  c1
    verify openflow controller  s1  c1
    delete existing controllers  s1  c1
    add openflow controller  s1  c2
    verify openflow controller  s1  c2
    [Tags]  t5  platform  InitialConfig  

Verify multiple openflow controllers can be configured
    delete existing controllers  s1  c1
    delete existing controllers  s1  c2
    add openflow controller  s1  c1
    verify openflow controller  s1  c1
    add openflow controller  s1  c2
    verify openflow controller  s1  c2    
    [Tags]  t5  platform  InitialConfig  

Verify Controller IP address is pingable
    ping remote  s1
    [Tags]  t5  platform  InitialConfig  

Configure DNS server and DNS Domain. Verify you can ping www.bigswitch.com
    configure dns domain  s1  ${dns_server}  ${dns_domain}
    Sleep  30
    cli ping from switch  s1  bigswitch.com
    [Tags]  t5  platform  InitialConfig      

Verify all interfaces show up (in show o/p from CLI)
    verify interfaces  s1
    [Tags]  t5  platform  InitialConfig      
       
Verify ma1 ip address configuration via static config
    delete static ip  s1  ${netmask}  ${gateway}
    delete dns  s1  ${dns_server}  ${dns_domain}  
    Sleep  5
    add static ip  s1  ${netmask}  ${gateway}
    add dns  s1  ${dns_server}  ${dns_domain}
    Sleep  60
    verify ip dns  s1  ${netmask}  ${gateway}  ${dns_server}  ${dns_domain}
    [Tags]  t5  platform  InitialConfig       

Verify ntp
    configure ntp server  s1  time-c.nist.gov
    Sleep  5
    verify ntp server  s1  time-c.nist.gov
    delete ntp  s1  time-c.nist.gov
    [Tags]  t5  platform  InitialConfig     

Verify ntp server after process ntp restart
    configure ntp server  s1  time-c.nist.gov
    Sleep  5
    verify ntp server  s1  time-c.nist.gov
    bash restart process  s1  ntpd
    Sleep  5
    verify ntp server  s1  time-c.nist.gov    
    [Tags]  t5  platform  InitialConfig
    

Verify the Switch configuration after ZTP 
    Log    Step 1 - Verify the Switch Configuration after ZTP
    [Tags]  T5  switch  InitialConfig 
    [Tags]  Manual-untested
    Manual untested 
    
Verify Switch connectivity after ZTP 
    Log    Step 1 - Verify Switch is pingable
    [Tags]  T5  switch  InitialConfig  
    [Tags]  Manual-untested
    Manual untested 
    
Verify Switch Configuration - Allowed or Not Allowed Configuration 
    Log    Step 1 - Verify the What Switch Configuration are allowwed Not Allowed
    [Tags]  T5  switch  InitialConfig  
    [Tags]  Manual-untested
    Manual untested 
    
Verify Switch DHCP address - Is it Configurable in ZTP
    [Tags]  T5  switch  InitialConfig  
    [Tags]  Manual-untested
    Manual untested 
    
Verify invalid out of Subnet address configurable 
    Log    Step 1 - Verify the invalid/out of subnet IP address configurable? 
    Log    Step 2 - Any provision for deletion?
    [Tags]  T5  switch  InitialConfig     
    [Tags]  Manual-untested
    Manual untested 
    
Verify auto-negotiation for Management Port 
    Log    Step 1 - Verify auto-neg behavior for managament port
    [Tags]  T5  switch  InitialConfig 
    [Tags]  Manual-untested
    Manual untested 
    
Verify Speed Duplex settings of Management Port 
    Log    Step 1 - Verify Speed/Duplex settings of Management Port
    [Tags]  T5  switch  InitialConfig 
    [Tags]  Manual-untested
    Manual untested 
    
Verify management port comes up after removing and reinserting cable 
    Log    Step 1 - Verify the Management Port config after cable remove and re-insertion
    [Tags]  T5  switch  InitialConfig
    [Tags]  Manual-untested
    Manual untested
    
Verify multiple SSH connections to Management Port 
    Log    Step 1 - Verify multiple SSH connections to Management Port
    [Tags]  T5  switch  InitialConfig
    [Tags]  Manual-untested
    Manual untested
    
Verify multiple telnet connections to Management Port 
    Log    Step 1 - Verify multiple telnet connections to Management Port
    [Tags]  T5  switch  InitialConfig
    [Tags]  Manual-untested
    Manual untested

Verify controller configuration on Switch 
    Log    Step 1 - Verify Master/ BAckup controller information on switch
    [Tags]  T5  switch  InitialConfig 
    [Tags]  Manual
    Manual Passed
    
Verify after failure of Master Controller switch connection with backup is re established
    Log    Step 1 - Both Controller connection is present 
    Log    Step 2 - Master Controller fails and connection is removed 
    Log    Step 3 - Connection to Back up controller is established
    [Tags]  T5  switch  InitialConfig  HA 
    [Tags]  Manual-untested
    Manual untested
    
Verify after Master Controller comes back Connection reestablished 
    Log    Step 1 - Verify connection re-establishes after Master Controller connection comes back 
    Log    Step 2 - Verify the correct information for Master/Backup Controller
    [Tags]  T5  switch  InitialConfig  HA 
    [Tags]  Manual-untested
    Manual untested

    
### Section C : Admin/User Authentication 
### Allowed/Required From Controller Only ??

Verify user admin can be configured with password adminadmin on the box 
    Log    Step 1 - Verify user admin can be configured with password adminadmin on the box
    [Tags]  T5  switch  UserConfig
    [Tags]  Manual-untested
    Manual untested
    
Verify password for user admin can be changed  
    Log    Step 1 - Verify password for user admin can be changed
    [Tags]  T5  switch  UserConfig 
    [Tags]  Manual-untested
    Manual untested

Verify password for user admin cannot be of zero length   
    Log    Step 1 - Verify password for user admin cannot be of zero length
    [Tags]  T5  switch  UserConfig  
    [Tags]  Manual-untested
    Manual untested
        
Verify Passwords are case sensitive   
    Log    Step 1 - Verify Passwords are case-sensitive  
    Manual untested

Verify max length for passwords    
    Log    Step 1 - Verify max-length for passwords
    [Tags]  T5  switch  UserConfig   
    [Tags]  Manual-untested
    Manual untested

Verify special characters are allowed in passwords 
    Log    Step 1 - Verify special characters are allowed in passwords
    [Tags]  T5  switch  UserConfig   
    [Tags]  Manual-untested
    Manual untested
    
Verify user recovery can be configured and user can login using the username password combination
    Log    Step 1 - Verify user recovery can be configured and user can login using the username/password combination
    [Tags]  T5  switch  UserConfig   
    [Tags]  Manual-untested
    Manual untested

Verify other users except admin or recovery not allowed   
    Log    Step 1 - Verify other users except admin or recovery not allowed
    Log    Step 2 - Verify proper error message is displayed
    [Tags]  T5  switch  UserConfig  
    [Tags]  Manual-untested
    Manual untested

Restart process ofad and verify users admin and recovery can re login
    Log    Step 1 - Restart process ofad and verify users admin and recovery can re-login
    [Tags]  T5  switch  UserConfig   
    [Tags]  Manual-untested
    Manual untested
    
    
### Section D: System Admin Operation
### What is allowed from Controller and What is allowed from Switch??

Verify NTP Config / Sync
    Log    Step 1 - Verify NTP Config / Sync
    [Tags]  T5  switch  SysAdminOperation
    [Tags]  Manual-untested
    Manual untested
    
Config admin save/reload operation 
    Log    Step 1 - Config admin save/reload operation
    [Tags]  T5  switch  SysAdminOperation 
    [Tags]  Manual-untested
    Manual untested
    
Config upload/ ftp / reload operation 
    Log    Step 1 - Config upload/ ftp / reload operation
    [Tags]  T5  switch  SysAdminOperation 
    [Tags]  Manual-untested
    Manual untested
    
Config upload/ scp / reload operation 
    Log    Step 1 - Config upload/ scp / reload operation
    [Tags]  T5  switch  SysAdminOperation 
    [Tags]  Manual-untested
    Manual untested
    
Config DNS server config and operational output 
    Log    Step 1 - Config DNS server config and operational output
    [Tags]  T5  switch  SysAdminOperation 
    [Tags]  Manual-untested
    Manual untested
    
Verify time Zone configuration 
    Log    Step 1 - Verify time Zone configuration
    [Tags]  T5  switch  SysAdminOperation 
    [Tags]  Manual-untested
    Manual untested
    
Verify Syslog Server config - logs creation/ rollover / after reboot verification
    Log    Step 1 - Verify Syslog Server config - logs creation/ rollover / after reboot verification
    [Tags]  T5  switch  SysAdminOperation
    [Tags]  Manual-untested
    Manual untested
    
Verify SNMP server configuration  
    Log    Step 1 -  Verify SNMP server configuration
    [Tags]  T5  switch  SysAdminOperation 
    [Tags]  Manual-untested
    Manual untested
    
Verify System Admin config - reboot and persistent  
    Log    Step 1 -  Verify System Admin config - reboot and persistent
    [Tags]  T5  switch  SysAdminOperation 
    [Tags]  Manual-untested
    Manual untested
    
###
### Section E: SNMP Interface MIBs   
###
###    
 
 

    
Verifying snmpget works fine 
    Log    Step 1 -Verifying snmpget works fine
    [Tags]  T5  switch  SNMP 
    [Tags]  Manual-untested
    Manual untested
    
Verifying snmpbulkget works fine
    Log    Step 1 -Verifying snmpbulkget works fine
    [Tags]  T5  switch  SNMP
    [Tags]  Manual-untested
    Manual untested
    
Verify display of pertinent parameters through SNMP matches information on switch 
    Log    Step 1 -Verify display of pertinent parameters through SNMP matches information on switch
    [Tags]  T5  switch  SNMP
    [Tags]  Manual-untested
    Manual untested
    
Verify on deletion re-addition information is still correct 
    Log    Step 1 -Verify on deletion/re-addition information is still correct
    [Tags]  T5  switch  SNMP
    [Tags]  Manual-untested
    Manual untested
    
Do SNMP V2 queries 
    Log    Step 1 - Do SNMP V2 queries
    [Tags]  T5  switch  SNMP
    [Tags]  Manual-untested
    Manual untested
    
Verifying snmpget after SNMP process restart
    Log    Step 1 - Verifying snmpget after SNMP process restart
    [Tags]  T5  switch  SNMP
    [Tags]  Manual-untested
    Manual untested
    
Verifying snmpget after switch restart
    Log    Step 1 -Verifying snmpget after switch restart
    [Tags]  T5  switch  SNMP
    [Tags]  Manual-untested
    Manual untested

Verifying snmpget after image upgrade
    Log    Step 1 -Verifying snmpget after image upgrade
    [Tags]  T5  switch  SNMP
    [Tags]  Manual-untested
    Manual untested

Verifying snmpget after reloading configuration from file 
    Log    Step 1 -Verifying snmpget after reloading configuration from file
    [Tags]  T5  switch  SNMP 
    [Tags]  Manual-untested
    Manual untested

Verifying stress the agent with multiple simultaneous walks on the switch of the entire MIB tree 
    Log    Step 1 - Verifying stress the agent with multiple simultaneous walks on the switch of the entire MIB tree
    [Tags]  T5  switch  SNMP 
    [Tags]  Manual-untested
    Manual untested

Verify UP DOWN events are logged reported 
    Log    Step 1 - Verify UP DOWN events are logged reported 
    [Tags]  Manual-untested
    Manual untested

Verify interface index interface description is in range 1-48
    Log    Step 1 - Verify  interface index interface description is in range 1-48
    [Tags]  T5  switch  SNMP
    [Tags]  Manual-untested
    Manual untested

Verify ifAdminStatus shows as Port is Enabled
    Log    Step 1 - Verify  ifAdminStatus shows as Port is Enabled
    [Tags]  T5  switch  SNMP
    [Tags]  Manual-untested
    Manual untested

Verify ifInOctets Compare result with show interface command ifconfig
    Log    Step 1 - Verify ifInOctets Compare result with show interface command ifconfig
    [Tags]  T5  switch  SNMP  
    [Tags]  Manual-untested
    Manual untested

Verify ifInDiscards Compare result with show interface command ifconfig
    Log    Step 1 - Verify ifInDiscards Compare result with show interface command ifconfig
    [Tags]  T5  switch  SNMP 
    [Tags]  Manual-untested
    Manual untested

Verify ifInErrors Compare result with show interface command ifconfig
    Log    Step 1 - Verify ifInErrors Compare result with show interface command/ifconfig
    [Tags]  T5  switch  SNMP 
    [Tags]  Manual-untested
    Manual untested

Verify ifOutOctets Compare result with show interface command ifconfig
    Log    Step 1 - Verify ifOutOctets Compare result with show interface command ifconfig
    [Tags]  T5  switch  SNMP 
    [Tags]  Manual-untested
    Manual untested

Verify ifOutDiscards Compare result with show interface command ifconfig
    Log    Step 1 - Verify  ifOutDiscards Compare result with show interface command ifconfig
    [Tags]  T5  switch  SNMP
    [Tags]  Manual-untested
    Manual untested

Verify ifOutErrors Compare result with show interface command ifconfig
    Log    Step 1 - Verify ifOutErrors Compare result with show interface command ifconfig
    [Tags]  T5  switch  SNMP 
    [Tags]  Manual-untested
    Manual untested

Verify ifOutQLen Compare result with show interface command ifconfig
    Log    Step 1 - Verify ifOutQLen Compare result with show interface command ifconfig
    [Tags]  T5  switch  SNMP 
    [Tags]  Manual-untested
    Manual untested

Verify ifSpeed Compare result with show interface command ifconfig
    Log    Step 1 - Verify ifSpeed Compare result with show interface command ifconfig
    [Tags]  T5  switch  SNMP 
    [Tags]  Manual-untested
    Manual untested


### Section F:Switch Platform Environment Variables 
###
###

Verify the environment information is displayed
    Log    Step 1 - Verify the environment information is displayed
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed

Verify Power Supply Status
    Log    Step 1 - Verify Power Supply Status
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed

Verify Temperatures are in the appropriate ranges
    Log    Step 1 - Verify Temperatures are in the appropriate ranges
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed

Verify Fans are running at normal speeds
    Log    Step 1 - Verify Fans are running at normal speeds
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed

Verify fans are running at higher speeds when temperature increases
    Log    Step 1 - Verify fans are running at higher speeds when temperature increases
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed

Verify alarms are enerated in syslog in case of fan failure
    Log    Step 1 - Verify alarms are generated in syslog in case of fan failure
    [Tags]  T5  switch  Environment 
    [Tags]  Manual  jira-pan-667
    Manual Failed

Verify time and date information is NOT lost after reboot
    Log    Step 1 - Verify time and date information is NOT lost after reboot
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed

Verify Periodic polling of Temp sensor fans
    Log    Step 1 - Verify Periodic polling of Temp sensor fans
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed

Verify if fan speed/status is updated in output of show sensors
    Log    Step 1 - Verify if fan speed/status is updated in output of show sensors
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed

Verify if temperature values and sensor status are updated in output of show sensors
    Log    Step 1 - Verify if temperature values and sensor status are updated in output of show sensors
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed

PSU failure test - Bring up , Failure back up PSU AC ,alarm , messages
    Log    Step 1 - PSU failure test - Bring up , Failure back up PSU ,alarm , messages
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed
    
Verify power output when DUT use one AC power supply
    Log    Step 1 - Verify power output when DUT use one power supply
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed    

Verify power output when DUT use two AC power supplies
    Log    Step 1 - Verify power output when DUT use two power supplies
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed    

With both AC power supplies and system up and running, remove one power supply and verify
    Log    Step 1 - With both power supplies and system up and running, remove one power supply and verify
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed    


Repeat previous testcase with the other AC power supply
    Log    Step 1 - Repeat previous testcase with the other power supply
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed    

With one AC power supply and system up and running, add second power supply and verify
    Log    Step 1 - With one power supply and system up and running, add second power supply and verify
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed    

VErify with PSU2 with the other AC power supply
    Log    Step 1 - Repeat previous testcase with the other power supply
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed    

Verify power output when DUT use one DC power supply
    Log    Step 1 - Verify power output when DUT use one power supply
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed    

Verify power output when DUT use two DC power supplies
    Log    Step 1 - Verify power output when DUT use two power supplies
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed    

With both DC power supplies and system up and running, remove one power supply and verify
    Log    Step 1 - With both power supplies and system up and running, remove one power supply and verify
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed    

Repeat previous testcase with the other DC power supply
    Log    Step 1 - Repeat previous testcase with the other power supply
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed    

With one DC power supply and system up and running, add second power supply and verify
    Log    Step 1 - With one power supply and system up and running, add second power supply and verify
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed    

Verify with PSU2 with the other DC power supply
    Log    Step 1 - Repeat previous testcase with the other power supply
    [Tags]  T5  switch  Environment
    [Tags]  Manual  jira-pan-667
    Manual Failed
   
### Section G: LED Test 
###
###
Verify LED behavior during and after boot up 
    Log    Step 1 - Verify the LED behavior during and after boot up 
    [Tags]  T5  switch  LED  
    [Tags]  Manual  jira-pan-675
    Manual Failed    

Verify LED behavior when link is up down disable 
    Log    Step 1 - Verify the LED behavior when link is up 
    Log    Step 1 - Verify the LED behavior when link is down
    Log    Step 1 - Verify the LED behavior when link is admin disable 
    [Tags]  T5  switch  LED  
    [Tags]  Manual  jira-pan-675
    Manual Failed

Verify Activity LED and Status LED for a MGMT Port and data ports when no cable is connected
    Log    Step 1 - Verify Activity LED and Status LED for a MGMT Port and data ports when no cable is connected
    [Tags]  T5  switch  LED
    [Tags]  Manual  jira-pan-675
    Manual Failed   

Verify Activity LED and Status LED for a MGMT Port and data ports when port is connected to TG
    Log    Step 1 - Verify Activity LED and Status LED for a MGMT Port and data ports when port is connected to TG
    [Tags]  T5  switch  LED
    [Tags]  Manual  jira-pan-675
    Manual Failed    

Verify Activity LED and Status LED for a MGMT Port and data ports when cable is disconnected from the other end
    Log    Step 1 - Verify Activity LED and Status LED for a MGMT Port and data ports when cable is disconnected from the other end
    [Tags]  T5  switch  LED
    [Tags]  Manual  jira-pan-675
    Manual Failed    

Verify that all the all network LEDs goes off when systems is halted
    Log    Step 1 - Verify that all the all network LEDs goes off when systems is halted
    [Tags]  T5  switch  LED
    [Tags]  Manual  jira-pan-675
    Manual Failed    

###
### Section H: CLI Configuration and Show commands 
### Confirm the CLI from Controller only 
###
 

Verify Admin Operation command
    Log    Step 1 - Verify Admin Operation command
    [Tags]  Manual-untested
    Manual untested
    
Verify Show version, env, interface, alarms, running-config , etc
    Log    Step 1 - Verify Show version, env, interface, alarms, running-config , etc
    [Tags]  Manual  jira-pan-667
     Manual Failed
    
Verify Admin enable/ disable interface 
    Log    Step 1 - Verify Admin enable/ disable interface 
    [Tags]  Manual  jira-pan-667
     Manual Failed
    
Verify Admin save partial save config allowed config load reload merge override
    Log    Step 1 - Verify Admin save partial save config allowed config load reload merge  override
    [Tags]  Manual-untested
    Manual untested
    
Verify Config commit error flag invalid config missing config part check 
    Log    Step 1 - Verify Config commit error flag invalid config missing config part check 
    [Tags]  Manual-untested
    Manual untested
    
Verify CLI reboot command option - Config persistent after save
    Log    Step 1 - Verify CLI reboot command option - Config persistent after save
    [Tags]  Manual-untested
    Manual untested
    

###
### Section I : Traffic Test Verification
###
###

Uni-Directional L2 Traffic flow=a->b traffic framerate 10000 pktsize 64 
    ${stream}=     L2 add  flow=a->b  src_mac=00:11:23:00:00:09  dst_mac=00:11:23:00:00:99  frame_rate=10000  frame_size=64  ethertype=8000  name=a_b_flow
    start traffic  ${stream}
    sleep          5
    stop traffic   ${stream}
    sleep          5
    clear stats
    start traffic  ${stream}
    sleep          10
    ${report}=     fetch port stats
    verify results traffic  transmitted_frame_rate  received_valid_frame_rate  ${ratetolerance}
    stop traffic   ${stream}
    #sleep          10
    #${report}=     fetch port stats
    #verify results traffic  transmitted_frames  received_valid_frames  ${tolerance}        
    [Tags]  T5  switch  traffic  tc2 

Uni-Directional L2 Traffic flow=a->b traffic linerate 10% pktsize 64
    ${stream}=     L2 add  flow=a->b  src_mac=00:11:23:00:00:09  dst_mac=00:11:23:00:00:99  line_rate=10  frame_size=64  ethertype=8000  name=a_b_flow
    start traffic  ${stream}
    sleep          5
    stop traffic   ${stream}
    sleep          5
    clear stats
    start traffic  ${stream}
    sleep          10
    ${report}=     fetch port stats
    verify results traffic  transmitted_frame_rate  received_valid_frame_rate  ${ratetolerance}  
    stop traffic   ${stream}
    #sleep          10
    #${report}=     fetch port stats
    #verify results traffic  transmitted_frames  received_valid_frames  ${tolerance}    
    [Tags]  T5  switch  traffic  tc2       

Verify all interfaces show up after sw installation 
    Log    Step 1 - Verify all interfaces show up after sw installation
    [Tags]  Manual-untested
    Manual untested

Verify that the various transceivers are detected in the uplink module and they are up and running 
    Log    Step 1 - Verify that the various transceivers are detected in the uplink module and they are up and running
    [Tags]  Manual-untested
    Manual untested

Verify interface op is consistent and as per spec in show interfaces op 
    Log    Step 1 - Verify interface op is consistent and as per spec in show interfaces op
    [Tags]  Manual-untested
    Manual untested

Verify line-rate traffic 
    Log    Step 1 - Verify line-rate traffic
    [Tags]  Manual-untested
    Manual untested

Verify end-to-end ping system-test 
    Log    Step 1 - Verify end-to-end ping system-test
    [Tags]  Manual-untested
    Manual untested

Verify auto-negotiation configurations work as expected 
    Log    Step 1 - Verify auto-negotiation configurations work as expected
    [Tags]  Manual-untested
    Manual untested

Verify Auto- negotiation enabled on both ends of interface
    Log    Step 1 - Verify Auto- negotiation enabled on both ends of interface
    [Tags]  Manual-untested
    Manual untested

Verify Speed/Duplex in ports 
    Log    Step 1 - Verify Speed/Duplex in ports
    [Tags]  Manual-untested
    Manual untested

Verify interface state is reported correctly when cable is unplugged. 
    Log    Step 1 - Verify interface state is reported correctly when cable is unplugged. 
    [Tags]  Manual-untested
    Manual untested

Verify that the options are maintained on the interface after the system reboot. 
    Log    Step 1 - Verify that the options are maintained on the interface after the system reboot.
    [Tags]  Manual-untested
    Manual untested

Verify that the appropriate counters are incremented when the interface receivers error oversized undersized packets
    Log    Step 1 - Verify that the appropriate counters are incremented when the interface receivers error oversized undersized packets
    [Tags]  Manual-untested
    Manual untested
    
Verify Sending L2 traffic with frame size 64 bytes
    Log    Step 1 - Verify Sending L2 traffic with frame size 64 bytes
    [Tags]  Manual-untested
    Manual untested

Verify Sending L2 traffic with frame size 128 bytes 
    Log    Step 1 - Verify Sending L2 traffic with frame size 128 bytes
    [Tags]  Manual-untested
    Manual untested

Verify Sending L2 traffic with frame size 512 bytes 
    Log    Step 1 - Verify Sending L2 traffic with frame size 512 bytes
    [Tags]  Manual-untested
    Manual untested

Verify Sending L2 traffic with frame size 1024 bytes 
    Log    Step 1 - Verify Sending L2 traffic with frame size 1024 bytes
    [Tags]  Manual-untested
    Manual untested

Verify Sending L2 traffic with frame size Jumbo 9150 bytes 
    Log    Step 1 - Verify Sending L2 traffic with frame size Jumbo 9150 bytes
    [Tags]  Manual-untested
    Manual untested

Verify Sending L2 traffic with mix and incremental from 64 to 9150 bytes 
    Log    Step 1 - Verify Sending L2 traffic with frame size mix and incremental from 64 to 9150 bytes
    [Tags]  Manual-untested
    Manual untested

Verify - Jumbo frame disabled - Sending L2 traffic with Jumbo frame size 9150 bytes 
    Log    Step 1 - Verify - Jumbo frame disabled - Sending L2 traffic with Jumbo frame size 9150 bytes 
    [Tags]  Manual-untested
    Manual untested

Test the Oversubscription of 40Gig Links between Leaf and Spines
    Log   Step 1 - Test the  Oversubscription of 40Gig Links between Leaf and Spines
    [Tags]  Manual-untested
    Manual untested
    
Test the hashing algorithm between the leaf and spine with multiple links
    Log    Step 1 - Test the hashing algorithm between the leaf and spine with multiple links
    [Tags]  Manual-untested
    Manual untested


* Keywords
      
T5 switch platform test setup
   base test setup
   rest add switch  ${switch1_name}
   ${swDpid1}=  rest return switch dpid from ip  s1
   rest add dpid  ${switch1_name}   ${swDpid1}
   rest add fabric role  ${switch1_name}  spine
      
   rest add switch  ${switch2_name}
   ${swDpid2}=  rest return switch dpid from ip  s2
   rest add dpid  ${switch2_name}   ${swDpid2}
   rest add fabric role  ${switch2_name}  leaf
   
   rest add switch  ${switch3_name}
   ${swDpid3}=  rest return switch dpid from ip  s3
   rest add dpid  ${switch3_name}   ${swDpid3}
   rest add fabric role  ${switch3_name}  leaf
      
   rest add tenant  ${tenant}
   rest add vns  ${tenant}  ${vns}
   
   rest add interface to vns  ${tenant}  ${vns}  ${switch2_name}  ${intf_1}  ${vlan} 
   rest add interface to vns  ${tenant}  ${vns}  ${switch2_name}  ${intf_2}  ${vlan}
   rest add interface to vns  ${tenant}  ${vns}  ${switch2_name}  ${intf_3}  ${vlan}
   rest add interface to vns  ${tenant}  ${vns}  ${switch2_name}  ${intf_4}  ${vlan}
   
   
   rest add interface to vns  ${tenant}  ${vns}  ${switch3_name}  ${intf_6}  ${vlan} 
   rest add interface to vns  ${tenant}  ${vns}  ${switch3_name}  ${intf_7}  ${vlan}
   rest add interface to vns  ${tenant}  ${vns}  ${switch3_name}  ${intf_8}  ${vlan}
   rest add interface to vns  ${tenant}  ${vns}  ${switch3_name}  ${intf_9}  ${vlan}
   
                
T5 switch platform test teardown
   rest delete tenant  ${tenant}  
   rest delete fabric switch  ${switch1_name} 
   rest delete fabric switch  ${switch2_name}
   rest delete fabric switch  ${switch3_name}
   base test teardown
   sleep  5   

atest teardown
    delete traffic



verify results traffic   [Arguments]  ${transmitted_frame_rate}  ${received_valid_frame_rate}  ${tolerance}
    Sleep  5
    ${report}=  fetch port stats
    ${tx_value}=  verify dict key  ${report}  a  ${transmitted_frame_rate}
    ${rx_value}=  verify dict key  ${report}  b  ${received_valid_frame_rate}
    ${in_range}=  ixia verify traffic rate  ${tx_value}  ${rx_value}  ${tolerance} 
    Should be true  ${in_range} 

verify results totalframes   [Arguments]  ${transmitted_frames}  ${received_valid_frames}
    Sleep  5
    ${report}=  fetch port stats
    ${tx_value}=  verify dict key  ${report}  a  ${transmitted_frames}
    ${rx_value}=  verify dict key  ${report}  b  ${received_valid_frames}
    ${in_range}=  ixia verify traffic rate  ${tx_value}  ${rx_value}
    Should be true  ${in_range} 


verify openflow aux channel  [Arguments]  ${switch}  ${cntrlr} 
	${ofAux}=  cli return ofaux channel count  ${switch}  ${cntrlr} 
	Should contain  ${ofAux}  3     

verify onie installated on switch  [Arguments]  ${switch}    
#    ${result1}=  bash execute command  ${switch}  cat /proc/mtd
	${result1}=  bash  s1  cat /proc/mtd  
    Should contain  ${result1['content']}  onie 
    

add interface to vns snake config   [Arguments]  ${tenant}  ${count}
    ${range}=  Evaluate  ${count} + 1
    : FOR  ${i}  IN RANGE  1  ${range}
    \  Log  ${i} 
    \  Log  ${j}
    \  ${vns_name}=  Evaluate  str('v') + str(${i})
    \  ${intf_name_1}=  Evaluate  str('ethernet') + str(${j})
    \  ${k}=  Evaluate  ${j} + 1
    \  ${intf_name_2}=  Evaluate  str('ethernet') + str(${k})          
    \  rest add interface to vns  ${tenant}  ${vns_name}  ${switch_alias}  ${intf_name_1}  -1
    \  rest add interface to vns  ${tenant}  ${vns_name}  ${switch_alias}  ${intf_name_2}  -1
    \  ${j}=  Evaluate  ${j} + 2
        
delete interface from vns snake config   [Arguments]  ${tenant}  ${count}
    ${range}=  Evaluate  ${count} + 1
    : FOR  ${i}  IN RANGE  1  ${range}
    \  Log  ${i} 
    \  Log  ${j}
    \  ${vns_name}=  Evaluate  str('v') + str(${i})
    \  ${intf_name_1}=  Evaluate  str('ethernet') + str(${j})
    \  ${k}=  Evaluate  ${j} + 1
    \  ${intf_name_2}=  Evaluate  str('ethernet') + str(${k})          
    \  rest delete interface from vns  ${tenant}  ${vns_name}  ${switch_alias}  ${intf_name_1}  -1
    \  rest delete interface from vns  ${tenant}  ${vns_name}  ${switch_alias}  ${intf_name_2}  -1
    \  ${j}=  Evaluate  ${j} + 2
    
* Keywords 

delete existing controllers  [Arguments]  ${switch}  ${controller}
    ${ret_value_1}=  cli delete controller  ${switch}  ${controller}
    Should Be True  ${ret_value_1}

add openflow controller  [Arguments]  ${switch}  ${controller}
    ${ret_value_1}=  cli add controller  ${switch}  ${controller}
    Should Be True  ${ret_value_1}    

verify openflow controller  [Arguments]  ${switch}  ${controller}
    ${ret_value_1}=  cli verify controller  ${switch}  ${controller}
    Should Be True  ${ret_value_1}
 
ping remote  [Arguments]  ${remote}
    ${ret_value_1}=  ping from local  ${remote}
    Should Be True  ${ret_value_1}

ping from switch  [Arguments]  ${switch}  ${remote} 
    ${ret_value_1}=  cli ping from switch  ${switch}  ${remote}
    Should Be True  ${ret_value_1}  

configure dns domain  [Arguments]  ${switch}  ${dns_server}  ${dns_domain}  
    ${ret_value_1}=  cli add dns server domain  ${switch}  ${dns_server}  ${dns_domain}
    Should Be True  ${ret_value_1}

verify interfaces  [Arguments]  ${switch}
    cli show all interfaces  ${switch}

shut interface  [Arguments]  ${switch}  ${interface}
    ${ret_value_1}=  cli disable interface  ${switch}  ${interface}
    Should Be True  ${ret_value_1}    

verify interface state  [Arguments]  ${switch}  ${interface}  ${state}
    ${ret_value_1}=  cli show interface state  ${switch}  ${interface}
    Should Contain  ${ret_value_1}  ${state}  

unshut interface  [Arguments]  ${switch}  ${interface}
    ${ret_value_1}=  cli enable interface  ${switch}  ${interface}
    Should Be True  ${ret_value_1}

delete static ip  [Arguments]  ${switch}  ${netmask}  ${gateway}
    ${ret_value_1}=  cli delete static ip  ${switch}  ${netmask}  ${gateway}
    Should Be True  ${ret_value_1}

add static ip  [Arguments]  ${switch}  ${netmask}  ${gateway}
    ${ret_value_1}=  cli add static ip  ${switch}  ${netmask}  ${gateway}
    Should Be True  ${ret_value_1}

delete dns  [Arguments]  ${switch}  ${dns_server}  ${dns_domain}
    ${ret_value_1}=  cli delete dns server domain  ${switch}  ${dns_server}  ${dns_domain}
    Should Be True  ${ret_value_1}
    
add dns  [Arguments]  ${switch}  ${dns_server}  ${dns_domain}
    ${ret_value_1}=  cli add dns server domain  ${switch}  ${dns_server}  ${dns_domain}
    Should Be True  ${ret_value_1}

verify ip dns  [Arguments]  ${switch}  ${netmask}  ${gateway}  ${dns_server}  ${dns_domain}  
    ${ret_value_1}=  cli verify ip dns  ${switch}  ${netmask}  ${gateway}  ${dns_server}  ${dns_domain}
    Should Be True  ${ret_value_1}

enable crc forwarding  [Arguments]  ${switch}
    ${ret_value_1}=  cli enable crc forwarding  ${switch}
    Should Be True  ${ret_value_1}

verify crc is enabled  [Arguments]  ${switch}
    ${ret_value_1}=  cli verify crc forwarding is enabled  ${switch}
    Should Be True  ${ret_value_1}
    
verify crc is disabled  [Arguments]  ${switch}
    ${ret_value_1}=  cli verify crc forwarding is disabled  ${switch}
    Should Be True  ${ret_value_1}

disable crc forwarding  [Arguments]  ${switch}
    ${ret_value_1}=  cli disable crc forwarding  ${switch}
    Should Be True  ${ret_value_1}

configure ntp server  [Arguments]  ${switch}  ${ntp_server}
    ${ret_value_1}=  add ntp server  ${switch}  ${ntp_server}  
    Should Be True  ${ret_value_1}
 
verify ntp server  [Arguments]  ${switch}  ${ntp_server}
     ${ret_value_1}=  verify ntp  ${switch}  ${ntp_server}  
    Should Be True  ${ret_value_1}

delete ntp  [Arguments]  ${switch}  ${ntp_server}
    ${ret_value_1}=  delete ntp server  ${switch}  ${ntp_server}  
    Should Be True  ${ret_value_1}
    