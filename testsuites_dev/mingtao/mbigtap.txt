* Setting
Documentation   BigTap Test Suite
Suite Setup     base suite setup
Suite Teardown  base suite teardown
Test Setup      bigtap test setup
Test Teardown   bigtap test teardown
Force Tags      BigTap Sanity
Library         keywords_dev/mingtao/Common.py
Library         keywords/BigTap.py 
Library         keywords/BsnCommon.py  



* Variable
 
${short}   1
${medium}  5
${long}    30 

${bip}    "111.111.111.0"
${bmask}   "255.255.255.0"

${bip6}     "1111:100:200:300:0:0:0:0"
${bmask6}   "FFFF:FFFF:FFFF:FFFF:0:0:0:0"

* Test Case

T1.1 Address group IPv4  
 
    Config 1 ipv4 entries                IPV4        100.100.100.100   255.255.255.255  	
    Config number of ipv4 entries        IPV4_10     10.0.0.0          0.1.0.2         255.255.255.254      10 
    Config bigtap policy                 IPv4_ADD    S207-39     S207-37        
    Apply ipv4 address group to policy   IPv4_ADD    "IPV4"  20   S207   4    
    Ipv4 address group negative      IPv4_ADD    "IPV4"    100
    
 	[Tags] 	sanity    skipped

    
T1.2 Address group IPv6  
 	Config 1 ipv6 entries                 IPV6        1001:100:200:300:0:0:0:0     FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF   
	Config number of ipv6 entries         IPV6_10     2001:100:200:300:0:0:0:0     0:0:0:0:0:1:0:1     FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF     10 
    Config bigtap policy                  IPv6_ADD    S207-39     S207-37   
	Apply ipv6 address group to policy    IPv6_ADD    "IPV6"  20  S207   4     
	Ipv6 address group negative       IPv6_ADD    "IPV6"     100
	
 	[Tags] 	sanity      skipped

T1.3 Address group IPv4/IPv6  
    Config number of ipv4 entries        IPV4_10     10.0.0.0          0.1.0.2         255.255.255.254      10 
    Config number of ipv6 entries        IPV6_10     2001:100:200:300:0:0:0:0     0:0:0:0:0:1:0:1     FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF     10  
    Config bigtap policy                 IPv46_ADD     S207-39     S207-37 
    Apply ipv4 address group to policy   IPv46_ADD     "IPV4_10"  100  S207    40   
  	Apply ipv6 address group to policy   IPv46_ADD     "IPV6_10"  200  S207    80
    Ipv46 address group negative         IPv46_ADD     "IPV4_10"    "IPV6_10"   500
 
	[Tags] 	feature    skipped

 
 
T1.4 Address group IPV4 match options  
    Config number of ipv4 entries        IPV4_10     10.0.0.0          0.1.0.2         255.255.255.254      10 
    Config bigtap policy                 IPv4_ADD    S207-39     S207-37	 
    Ipv4 all match option                IPv4_ADD    "IPV4_10"     500
    Verify policy running config matches    IPv4_ADD   16


	[Tags] 	sanity    skipped

T1.5 Address group IPV6 match options
    Config number of ipv6 entries        IPV6_10     2001:100:200:300:0:0:0:0   0:0:0:0:0:1:0:1   FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF  10  
    Config bigtap policy                 IPv6_ADD    S207-39    S207-37  
    Ipv6 all match option                IPv6_ADD    "IPV6_10"    500
    Verify policy running config matches    IPv6_ADD   16

	[Tags] 	sanity    skipped


T1.6 Address group IPv4 overlap
     Config number of ipv4 entries        G_1  10.0.0.0  0.1.0.2   255.255.255.254   10   
     Config number of ipv4 entries        G_2  50.0.0.0  0.1.0.2   255.255.255.254   10 
     Config bigtap policy                 P1    S207-39     S207-37	
     Config bigtap policy                 P2    S207-39     S207-38	
     Config ipv4 list src                 P1    "G_1"   10
     Config ipv4 list dst                 P2    "G_2"   10
     Sleep     ${medium}      
     Verify switch entry   S207   120
 
	[Tags] 	sanity    skipped
 
 
T1.7 Address group IPv6 overlap
     Config number of ipv6 entries        G_1  f001:100:0:0:0:0:0:0 	0:1:0:1:0:0:0:0	  ffff:ffff:ffff:ffff:0:0:0:0   10   
     Config number of ipv6 entries        G_2  1001:100:0:0:0:0:0:0 	0:1:0:1:0:0:0:0	  ffff:ffff:ffff:ffff:0:0:0:0   10 
     Config bigtap policy                 P1    S207-39     S207-37	
     Config bigtap policy                 P2    S207-39     S207-38	
     Config ipv6 list src                 P1    "G_1"   10
     Config ipv6 list dst                 P2    "G_2"   10
     Sleep     ${medium}      
     Verify switch entry   S207   120
 
	[Tags] 	sanity   skipped
 

	
T2.1 Ipv4 prefix optimization
     Config number of ipv4 entries        G_1     10.0.0.0    0.0.0.1    255.255.255.255      32  
     Config bigtap policy                 P1    S207-39     S207-37	 
     Config ipv4 list src                 P1    "G_1"   10
     Config ipv4 list dst                 P1    "G_1"   20
     Sleep     ${medium}       
	 Verify optimized match    P1   2
     Verify switch entry       S207   2

	[Tags]   sanity    skipped


T2.2 Ipv4 prefix and src address optimization
     Config number of ipv4 entries        G_1     10.0.0.128    0.0.0.1    255.255.255.255      32  
     Config bigtap policy                 P1    S207-39     S207-37	 
     Config ipv4 list src ip dst                P1    "G_1"   10     "110.111.111.0"   "255.255.255.0"  
     Config ipv4 list dst ip src                P1    "G_1"   20     "210.111.111.0"   "255.255.255.0"  
     Sleep     ${medium}       
	 Verify optimized match    P1   2
     Verify switch entry       S207   2

	[Tags]   sanity    skipped


T2.3 Ipv6 prefix optimization
     Config number of ipv6 entries        G_1      f001:100:0:0:0:0:0:0 	0:0:0:1:0:0:0:0	  ffff:ffff:ffff:ffff:0:0:0:0     32  
     Config bigtap policy                 P1    S207-39     S207-37	 
     Config ipv6 list src                 P1    "G_1"   10
     Config ipv6 list dst                 P1    "G_1"   20
     Sleep     ${medium}       
	 Verify optimized match    P1   2
     Verify switch entry       S207   2

	[Tags]   sanity      skipped


T2.4 Ipv6 prefix and src address optimization
     Config number of ipv6 entries        G_1      f001:100:0:0:0:0:0:0 	0:0:0:1:0:0:0:0	  ffff:ffff:ffff:ffff:0:0:0:0       32  
     Config bigtap policy                 P1    S207-39     S207-37	 
     Config ipv6 list src ip dst                P1    "G_1"   10     "2222:123:1111:1234:0:0:0:0"   "ffff:ffff:ffff:ffff:0:0:0:0"  
     Config ipv6 list dst ip src                P1    "G_1"   20     "1111:123:2222:1234:0:0:0:0"   "ffff:ffff:ffff:ffff:0:0:0:0"  
     Sleep     ${medium}       
	 Verify optimized match    P1   2
     Verify switch entry       S207   2

	[Tags]   sanity    skipped









* Keywords
Config bigtap policy       [Arguments]    ${PName}  ${Fint}  ${Dint}	 
	rest_add_policy 	              admin-view  ${PName}  forward 
	rest_add_policy_interface         admin-view  ${PName}  ${Fint}   filter
	rest_add_policy_interface         admin-view  ${PName}  ${Dint}   delivery   
    Sleep     ${short} 
 
Verify policy running config matches   [Arguments]    ${PName}   ${matches}	 
  	${input_dict}=  rest_show_run_policy   ${PName}       
    ${num}=   rest_get_run_policy_feild    ${input_dict}   ${PName}   match=yes
    Should Be Equal As Integers    ${num}     ${matches}	

Verify switch entry    [Arguments]    ${swName}   ${flow}	 
     ${switchFlowVal}=   rest_show_switch_flow   switch_alias=${swName}
     Should Be Equal As Integers  ${switchFlowVal}   ${flow}

Verify optimized match    [Arguments]    ${PName}   ${matches}	 
  	 ${numMatches}=  rest_show_policy_optimize    ${PName}  
     Should Be Equal As Integers   ${numMatches}  ${matches}	 




Config ipv4 list src     [Arguments]    ${PName}   ${GName}	  ${seq}
     ${result}=  rest_add_policy_match  admin-view   ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list":${GName}, "ether-type":2048}
     Should be True    ${result}  
  	

Config ipv4 list dst     [Arguments]    ${PName}   ${GName}	  ${seq}
     ${result}=  rest_add_policy_match  admin-view   ${PName}   ${seq}   {"sequence": ${seq}, "dst-ip-list":${GName}, "ether-type":2048}
     Should be True    ${result}  	

Config ipv4 list src ip dst       [Arguments]          ${PName}   ${GName}	  ${seq}    ${dst}    ${dmask}
     ${result}=  rest_add_policy_match  admin-view   ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list":${GName}, "dst-ip":${dst}, "dst-ip-mask":${dmask}, "ether-type":2048}
     Should be True    ${result}  	
Config ipv4 list dst ip src          [Arguments]       ${PName}   ${GName}	  ${seq}    ${src}    ${smask}
     ${result}=  rest_add_policy_match  admin-view   ${PName}   ${seq}   {"sequence": ${seq}, "dst-ip-list":${GName}, "src-ip":${src}, "src-ip-mask":${smask}, "ether-type":2048}
     Should be True    ${result}  	

    
Config ipv6 list src     [Arguments]    ${PName}   ${GName}	  ${seq}
     ${result}=  rest_add_policy_match  admin-view   ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list":${GName}, "ether-type":34525}
     Should be True    ${result}  
  	

Config ipv6 list dst     [Arguments]    ${PName}   ${GName}	  ${seq}
     ${result}=  rest_add_policy_match  admin-view   ${PName}   ${seq}   {"sequence": ${seq}, "dst-ip-list":${GName}, "ether-type":34525}
     Should be True    ${result}  	
  
Config ipv6 list src ip dst       [Arguments]          ${PName}   ${GName}	  ${seq}    ${dst}    ${dmask}
     ${result}=  rest_add_policy_match  admin-view   ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list":${GName}, "dst-ip":${dst}, "dst-ip-mask":${dmask}, "ether-type":34525}
     Should be True    ${result}  	
Config ipv6 list dst ip src          [Arguments]       ${PName}   ${GName}	  ${seq}    ${src}    ${smask}
     ${result}=  rest_add_policy_match  admin-view   ${PName}   ${seq}   {"sequence": ${seq}, "dst-ip-list":${GName}, "src-ip":${src}, "src-ip-mask":${smask}, "ether-type":34525}
     Should be True    ${result}  	






Config 1 ipv4 entries     [Arguments]  ${GName}  ${ipAddr}      ${mask}    
	REST add address group   		              ${GName}      ipv4  
	${result}=   REST add address group entry      ${GName}     ${ipAddr}   ${mask} 
    Should be True    ${result}  	
 	${input_dict}=  rest_show_address_group        ${GName}
	${result}=      verify_address_group 	      ${input_dict}     ${GName}   group_type=ipv4   entry=1 
    Should be True    ${result}  

Config number of ipv4 entries      [Arguments]  ${GName}  ${ipAddr}   ${step}    ${mask}    ${num} 

	REST add address group                        ${GName}    ipv4  
    ${result}=  gen_add_address_group_entries     ${GName}    ipv4     ${ipAddr}      ${step}    ${mask}    ${num} 	
    Should be True    ${result}  	
 	${input_dict}=  rest_show_address_group      ${GName}
    ${result}=  verify_address_group            ${input_dict}     ${GName}   group_type=ipv4   entry=${num}   
    Should be True    ${result}  
 

Apply ipv4 address group to policy     [Arguments]  ${PName}    ${GName}  ${seq}  ${sName}   ${num}     
	
 	${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName}, "ether-type": 2048}
    Should be True    ${result}  		
    ${seq}=  expr   ${seq} + 1
	${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq} , "dst-ip-list": ${GName}, "ether-type": 2048} 	
	Should be True    ${result}  	 
    ${seq}=  expr   ${seq} + 1
	${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}    {"sequence": ${seq}, "dst-ip-list": ${GName}, "ether-type": 2048,"src-ip":${bip}, "src-ip-mask":${bmask}}  
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
 	${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}    {"sequence": ${seq}, "src-ip-list": ${GName}, "ether-type": 2048,"dst-ip":${bip}, "dst-ip-mask":${bmask}}  		
    Should be True    ${result}  	
	Sleep     ${short}

    ${input_dict}=   rest_show_policy    ${PName} 
    ${result}=       verify_policy       ${input_dict}   ${PName}   action=forward
    Should be True   ${result}   
 
    ${switchFlowVal}=   rest_show_switch_flow   switch_alias=${sName}
    Should Be Equal As Integers  ${switchFlowVal}  ${num} 


Ipv4 address group negative        [Arguments]   ${PName}   ${GName}   ${seq} 
    ${result}=  rest_add_policy_match   admin-view    ${PName}   ${seq}    {"sequence":${seq}, "src-ip-list": ${GName}, "ether-type": 2048,"dst-ip-list":${GName}}	  
 	Should Not Be True    ${result}  	


Config 1 ipv6 entries        [Arguments]  ${GName}  ${ipAddr}   ${mask}                  	 
	REST add address group  		              ${GName}   ipv6  
	${result}=   REST add address group entry     ${GName}   ${ipAddr}   ${mask}  
    Should be True    ${result}  		 	
 	${input_dict}=  rest_show_address_group       ${GName}
	${result}=      verify_address_group 	     ${input_dict}     ${GName}   group_type=ipv6   entry=1 
    Should be True    ${result}  
     
Config number of ipv6 entries       [Arguments]  ${GName}  ${ipAddr}   ${step}    ${mask}    ${num} 
	REST add address group                        ${GName}    ipv6   
    ${result}=  gen_add_address_group_entries     ${GName}    ipv6     ${ipAddr}   ${step}    ${mask}    ${num} 	
    Should be True    ${result} 
 	${input_dict}=   rest_show_address_group      ${GName}
    ${result}=  verify_address_group            ${input_dict}     ${GName}   group_type=ipv6   entry=${num}    
    Should be True    ${result}  
 

Apply ipv6 address group to policy     [Arguments]  ${PName}     ${GName}  ${seq}  ${sName}  ${num}     	
	${result}=  rest_add_policy_match       admin-view   ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName}, "ether-type": 34525} 
    Should be True    ${result}  		 		
    ${seq}=  expr   ${seq} + 1
	${result}=  rest_add_policy_match       admin-view   ${PName}   ${seq}   {"sequence": ${seq}, "dst-ip-list": ${GName}, "ether-type": 34525} 	
	Should be True    ${result}   
    ${seq}=  expr   ${seq} + 1
	${result}=  rest_add_policy_match       admin-view   ${PName}   ${seq}   {"sequence": ${seq}, "ether-type": 34525, "dst-ip-mask": "FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF", "src-ip-list": ${GName}, "dst-ip": "1111:100:200:300:0:0:0:0"}  
    Should be True    ${result}  
    ${seq}=  expr   ${seq} + 1
	${result}=  rest_add_policy_match       admin-view   ${PName}   ${seq}   {"sequence": ${seq}, "ether-type": 34525, "src-ip-mask": "FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF", "dst-ip-list": ${GName}, "src-ip": "1111:100:200:300:0:0:0:0"}  	
    Should be True    ${result}  
	Sleep     ${short}

    ${input_dict}=   rest_show_policy     ${PName} 
    ${result}=       verify_policy       ${input_dict}     ${PName}   action=forward
    Should be True    ${result}   
 
    ${switchFlowVal}=   rest_show_switch_flow   switch_alias=${sName}
    Should Be Equal As Integers  ${switchFlowVal}   ${num} 


Ipv6 address group negative     [Arguments]   ${PName}   ${GName}    ${seq}
    ${result}=  rest_add_policy_match   admin-view  ${PName}    ${seq}   {"sequence": ${seq}, "dst-ip-list": ${GName}, "src-ip-list": ${GName},"ether-type": 34525} 
 	Should Not Be True    ${result}  
 
Ipv46 address group negative      [Arguments]   ${PName}     ${GName}    ${G6Name}    ${seq}
    log  Negative - type ipv6, src group - ipv4
    ${result}=  rest_add_policy_match   admin-view  ${PName}    ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName},"ether-type": 34525} 
 	Should Not Be True    ${result}  
    ${seq}=  expr   ${seq} + 1
    log  Negative - type ipv6, dst group - ipv4
    ${result}=  rest_add_policy_match   admin-view  ${PName}    ${seq}   {"sequence": ${seq}, "dst-ip-list": ${GName},"ether-type": 34525} 
 	Should Not Be True    ${result}  
    ${seq}=  expr   ${seq} + 1
    log  Negative - type ipv4, src group - ipv6
    ${result}=  rest_add_policy_match   admin-view  ${PName}    ${seq}   {"sequence": ${seq}, "src-ip-list": ${G6Name},"ether-type": 2048} 
 	Should Not Be True    ${result}  
    ${seq}=  expr   ${seq} + 1
    log  Negative - type ipv4, dst group - ipv6
    ${result}=  rest_add_policy_match   admin-view  ${PName}    ${seq}   {"sequence": ${seq}, "dst-ip-list": ${G6Name},"ether-type": 2048} 
 	Should Not Be True    ${result}  
    ${seq}=  expr   ${seq} + 1
    log  Negative - type ipv6, src group - ipv4, dst-group - ipv6
    ${result}=  rest_add_policy_match   admin-view  ${PName}    ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName},"dst-ip-list": ${G6Name},"ether-type": 34525} 
 	Should Not Be True    ${result}  
    ${seq}=  expr   ${seq} + 1
    log  Negative - type ipv6, src group - ipv6, dst-group - ipv4
    ${result}=  rest_add_policy_match   admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list": ${G6Name},"dst-ip-list": ${GName},"ether-type": 34525} 
 	Should Not Be True    ${result}  
    ${seq}=  expr   ${seq} + 1
    log  Negative - type ipv4, src group - ipv4, dst-group - ipv6
    ${result}=  rest_add_policy_match   admin-view  ${PName}    ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName},"dst-ip-list": ${G6Name},"ether-type": 2048} 
 	Should Not Be True    ${result}  
    ${seq}=  expr   ${seq} + 1
    log  Negative - type ipv4, src group - ipv6, dst-group - ipv4
    ${result}=  rest_add_policy_match   admin-view  ${PName}    ${seq}   {"sequence": ${seq}, "src-ip-list": ${G6Name},"dst-ip-list": ${GName},"ether-type": 2048} 
 	Should Not Be True    ${result}  
    ${seq}=  expr   ${seq} + 1
    log  Negative - type ipv6, src group - ipv4, dst - ipv6
    ${result}=  rest_add_policy_match   admin-view  ${PName}    ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName}, "dst-ip": "2001:200::0","dst-ip-mask": "FFFF:FFFF::0", "ether-type": 34525} 
 	Should Not Be True    ${result}  
    ${seq}=  expr   ${seq} + 1
    log  Negative - type ipv6, src group - ipv6, dst - ipv4
    ${result}=  rest_add_policy_match   admin-view  ${PName}    ${seq}  {"sequence": ${seq}, "src-ip-list": ${G6Name}, "dst-ip": "200.200.200.0", "dst-ip-mask": "255.255.255.0","ether-type": 34525} 
 	Should Not Be True    ${result}  
    ${seq}=  expr   ${seq} + 1
    log  Negative - type ipv4, src group - ipv4, dst - ipv6
    ${result}=  rest_add_policy_match   admin-view  ${PName}    ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName},"dst-ip": "2001:200::0","dst-ip-mask": "FFFF:FFFF::0","ether-type": 2048} 
   	Should Not Be True    ${result}  
    ${seq}=  expr   ${seq} + 1
    log  Negative - type ipv4, src group - ipv6, dst - ipv4
    ${result}=  rest_add_policy_match   admin-view  ${PName}    ${seq}   {"sequence": ${seq}, "src-ip-list": ${G6Name}, "dst-ip": "200.200.200.0", "dst-ip-mask": "255.255.255.0","ether-type": 2048} 
 	Should Not Be True    ${result}  
    ${seq}=  expr   ${seq} + 1
    log  Negative - type ipv6, src - ipv4, dst group - ipv6
    ${result}=  rest_add_policy_match   admin-view  ${PName}    ${seq}   {"sequence": ${seq}, "dst-ip-list": ${GName}, "src-ip": "2001:200::0","src-ip-mask": "FFFF:FFFF::0", "ether-type": 34525} 
 	Should Not Be True    ${result}  
    ${seq}=  expr   ${seq} + 1
    log  Negative - type ipv6, src - ipv6, dst group - ipv4
    ${result}=  rest_add_policy_match   admin-view  ${PName}    ${seq}   {"sequence": ${seq}, "dst-ip-list": ${G6Name}, "src-ip": "200.200.200.0", "src-ip-mask": "255.255.255.0","ether-type": 34525} 
 	Should Not Be True    ${result}  
    ${seq}=  expr   ${seq} + 1
    log  Negative - type ipv4, src - ipv4, dst group - ipv6
    ${result}=  rest_add_policy_match   admin-view  ${PName}    ${seq}   {"sequence": ${seq}, "dst-ip-list": ${GName},"src-ip": "2001:200::0","src-ip-mask": "FFFF:FFFF::0","ether-type": 2048} 
 	Should Not Be True    ${result}  
    ${seq}=  expr   ${seq} + 1
    log  Negative - type ipv4, src - ipv6, dst group - ipv4
    ${result}=  rest_add_policy_match   admin-view  ${PName}    ${seq}   {"sequence": ${seq}, "dst-ip-list": ${G6Name}, "src-ip": "200.200.200.0", "src-ip-mask": "255.255.255.0","ether-type": 2048} 
 	Should Not Be True    ${result}  


Ipv4 all match option   [Arguments]    ${PName}  ${GName}    ${seq}
    log    source list   
 	${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName}, "ether-type": 2048}
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
    log    dest list   
 	${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "dst-ip-list": ${GName}, "ether-type": 2048}
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
    log    source list + dest ip 
 	${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "dst-ip-list": ${GName}, "ether-type": 2048, "dst-ip": "50.10.10.0","dst-ip-mask": "255.255.255.0"}
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
    log    dest list + src ip
	${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "dst-ip-list": ${GName}, "ether-type": 2048,"src-ip": "50.10.10.0","src-ip-mask": "255.255.255.0"}
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
	log   source list + dst ip + tcp dst port 
    ${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName}, "dst-tp-port": 100, "ip-proto": 6, "ether-type": 2048,"dst-ip": "10.10.10.0","dst-ip-mask": "255.255.255.0"} 
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
	log   source list + dst ip + tcp dst port range 
    ${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName}, "dst-tp-port-max": 20, "dst-tp-port-min": 10, "ip-proto": 6, "ether-type": 2048,"dst-ip": "10.10.10.0","dst-ip-mask": "255.255.255.0"} 
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
	log   source list + dst ip + udp dst port 
    ${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName}, "dst-tp-port": 100, "ip-proto": 17, "ether-type": 2048,"dst-ip": "10.10.10.0","dst-ip-mask": "255.255.255.0"} 
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
	log   source list + dst ip + udp dst port range 
    ${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName}, "dst-tp-port-max": 20, "dst-tp-port-min": 10, "ip-proto": 17, "ether-type": 2048,"dst-ip": "10.10.10.0","dst-ip-mask": "255.255.255.0"} 
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
	log   source list + dst ip + tcp src port 
    ${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName}, "src-tp-port": 100, "ip-proto": 6, "ether-type": 2048,"dst-ip": "10.10.10.0","dst-ip-mask": "255.255.255.0"} 
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
	log   source list + dst ip + tcp srct port range 
    ${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName}, "src-tp-port-max": 20, "src-tp-port-min": 10, "ip-proto": 6, "ether-type": 2048,"dst-ip": "10.10.10.0","dst-ip-mask": "255.255.255.0"} 
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
	log   source list + dst ip + udp src port 
    ${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName}, "src-tp-port": 100, "ip-proto": 17, "ether-type": 2048,"dst-ip": "10.10.10.0","dst-ip-mask": "255.255.255.0"} 
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
	log   source list + dst ip + udp src port range 
    ${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName}, "src-tp-port-max": 20, "src-tp-port-min": 10, "ip-proto": 17, "ether-type": 2048,"dst-ip": "10.10.10.0","dst-ip-mask": "255.255.255.0"} 
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
	log   source list + dst ip + tcp src port + dst port range
    ${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName}, "src-tp-port": 100, "ip-proto": 6, "ether-type": 2048,"dst-ip": "10.10.10.0","dst-ip-mask": "255.255.255.0"} 
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
	log   source list + dst ip + tcp src port range + dst port
    ${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName}, "src-tp-port-max": 20, "src-tp-port-min": 10, "ip-proto": 6, "ether-type": 2048,"dst-ip": "10.10.10.0","dst-ip-mask": "255.255.255.0"} 
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
	log   source list + dst ip + udp src port + dst port range
    ${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName}, "src-tp-port": 100, "ip-proto": 17, "ether-type": 2048,"dst-ip": "10.10.10.0","dst-ip-mask": "255.255.255.0"} 
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
	log   source list + dst ip + udp src port range + dst port
    ${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName}, "src-tp-port-max": 20, "src-tp-port-min": 10, "ip-proto": 17, "ether-type": 2048,"dst-ip": "10.10.10.0","dst-ip-mask": "255.255.255.0"} 
    Should be True    ${result}  	

Ipv6 all match option   [Arguments]    ${PName}  ${GName}    ${seq}
    log    source list   
 	${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName}, "ether-type": 34525}
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
    log    dest list   
 	${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "dst-ip-list": ${GName}, "ether-type": 34525}
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
    log    source list + dest ip 
 	${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "dst-ip-list": ${GName}, "ether-type": 34525, "dst-ip": "2001:111:222:333:0:0:0:0","dst-ip-mask": "FFFF:FFFF:FFFF:FFFF:0:0:0:0"}
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
    log    dest list + src ip
	${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "dst-ip-list": ${GName}, "ether-type": 34525,"src-ip": "2001:111:222:333:0:0:0:0","src-ip-mask": "FFFF:FFFF:FFFF:FFFF:0:0:0:0"}
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
	log   source list + dst ip + tcp dst port 
    ${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName}, "dst-tp-port": 100, "ip-proto": 6, "ether-type": 34525,"dst-ip": "2001:111:222:333:0:0:0:0","dst-ip-mask": "FFFF:FFFF:FFFF:FFFF:0:0:0:0"} 
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
	log   source list + dst ip + tcp dst port range 
    ${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName}, "dst-tp-port-max": 20, "dst-tp-port-min": 10, "ip-proto": 6, "ether-type": 34525,"dst-ip": "2001:111:222:333:0:0:0:0","dst-ip-mask": "FFFF:FFFF:FFFF:FFFF:0:0:0:0"} 
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
	log   source list + dst ip + udp dst port 
    ${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName}, "dst-tp-port": 100, "ip-proto": 17, "ether-type": 34525,"dst-ip": "2001:111:222:333:0:0:0:0","dst-ip-mask": "FFFF:FFFF:FFFF:FFFF:0:0:0:0"} 
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
	log   source list + dst ip + udp dst port range 
    ${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName}, "dst-tp-port-max": 20, "dst-tp-port-min": 10, "ip-proto": 17, "ether-type": 34525,"dst-ip": "2001:111:222:333:0:0:0:0","dst-ip-mask": "FFFF:FFFF:FFFF:FFFF:0:0:0:0"} 
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
	log   source list + dst ip + tcp src port 
    ${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName}, "src-tp-port": 100, "ip-proto": 6, "ether-type": 34525,"dst-ip": "2001:111:222:333:0:0:0:0","dst-ip-mask": "FFFF:FFFF:FFFF:FFFF:0:0:0:0"} 
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
	log   source list + dst ip + tcp srct port range 
    ${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName}, "src-tp-port-max": 20, "src-tp-port-min": 10, "ip-proto": 6, "ether-type": 34525,"dst-ip": "2001:111:222:333:0:0:0:0","dst-ip-mask": "FFFF:FFFF:FFFF:FFFF:0:0:0:0"} 
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
	log   source list + dst ip + udp src port 
    ${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName}, "src-tp-port": 100, "ip-proto": 17, "ether-type": 34525,"dst-ip": "2001:111:222:333:0:0:0:0","dst-ip-mask": "FFFF:FFFF:FFFF:FFFF:0:0:0:0"} 
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
	log   source list + dst ip + udp src port range 
    ${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName}, "src-tp-port-max": 20, "src-tp-port-min": 10, "ip-proto": 17, "ether-type": 34525,"dst-ip": "2001:111:222:333:0:0:0:0","dst-ip-mask": "FFFF:FFFF:FFFF:FFFF:0:0:0:0"} 
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
	log   source list + dst ip + tcp src port + dst port range
    ${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName}, "src-tp-port": 100, "ip-proto": 6, "ether-type": 34525,"dst-ip": "2001:111:222:333:0:0:0:0","dst-ip-mask": "FFFF:FFFF:FFFF:FFFF:0:0:0:0"} 
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
	log   source list + dst ip + tcp src port range + dst port
    ${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName}, "src-tp-port-max": 20, "src-tp-port-min": 10, "ip-proto": 6, "ether-type": 34525,"dst-ip": "2001:111:222:333:0:0:0:0","dst-ip-mask": "FFFF:FFFF:FFFF:FFFF:0:0:0:0"} 
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
	log   source list + dst ip + udp src port + dst port range
    ${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName}, "src-tp-port": 100, "ip-proto": 17, "ether-type": 34525,"dst-ip": "2001:111:222:333:0:0:0:0","dst-ip-mask": "FFFF:FFFF:FFFF:FFFF:0:0:0:0"} 
    Should be True    ${result}  	
    ${seq}=  expr   ${seq} + 1
	log   source list + dst ip + udp src port range + dst port
    ${result}=  rest_add_policy_match      admin-view  ${PName}   ${seq}   {"sequence": ${seq}, "src-ip-list": ${GName}, "src-tp-port-max": 20, "src-tp-port-min": 10, "ip-proto": 17, "ether-type": 34525,"dst-ip": "2001:111:222:333:0:0:0:0","dst-ip-mask": "FFFF:FFFF:FFFF:FFFF:0:0:0:0"} 
    Should be True    ${result}  	





 