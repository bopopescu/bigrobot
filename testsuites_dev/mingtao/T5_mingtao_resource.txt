* Keywords


first boot of controller    [Arguments]   ${node}   ${ipaddr}   ${netmask}   ${gateway}   ${dns_server}  ${dns_search}   ${ntp_server}
 	${time}= 	Get Time     year,month,day
 	log  time is ${time}, the date is ${time[0]}
# 	${A}=   cli_take_snapshot   ${node}  run_config=yes	  
#	cli_copy  	src=running-config  dst=scp://bsn@qa-kvm-32:/home/mingtao/config_${time[0]}_${time[1]}_${time[2]}  scp_passwd=bsn
	
#	cli_boot_factory_default	${node}	 
	T5_longevity.cli add first boot   ${node}   ${ipaddr}   ${netmask}   ${gateway}   ${dns_server}  ${dns_search}   ${ntp_server}
	
#	cli_copy  	dst=running-config  src=scp://bsn@qa-kvm-32:/home/mingtao/config_${time[0]}_${time[1]}_${time[2]}  scp_passwd=bsn
# 	${B}=   cli_take_snapshot   ${node}  run_config=yes	  
#  	Should Be Equal    ${A}    ${B}	 	


controller first boot static   [Arguments]   ${node}   ${join_cluster}  ${dhcp}  ${ipaddr}   ${netmask}   ${gateway}  ${dns_server}  ${dns_search}  ${hostname}  
	first_boot_controller   ${node}   ${join_cluster}   ${dhcp}  ${ipaddr}   ${netmask}   ${gateway}  ${dns_server}  ${dns_search}    ${hostname}   


controller first boot static 2nd   [Arguments]   ${node}   ${join_cluster}  ${dhcp}  ${ipaddr}   ${netmask}   ${gateway}  ${dns_server}  ${dns_search}  ${hostname}   ${cluster_ip}
	first_boot_controller   ${node}   ${join_cluster}   ${dhcp}  ${ipaddr}   ${netmask}   ${gateway}  ${dns_server}  ${dns_search}    ${hostname}    ${cluster_ip} 



 
controller first boot dhcp   [Arguments]   ${node}   ${join_cluster}  ${dhcp}  
	first_boot_controller   ${node}   ${join_cluster}   ${dhcp}   

 
T5 platform case setup
    sleep    5

T5 platform case teardown
   sleep  5

upgrade   [Arguments]   ${node}   ${c_role}   ${e_role}
 	cli_copy_running_config_to_file    ${node}    config_try
	${result}=  rest_get_node_role     ${node} 
	Should Be Equal    ${result}     ${c_role}
 	${A}=   cli_take_snapshot   ${node}  run_config=yes	
  	${C}=  cli_take_snapshot    ${node}  filepath=/home/admin	
  		 	
	copy_pkg_from_jenkins    ${node}
	${result}= 	cli_upgrade_stage    ${node}
 	Should be True     ${result}  
	${result}= 	cli_upgrade_launch    ${node}
 	Should be True     ${result}  
 	
 	sleep  180
 	${result}=  rest_get_node_role   ${node}
	Should Be Equal    ${result}     ${e_role}
 	${B}=   cli_take_snapshot    ${node}   run_config=yes	
  	Should Be Equal    ${A}    ${B}	 	
 	${D}=  cli_take_snapshot    ${node}   filepath=/home/admin		
  	Should Be Equal    ${C}    ${D}	 		

Test whoami ping reauth with admin
	log  cli whoami with admin
	test cli whoami     admin   admin
	log  cli ping
	${lossA}=   cli_Ping  master  dest_ip=qa-kvm-32
	Should Be Equal As Integers  ${lossA}   0
    log  cli reauth with admin
    cli_reauth

Test whoami ping reauth with non admin
    log  cli reauth with non admin user1
    create user   user1   adminadmin  group1
    cli_reauth   user1   adminadmin
	log  cli whoami with non admin
	test cli whoami    user1   group1
 	log  cli ping
	${lossA}=   cli_Ping  master  dest_ip=qa-kvm-32
	Should Be Equal As Integers  ${lossA}   0
    cli_reauth   admin   adminadmin	
	cli_delete_user   user1   
 

test cli whoami    [Arguments]    ${user}     ${group}
	 ${result}=  cli_whoami
	 Should Be Equal    ${result[0]}    ${user}
	 Should Be Equal    ${result[1]}    ${group}


reboot node and verify it role
	cluster_node_reboot    True    
 
walk cli command 
#	cli_exec_walk    file_name=cli_exec_walk
#	cli_enable_walk    file_name=cli_enable_walk	
#	cli_config_walk    file_name=cli_config_walk	

     
 
create user    [Arguments]    ${user}     ${passwd}   ${group}
	cli_add_user 	  ${user}     ${passwd}   	
 	cli_group_add_users    ${group}    ${user}
  
	