* Setting
Documentation   BigTap Test Suite
Suite Setup     Bigtap list op l3_l4 suite setup
Suite Teardown  Bigtap list op l3_l4 suite teardown
Test Setup      Bigtap list op l3_l4 case setup
Test Teardown   Bigtap list op l3_l4 case teardown
Force Tags      BigTap
Library         keywords_dev/mingtao/Common.py
Library         keywords/BigTap.py 
Library         keywords/BsnCommon.py  
Library         OperatingSystem
Resource	    testsuites_dev/mingtao/blackbird_list_op_l34_resource.txt


* Variable
 
${short}   1
${medium}  5
${long}   10 
${verylong}    30 
${bip}    "111.111.111.0"
${bmask}   "255.255.255.0"

${bip6}     "1111:100:200:300:0:0:0:0"
${bmask6}   "FFFF:FFFF:FFFF:FFFF:0:0:0:0"

${sw1}   s207
${sw1_f1}  S207-44
${sw1_d1}  S207-46
${sw1_d2}  S207-48

* Test Case

T1.1 Address group IPv4  
 
    Config 1 ipv4 entries                IPV4        100.100.100.100   255.255.255.255  	
    Config number of ipv4 entries        IPV4_10     10.0.0.0          0.1.0.2         255.255.255.254      10 
    Config bigtap policy                 IPv4_ADD    ${sw1_f1}     ${sw1_d1}        
    Apply ipv4 address group to policy   IPv4_ADD    "IPV4"  20   ${sw1}   4    
    Ipv4 address group policy negative          IPv4_ADD    "IPV4"    100
    
 	[Tags] 	sanity  address_group   BigTap   blackbird     

    
T1.2 Address group IPv6  
 	Config 1 ipv6 entries                 IPV6        1001:100:200:300:0:0:0:0     FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF   
	Config number of ipv6 entries         IPV6_10     2001:100:200:300:0:0:0:0     0:0:0:0:0:1:0:1     FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF     10 
    Config bigtap policy                  IPv6_ADD    ${sw1_f1}     ${sw1_d1}   
	Apply ipv6 address group to policy    IPv6_ADD    "IPV6"  20  ${sw1}   4     
	Ipv6 address group policy negative       IPv6_ADD    "IPV6"     100
	
 	[Tags] 	sanity    address_group     BigTap   blackbird    

T1.3 Address group IPv4/IPv6  
    Config number of ipv4 entries        IPV4_10     10.0.0.0          0.1.0.2         255.255.255.254      10 
    Config number of ipv6 entries        IPV6_10     2001:100:200:300:0:0:0:0     0:0:0:0:0:1:0:1     FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF     10    
    Config bigtap policy                 IPv46_ADD     ${sw1_f1}     ${sw1_d1} 
    Apply ipv4 address group to policy   IPv46_ADD     "IPV4_10"  100  ${sw1}    40   
  	Apply ipv6 address group to policy   IPv46_ADD     "IPV6_10"  200  ${sw1}    80
    Ipv46 address group policy negative         IPv46_ADD     "IPV4_10"    "IPV6_10"   500
 
	[Tags] 	feature    address_group   BigTap   blackbird     

 
T1.4 Address group IPV4 match options  
    Config number of ipv4 entries        IPV4_10     10.0.0.0          0.1.0.2         255.255.255.254      10 
    Config bigtap policy                 IPv4_ADD    ${sw1_f1}     ${sw1_d1}	 
    Ipv4 all match option                IPv4_ADD    "IPV4_10"     500
    Verify policy running config matches    IPv4_ADD   17

	[Tags] 	sanity     address_group   BigTap   blackbird     

T1.5 Address group IPV6 match options
    Config number of ipv6 entries        IPV6_10     2001:100:200:300:0:0:0:0   0:0:0:0:0:1:0:1   FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF  10  
    Config bigtap policy                 IPv6_ADD    ${sw1_f1}    ${sw1_d1}  
    Ipv6 all match option                IPv6_ADD    "IPV6_10"    500
    Verify policy running config matches    IPv6_ADD   16

	[Tags] 	sanity   address_group    BigTap   blackbird    


T1.6 Address group IPv4 overlap
     Config number of ipv4 entries        G_1  10.0.0.0  0.1.0.2   255.255.255.254   10   
     Config number of ipv4 entries        G_2  50.0.0.0  0.1.0.2   255.255.255.254   10 
     Config bigtap policy                 P1    ${sw1_f1}     ${sw1_d1}	
     Config bigtap policy                 P2    ${sw1_f1}     ${sw1_d2}	
     Config ipv4 list src                 P1    "G_1"   10
     Config ipv4 list dst                 P2    "G_2"   10
     Sleep     ${medium}      
     Verify switch entry   ${sw1}   120
 
	[Tags] 	sanity   address_group   BigTap   blackbird    
 
 
T1.7 Address group IPv6 overlap
     Config number of ipv6 entries        G_1  f001:100:0:0:0:0:0:0 	0:1:0:1:0:0:0:0	  ffff:ffff:ffff:ffff:0:0:0:0   10   
     Config number of ipv6 entries        G_2  1001:100:0:0:0:0:0:0 	0:1:0:1:0:0:0:0	  ffff:ffff:ffff:ffff:0:0:0:0   10 
     Config bigtap policy                 P1    ${sw1_f1}     ${sw1_d1}	
     Config bigtap policy                 P2    ${sw1_f1}     ${sw1_d2}	
     Config ipv6 list src                 P1    "G_1"   10
     Config ipv6 list dst                 P2    "G_2"   10
     Sleep     ${medium}      
     Verify switch entry   ${sw1}   120
 
	[Tags] 	feature     address_group   BigTap   blackbird    
 
T1.8 ipv4/6 list config options
    REST add address group  		    G4    ipv4  
    REST add address group  		    G6    ipv6  
    Config ipv4/ipv6 list               G4     G6    
    Config ipv4/ipv6 list negative      G4     G6

	[Tags] 	feature     address_group   BigTap   blackbird  


T1.101 Address group IPv4 scale 
    Config number of ipv4 entries        G1    10.0.0.0          0.1.0.1         255.255.255.255      256 
    Config bigtap policy                 P1    ${sw1_f1}     ${sw1_d1}        
    Config ipv4 list src                 P1    "G1"   20   
    Config ipv4 list dst                 P1    "G1"   30   
    Sleep     ${long}       
    Verify switch entry                 ${sw1}   512	
    
 	[Tags] 	scaling  address_group   BigTap   blackbird    

T1.102 Address group IPv6 scale 
 	Config number of ipv6 entries         G1     2001:100:200:300:0:0:0:0     0:0:0:0:1:0:1:0     FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:FFFF:0     256 
    Config bigtap policy                  P1    ${sw1_f1}     ${sw1_d1}   
    Config ipv6 list src                  P1    "G1"   20   
    Config ipv6 list dst                  P1    "G1"   30   
    Sleep     ${long}       
    Verify switch entry                   ${sw1}   512	
 	
 	[Tags] 	scaling   address_group   BigTap   blackbird    


	
T2.1 Ipv4 prefix list optimization
     Config number of ipv4 entries        G_1     10.0.0.0    0.0.0.1    255.255.255.255     8  
     Config bigtap policy                 P1    ${sw1_f1}     ${sw1_d1}	 
     Config ipv4 list src                 P1    "G_1"   10
     Config ipv4 list dst                 P1    "G_1"   20
     Sleep     ${medium}       
	 Verify optimized match    P1   2
     Verify switch entry       ${sw1}   2

	[Tags]   sanity    optimization    BigTap   blackbird    


T2.2 Ipv4 prefix list optimization and ip  
     Config number of ipv4 entries        G_1     10.0.0.128    0.0.0.1    255.255.255.255      8  
     Config bigtap policy                 P1    ${sw1_f1}     ${sw1_d1}	 
     Config ipv4 list src ip dst                P1    "G_1"   10     "110.111.111.0"   "255.255.255.0"  
     Config ipv4 list dst ip src                P1    "G_1"   20     "210.111.111.0"   "255.255.255.0"  
     Sleep     ${medium}       
	 Verify optimized match    P1   2
     Verify switch entry       ${sw1}   2

	[Tags]   sanity   optimization     BigTap   blackbird     

T2.3 Ipv4 prefix list and ip double optimizaton 
     log   Failed:BSC-4610
     Config number of ipv4 entries        G_1     10.0.0.0    0.0.0.1    255.255.255.255      8  
     Config bigtap policy                 P1    ${sw1_f1}     ${sw1_d1}	 
     Config ipv4 list src ip dst                P1    "G_1"   10     "110.111.111.0"   "255.255.255.255"  
     Config ipv4 list src ip dst                P1    "G_1"   20     "110.111.111.1"   "255.255.255.255"       
     Config ipv4 list dst ip src                P1    "G_1"   30     "210.111.111.0"   "255.255.255.255"  
     Config ipv4 list dst ip src                P1    "G_1"   40     "210.111.111.1"   "255.255.255.255"       
     Sleep     ${medium}       
	 Verify optimized match    P1     2
     Verify switch entry       ${sw1}   2

	[Tags]   feature   optimization     BigTap   blackbird       JIRA-BSC-4610



T2.4 Ipv6 prefix list optimization
     Config number of ipv6 entries        G_1      f001:100:0:0:0:0:0:0 	0:0:0:1:0:0:0:0	  ffff:ffff:ffff:ffff:0:0:0:0     32  
     Config bigtap policy                 P1    ${sw1_f1}     ${sw1_d1}	 
     Config ipv6 list src                 P1    "G_1"   10
     Config ipv6 list dst                 P1    "G_1"   20
     Sleep     ${medium}       
	 Verify optimized match    P1   2
     Verify switch entry       ${sw1}   2

	[Tags]   sanity     optimization   BigTap   blackbird    


T2.5 Ipv6 prefix list optimization and src address 
     Config number of ipv6 entries        G_1      f001:100:0:0:0:0:0:0 	0:0:0:1:0:0:0:0	  ffff:ffff:ffff:ffff:0:0:0:0       32  
     Config bigtap policy                 P1    ${sw1_f1}     ${sw1_d1}	 
     Config ipv6 list src ip dst                P1    "G_1"   10     "2222:123:1111:1234:0:0:0:0"   "ffff:ffff:ffff:ffff:0:0:0:0"  
     Config ipv6 list dst ip src                P1    "G_1"   20     "1111:123:2222:1234:0:0:0:0"   "ffff:ffff:ffff:ffff:0:0:0:0"  
     Sleep     ${medium}       
	 Verify optimized match    P1   2
     Verify switch entry       ${sw1}   2

	[Tags]   sanity     optimization   BigTap   blackbird    

T2.6 Ipv6 prefix list and ip double optimizaton 
     log   Failed:BSC-4610
     Config number of ipv6 entries        G_1      f001:100:0:0:0:0:0:0 	0:0:0:1:0:0:0:0	  ffff:ffff:ffff:ffff:0:0:0:0     8  
     Config bigtap policy                 P1    ${sw1_f1}     ${sw1_d1}	 
     Config ipv6 list src ip dst                P1    "G_1"   10     "2222:123:1111:0:0:0:0:0"   "ffff:ffff:ffff:ffff:0:0:0:0"  
     Config ipv6 list src ip dst                P1    "G_1"   20     "2222:123:1111:1:0:0:0:0"   "ffff:ffff:ffff:ffff:0:0:0:0"  
     Config ipv6 list dst ip src                P1    "G_1"   30     "1111:123:2222:0:0:0:0:0"   "ffff:ffff:ffff:ffff:0:0:0:0"  
     Config ipv6 list dst ip src                P1    "G_1"   40     "1111:123:2222:1:0:0:0:0"   "ffff:ffff:ffff:ffff:0:0:0:0"  
     Sleep     ${medium}       
	 Verify optimized match    P1     2
     Verify switch entry       ${sw1}   2

	[Tags]   feature   optimization    BigTap   blackbird      JIRA-BSC-4610


T2.7 Ipv4 single tcp udp vlan optimization
     Config bigtap policy                 P1    ${sw1_f1}     ${sw1_d1}	 
     Config ipv4 tcp src port range       P1    10     16    47
     Config ipv4 tcp dst port range       P1    20     128   255
     Config ipv4 udp src port range       P1    30     16    47
     Config ipv4 udp dst port range       P1    40     128   255
     Config ipv4 vlan range               P1    50     16    47
     Sleep     ${medium}       
	 Verify optimized match    P1        8
     Verify switch entry       ${sw1}      8

	[Tags]   sanity      optimization   BigTap   blackbird    


T2.8 Ipv6 tcp udp vlan single optimization
     Config bigtap policy                 P1    ${sw1_f1}     ${sw1_d1}	 
     Config ipv6 tcp src port range       P1    10     16    47
     Config ipv6 tcp dst port range       P1    20     128   255
     Config ipv6 udp src port range       P1    30     16    47
     Config ipv6 udp dst port range       P1    40     128   255
     Config ipv6 vlan range               P1    50     128   255
     Sleep     ${medium}       
	 Verify optimized match    P1     7
     Verify switch entry       ${sw1}   7

	[Tags]   sanity    optimization    BigTap   blackbird    

 
 T2.9 Ipv4/6 vlan tcp/udp single optimization
     Config bigtap policy              P1    ${sw1_f1}     ${sw1_d1}	 
     Config ipv4 vlan range + tcp      P1    10     16    47
     Config ipv6 vlan range + tcp      P1    20     128   255
     Config ipv4 vlan range + udp      P1    30     32    47
     Config ipv6 vlan range + udp      P1    40     256   511
     
     Sleep     ${medium}       
	 Verify optimized match    P1     5
     Verify switch entry       ${sw1}   5

	[Tags]   sanity    optimization    BigTap   blackbird    


 T2.10 Ipv4/6 vlan tcp/udp port range double optimization
     Config bigtap policy                      P1    ${sw1_f1}     ${sw1_d1}	 
     Config ipv4 vlan range + tcp s range      P1    10     1024    2047    4096   8191       
     Config ipv6 vlan range + tcp d range      P1    20     2048    4095    8192   16383    
     Config ipv4 vlan range + udp d range      P1    30     1024    2047    4096   8191    
     Config ipv6 vlan range + udp s range      P1    40     2048    4095    16384   32767
     
     Sleep     ${medium}       
	 Verify optimized match    P1     4
     Verify switch entry       ${sw1}   4

	[Tags]   feature      optimization    BigTap   blackbird    


 T2.11 Ipv4/6 ip list vlan tcp/udp port range triple optimization
     Config number of ipv4 entries        G1     10.0.0.0    0.0.0.1    255.255.255.255      16  
     Config number of ipv6 entries        G2      f001:100:0:0:0:0:0:0 	0:0:0:1:0:0:0:0	  ffff:ffff:ffff:ffff:0:0:0:0     8      
     Config bigtap policy                         P1    ${sw1_f1}     ${sw1_d1}	     
     Config ipv4 ip list src vlan range + tcp s range      P1   "G1"  10     1024    2047    4096   8191       
     Config ipv6 ip list src vlan range + tcp d range      P1   "G2"  20     2048    4095    8192   16383    
     Config ipv4 ip list src vlan range + udp d range      P1   "G1"  30     1024    2047    4096   8191    
     Config ipv6 ip list src vlan range + udp s range      P1   "G2"  40     2048    4095    16384   32767
 
     Config ipv4 ip list dst vlan range + tcp s range      P1   "G1"  110     1024    2047    4096   8191       
     Config ipv6 ip list dst vlan range + tcp d range      P1   "G2"  120     2048    4095    8192   16383    
     Config ipv4 ip list dst vlan range + udp d range      P1   "G1"  130     1024    2047    4096   8191    
     Config ipv6 ip list dst vlan range + udp s range      P1   "G2"  140     2048    4095    16384   32767
      
     Sleep     ${medium}       
	 Verify optimized match    P1     8
     Verify switch entry       ${sw1}   8

	[Tags]   feature      optimization   BigTap   blackbird    
  

 T2.12 Ipv4/6 ip list ip vlan tcp/udp port range triple optimization
     Config number of ipv4 entries        G1     10.0.0.0    0.0.0.1    255.255.255.255      16  
     Config number of ipv6 entries        G2      f001:100:0:0:0:0:0:0 	0:0:0:1:0:0:0:0	  ffff:ffff:ffff:ffff:0:0:0:0     8      
     Config bigtap policy                         P1    ${sw1_f1}     ${sw1_d1}	     
     Config ipv4 ip list src ip vlan range + tcp s range      P1   "G1"  10   ${bip}     ${bmask}   1024    2047    4096   8191       
     Config ipv6 ip list src ip vlan range + tcp d range      P1   "G2"  20   ${bip6}     ${bmask6}   2048    4095    8192   16383    
     Config ipv4 ip list src ip vlan range + udp d range      P1   "G1"  30   ${bip}     ${bmask}    1024    2047    4096   8191    
     Config ipv6 ip list src ip vlan range + udp s range      P1   "G2"  40   ${bip6}     ${bmask6}   2048    4095    16384   32767
 
     Config ipv4 ip list dst ip vlan range + tcp s range      P1   "G1"  110   ${bip}     ${bmask}   1024    2047    4096   8191       
     Config ipv6 ip list dst ip vlan range + tcp d range      P1   "G2"  120   ${bip6}     ${bmask6}   2048    4095    8192   16383    
     Config ipv4 ip list dst ip vlan range + udp d range      P1   "G1"  130   ${bip}     ${bmask}    1024    2047    4096   8191    
     Config ipv6 ip list dst ip vlan range + udp s range      P1   "G2"  140   ${bip6}     ${bmask6}   2048    4095    16384   32767
      
     Sleep     ${medium}       
	 Verify optimized match    P1     8
     Verify switch entry       ${sw1}   8

	[Tags]   feature    optimization    BigTap   blackbird    


 T2.11 Ipv4/6 prefix overlap entries optimization
     log    BT-786
     Config bigtap policy       P1    ${sw1_f1}     ${sw1_d1}	    
	 Config ipv4 src       P1	  10   "110.111.111.10"   "255.255.255.255"  
  	 Config ipv4 src       P1	  15   "110.111.111.20"   "255.255.255.0"        

	 Config ipv4 dst       P1	  20   "110.111.111.10"   "255.255.255.255"  
  	 Config ipv4 dst       P1	  25   "110.111.111.20"   "255.255.254.0"        

	 Config ipv6 dst       P1	  30    "2222:123:1111:0:0:0:0:0"   "ffff:ffff:ffff:ffff:0:0:0:0"  
  	 Config ipv6 dst       P1	  35    "2222:123:1111:50:0:0:0:0"  "ffff:ffff:ffff:0:0:0:0:0"         

	 Config ipv6 src       P1	  40    "2222:123:1111:20:0:0:0:0"   "ffff:ffff:ffff:ffff:0:0:0:0"  
  	 Config ipv6 src       P1	  45    "2222:123:1111:50:0:0:0:0"  "ffff:ffff:ffff:0:0:0:0:0"         
     Sleep     ${medium}       
	 Verify optimized match    P1     4
     Verify switch entry       ${sw1}   4

  
     Config ipv4 tcp any    P1	  100    
     Config ipv4 udp any    P1	  110
     Config ipv4 any     P1	  120    
     Config ipv6 any     P1	  200    
     Config ipv6 tcp any    P1	  210
     Config ipv6 udp any     P1	  220    
         
     Sleep     ${medium}       
	 Verify optimized match    P1     2
     Verify switch entry       ${sw1}   2

	[Tags]   feature    optimization    BigTap   blackbird       JIRA-BT-786




T2.101 Ipv4 prefix list optimization scale
     Config number of ipv4 entries        G1     10.0.0.0    0.0.0.1    255.255.255.255    512
     Config bigtap policy                 P1    ${sw1_f1}     ${sw1_d1}	 
     Config ipv4 list src                 P1    "G1"   10
     Config ipv4 list dst                 P1    "G1"   20
     Sleep     ${medium}       
	 Verify optimized match    P1   2
     Verify switch entry       ${sw1}   2

	[Tags]   scaling    optimization    BigTap   blackbird    
	
T2.102 Ipv6 prefix list optimization scale
     Config number of ipv6 entries        G1      f001:100:0:0:0:0:0:0 	0:0:0:1:0:0:0:0	  ffff:ffff:ffff:ffff:0:0:0:0     512  
     Config bigtap policy                 P1    ${sw1_f1}     ${sw1_d1}	 
     Config ipv6 list src                 P1    "G1"   10
     Config ipv6 list dst                 P1    "G1"   20
     Sleep     ${medium}       
	 Verify optimized match    P1   2
     Verify switch entry       ${sw1}   2

	[Tags]   scaling  optimization   BigTap   blackbird    


T3.1 Default l3-l4: Test ipv4/6 group and optimization 
    Verify L3-l4 config         False
    Verify l3-l4 mode controler and tcam    False   ${sw1}
 	Testcase T1.3 Address group IPv4/IPv6     ${sw1}     ${sw1_f1}     ${sw1_d1}
	bigtap delete all 
 	Testcase T2.1 Ipv4 prefix list optimization   ${sw1}     ${sw1_f1}     ${sw1_d1}		
	bigtap delete all 
	Testcase T2.4 Ipv6 prefix list optimization      ${sw1}     ${sw1_f1}     ${sw1_d1}		

	[Tags]  sanity  l3_l4   BigTap   blackbird_1    


T3.2 Enable l3-l4: Test ipv4/6 group and optimization 
    rest enable feature       l3-l4-mode
    Sleep	                   ${short}
    Verify l3-l4 mode controler and tcam    True   ${sw1}  
	Testcase T1.3 Address group IPv4/IPv6     ${sw1}     ${sw1_f1}     ${sw1_d1}
	bigtap delete all 
	Testcase T2.1 Ipv4 prefix list optimization     ${sw1}     ${sw1_f1}     ${sw1_d1}
	bigtap delete all 
	Testcase T2.4 Ipv6 prefix list optimization      ${sw1}     ${sw1_f1}     ${sw1_d1}		
	 
	[Tags]  sanity  l3_l4   BigTap   blackbird_1    


T3.3 Change l3-l4 with policy with no mac configured
    Verify L3-l4 config       				False
    Verify l3-l4 mode controler and tcam    False   ${sw1}  
	Testcase T1.3 Address group IPv4/IPv6     ${sw1}     ${sw1_f1}     ${sw1_d1} 
    ${Flow1}=   rest_show_switch_flow       ${sw1}	

	rest enable feature                    l3-l4-mode
    Sleep	                                ${short}
    Verify l3-l4 mode controler and tcam    True   ${sw1}  
    ${Flow2}=   rest_show_switch_flow       ${sw1}	
    Should Be Equal As Integers            ${Flow1}    ${Flow2}
 
    rest_disable_feature                   l3-l4-mode 
    Sleep	                                ${short}   
    Verify l3-l4 mode controler and tcam    False   ${sw1}      
    ${Flow3}=   rest_show_switch_flow       ${sw1}	    
    Should Be Equal As Integers            ${Flow1}    ${Flow3}
  
   [Tags]  sanity  l3_l4   BigTap   blackbird_1     


T3.4 ipv4 mac can be configured/not configured correctly  
    Verify L3-l4 config       				False
    Verify l3-l4 mode controler and tcam    False   ${sw1}  
    Config bigtap policy                 P1    ${sw1_f1}     ${sw1_d1}	    
    Config ipv4 mac+ ip src + dst + vlan range + tcp dsts port range    P1   10  "11:11:11:11:11:11"  "22:22:22:22:22:22"  "111.111.111.0"  "255.255.255.0"   11  12   51  52
    Config ipv4 mac+ ip src + dst + vlan range + tcp dsts + src         P1   20  "11:11:11:11:11:11"  "22:22:22:22:22:22"  "111.111.111.0"  "255.255.255.0"   21  22   100  200
    Config ipv4 any                     P1    30
    Sleep	                               ${medium} 
    Verify switch entry                    ${sw1}	 7    
     
    ${result}=   rest_enable_feature      l3-l4-mode 
    Should not be True                    ${result}     
  
    rest_delete_policy_match       admin-view   P1   10  
    rest_delete_policy_match       admin-view   P1   20  

    ${result}=   rest_enable_feature    l3-l4-mode 
    Should be True                      ${result}     
    
   [Tags]  feature   l3_l4   BigTap   blackbird_1   



T3.5 ipv6 mac can be configured/not configured correctly  
    Verify L3-l4 config       				False
    Verify l3-l4 mode controler and tcam    False   ${sw1}  
    Config bigtap policy                  P1    ${sw1_f1}     ${sw1_d1}	    
    Config ipv6 mac all negative          P1   30     "11:11:11:11:11:11"  "22:22:22:22:22:22" 
    Config ipv6 any                       P1   10
    Config ipv6 tcp any                   P1   20
    Config ipv6 udp any                   P1   25   
    
    Sleep	                                ${short} 
    Verify switch entry                    ${sw1}	 3    
     
    ${result}=   rest_enable_feature      l3-l4-mode 
    Should be True                    ${result}     
 
    Config ipv6 mac all negative          P1   30     "11:11:11:11:11:11"  "22:22:22:22:22:22"      
    Sleep	                              ${short} 
    Verify switch entry                   ${sw1}	 3    
  
    ${result}=   rest_enable_feature    l3-l4-mode 
    Should be True                      ${result}     
    Config ipv6 mac all negative         P1   30     "11:11:11:11:11:11"  "22:22:22:22:22:22" 
    Sleep	                            ${short} 
    Verify switch entry                 ${sw1}	   3    
 
    
   [Tags]  feature   l3_l4   BigTap   blackbird_1     




T5.1 feature integration: l3_l4 & trackhost BT-1144  
    Verify L3-l4 config       				False
    Verify l3-l4 mode controler and tcam    False   ${sw1}  
    ${result}=   rest_enable_feature        tracked-host  
    Sleep	                               ${medium} 
	Verify trackhost config                 True     
    Config bigtap policy                    P1    ${sw1_f1}     ${sw1_d1}	    
    Config number of ipv4 entries           G1     10.0.0.0          0.1.0.2         255.255.255.254      10 
	Config ipv4 list src                    P1    "G1" 	  10
    Sleep	                                ${short} 
    Verify switch entry                     ${sw1}	 11         
    ${result}=   rest_enable_feature       l3-l4-mode 
    Should be True                         ${result}     
    Verify switch entry                    ${sw1}	11    
    ${result}=   rest_disable_feature       tracked-host 
    Sleep	                               ${medium}     
    Verify switch entry                     ${sw1}	10         
    ${result}=   rest_disable_feature       l3-l4-mode  
    Sleep	                               ${medium}    
    Verify switch entry                     ${sw1}	10         
   
   [Tags]  sanity  l3_l4   BigTap   blackbird_1     

 
 
 	 

T4.1 default config tcam size ipv4 only  
    Verify L3-l4 config                     False
    Verify l3-l4 mode controler and tcam    False   ${sw1}
    Config bigtap policy                    P1      ${sw1_f1}     ${sw1_d1}     
    ${Flow}=   verify_switch_tcam_limitaion 	  ${sw1}   P1   ipv4
    Log     TheFlow entries are: ${Flow}
    Log to file    Tcam_size   "default config tcam size ipv4 only"    ${sw1}     	
      
	[Tags]  scaling   BigTap     skipped

T4.2 default config tcam size ipv6 only  
    Verify L3-l4 config                     False
    Verify l3-l4 mode controler and tcam    False   ${sw1}
    Config bigtap policy                    P1      ${sw1_f1}     ${sw1_d1}     
    ${flow}=   verify_switch_tcam_limitaion 	  ${sw1}   P1   ipv6
    Log     The Flow entries are: ${Flow}	
    Log to file    Tcam_size   "default config tcam size ipv6 only"    ${sw1}            	 
	[Tags]  scaling   BigTap      skipped

T4.3 default config tcam size mixed   
    Verify L3-l4 config                     False
    Verify l3-l4 mode controler and tcam    False   ${sw1}
    Config bigtap policy                    P1      ${sw1_f1}     ${sw1_d1}     
    ${Flow}=   verify_switch_tcam_limitaion 	  ${sw1}   P1   mixed
    Log     The Flow entries are: ${Flow}	     	 
    Log to file    Tcam_size   "default config tcam size ipv6 only"    ${sw1}        
	[Tags]  scaling   BigTap      skipped


T4.4 l3-l4 mode tcam size ipv4 only  
    ${result}=   rest_enable_feature      l3-l4-mode 
    Sleep	                               ${medium} 
    Should be True                         ${result}     
    Verify L3-l4 config                     True
    Verify l3-l4 mode controler and tcam    True   ${sw1}
    Config bigtap policy                    P1      ${sw1_f1}     ${sw1_d1}     
    ${Flow}=   verify_switch_tcam_limitaion 	  ${sw1}   P1   ipv4
    Log     The Flow entries are: ${Flow}	     	  
    Log to file    Tcam_size   "l3-l4 mode tcam size ipv4 only"    ${sw1}      
	[Tags]  scaling   BigTap     skipped
	
T4.5 l3-l4 mode tcam size ipv6 only  
    ${result}=   rest_enable_feature      l3-l4-mode 
    Sleep	                               ${medium} 
    Should be True                    ${result}     
    Verify L3-l4 config                     True
    Verify l3-l4 mode controler and tcam    True   ${sw1}
    Config bigtap policy                    P1      ${sw1_f1}     ${sw1_d1}     
    ${Flow}=   verify_switch_tcam_limitaion 	  ${sw1}   P1   ipv6
    Log     The Flow entries are: ${Flow}	     	 
    Log to file    Tcam_size   "l3-l4 mode tcam size ipv6 only"    ${sw1}      
	[Tags]  scaling   BigTap       skipped 


T4.6 l3-l4 mode tcam size mixed  
    ${result}=   rest_enable_feature      l3-l4-mode 
    Sleep	                               ${medium} 
    Should be True                        ${result}     
    Verify L3-l4 config                     True
    Verify l3-l4 mode controler and tcam    True   ${sw1}
    Config bigtap policy                    P1      ${sw1_f1}     ${sw1_d1}     
    ${Flow}=   verify_switch_tcam_limitaion 	  ${sw1}   P1   mixed
    Log     The Flow entries are: ${Flow}	     
    Log to file    Tcam_size   "l3-l4 mode tcam size mixed "    ${sw1}           	 
	[Tags]  scaling   BigTap        skipped
	
	
	
	
  