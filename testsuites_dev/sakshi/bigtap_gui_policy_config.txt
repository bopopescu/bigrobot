*** Settings ***
Documentation   	A test suite with a single test for valid login. This test has
...             	a workflow that is created using keywords from the resource file.
Force Tags      	GUI RBAC
Suite Setup      	Setup
Suite Teardown   	Teardown
Library         	keywords/BsnCommon.py
Library         	keywords_dev/tomasz/BigTap.py
Library        		SeleniumLibrary
Resource        	bigtap_resource.txt
Library       		String

*** Test Cases *** 
 	
### Configure Big Tap Policy with different names	
T1 Test set up:
	Configure Big Tap Interface from Big Tap Menu			ethernet1			qa-corsair-1		filter			ixia-2-9
	Configure Big Tap Interface from Big Tap Menu			ethernet1			qa-corsair-2 		delivery		ixia-2-15	
	Configure Big Tap Interface from Big Tap Menu			ethernet2			qa-corsair-2 		delivery		ixia-4-8	
	Configure Big Tap Interface Group from Big Tap Menu 	filter				filter-group		ixia-2-9
	Configure Big Tap Interface Group from Big Tap Menu		delivery			delivery-group		ixia-2-15	
	
#Arguments												Policy	 				RBAC 			Action 			Filter			Delivery 		fg				dg	
T1.1 Policy with policy name as alphabets
	Configure Big Tap Policy					 		testpolicy				admin-view		Forward			ixia-2-9		ixia-2-15	  	 ${EMPTY}	  	${EMPTY}
T1.2 Policy with policy name as alphanumeric
	Configure Big Tap Policy					 		testpolicy22			admin-view		Forward			ixia-2-9		ixia-2-15	  	${EMPTY}	  ${EMPTY}	  	
T1.3 Policy with policy name as hypen in between
	Configure Big Tap Policy					 		test-policy3			admin-view		Forward			ixia-2-9		ixia-4-8	  	${EMPTY}	  ${EMPTY}	  	
T1.4 Policy with policy name as "_" in between
	Configure Big Tap Policy					 		test_policy4			admin-view		Forward			ixia-2-9		ixia-4-8	  	${EMPTY}	  ${EMPTY}	  	
T1.5 Policy with policy name as all CAPS
	Configure Big Tap Policy					 		TESTPOLICY5				admin-view		Forward			ixia-2-9		ixia-4-8	  	${EMPTY}	  ${EMPTY}	  	
#T1.6 Policy with new rbac                
#	Configure Big Tap Policy					 		test-policy6			__new__			Forward			ixia-2-9		ixia-2-15	  	${EMPTY}	  ${EMPTY}	  	
T1.7 Policy with interfaces and interface groups
	Configure Big Tap Policy					 		tesT-p0licy7			admin-view		Forward			ixia-2-9		ixia-2-15		filter-group	delivery-group	
T1.8 Teardown
	Delete All Big Tap Policies


##Change action

T2.1 Create Policy
	Configure Big Tap Policy					 	test-policy		admin-view		Forward			ixia-2-9		ixia-2-15		${EMPTY}		${EMPTY}	 
T2.2 Change action from forward to inactive
	Change Policy Action					 		test-policy		Inactive				
T2.3 Change action from inactive to capture
	Change Policy Action					 		test-policy		Capture					
T2.4 Change action from capture to rate-measure
	Change Policy Action					 		test-policy		Rate Measure			
T2.5 Change action from rate-measure to forward
	Change Policy Action					 		test-policy		Forward			
T2.6 Teardown
	Delete All Big Tap Policies
	

##Scheduling									Policy	 		Action		Start Policy	AfterDelayOfTime	Run Policy		Duration		Packets

TC3.1 Create Policy
	Configure Big Tap Policy					test-policy1		admin-view			Forward			ixia-2-9		ixia-2-15		${EMPTY}		${EMPTY}	 
T3.2 Schedule policy to start now and run always  
	Schedule Big Tap Policy					 	test-policy1		Forward		Immediately			${EMPTY}			Always			${EMPTY}		${EMPTY}
T3.3 Schedule policy to start now and run for 5 minutes
	Schedule Big Tap Policy				 		test-policy1		Forward		Immediately			${EMPTY}			For Duration	5				${EMPTY}	
T3.4 Schedule policy to start now, run for 15 minutes or until 5000 packets are delivered
	Schedule Big Tap Policy					 	test-policy1		Forward		Immediately			${EMPTY}			For Duration	15				5000			
T3.5 Schedule policy to start after a delay of 5 minutes and run for 5 minutes 
	Schedule Big Tap Policy					 	test-policy1		Forward		After Delay Of		5					For Duration	5				${EMPTY}				
T3.6 Schedule policy to start after a delay of 10 minutes and run for 2 minutes 
	Schedule Big Tap Policy				 		test-policy1		Forward		After Delay Of		10					For Duration	2				${EMPTY}
T3.7 Schedule policy to start after a delay of 15 minutes, run for 10 minute(s) or until 10000 packets are delivered
	Schedule Big Tap Policy					 	test-policy1		Forward		After Delay Of		15					For Duration	10				10000		
T3.8 Teardown
	Delete All Big Tap Policies
	

##Associate Rules

T4.1 Create Policy
	Configure Big Tap Policy					 		test-policy		admin-view		Forward			ixia-2-9		ixia-2-15		${EMPTY}		${EMPTY}	 
T4.2 Change action from forward to inactive
	Associate Policy Match Rule					 		test-policy		IPv4 - 0x800 (2048)		UDP (17)		
T4.3 Change action from inactive to capture
	Associate Policy Match Rule					 		test-policy		IPv4 - 0x800 (2048)		TCP (6)			
T4.4 Change action from capture to rate-measure
	Associate Policy Match Rule					 		test-policy		IPv4 - 0x800 (2048)		SCTP (132)	
T4.5 Change action from rate-measure to forward
	Associate Policy Match Rule					 		test-policy		IPv4 - 0x800 (2048)		ICMP (1)	
T4.6 Change action from forward to inactive
	Associate Policy Match Rule					 		test-policy		IPv6 - 0x86DD (34525)	UDP (17)		
T4.7 Change action from inactive to capture
	Associate Policy Match Rule					 		test-policy		IPv6 - 0x86DD (34525)	TCP (6)			
T4.8 Change action from capture to rate-measure
	Associate Policy Match Rule					 		test-policy		IPv6 - 0x86DD (34525)	SCTP (132)	
T4.9 Change action from rate-measure to forward
	Associate Policy Match Rule					 		test-policy		IPv6 - 0x86DD (34525)	ICMP (1)
T4.10 Change action from forward to inactive
	Associate Policy Match Rule					 		test-policy		ARP - 0x806 (2054)		${EMPTY}			
T4.14 Teardown
	Delete All Big Tap Policies






## Policy Overlap
#T5 Test set up:	
#	Configure Match Mode								Policy Overlap
#T5.1 Create Policy
#	Configure Big Tap Policy					 olap-policy1		admin-view		Forward			ixia-2-9		ixia-2-15		${EMPTY}		${EMPTY}	 
# 	Associate DPM Rule							 olap-policy1		UDP (17)     	Offset: 8		20000000		e0000000  		${EMPTY}		${EMPTY}	${EMPTY}	${EMPTY}	${EMPTY}	${EMPTY}	${EMPTY}	${EMPTY}	${EMPTY}	3386		${EMPTY}

#	Configure Big Tap Policy					 olap-policy2		admin-view		Forward			ixia-2-9		ixia-4-8		${EMPTY}		${EMPTY}	 
#  	Associate DPM Rule							 olap-policy2		UDP (17)     	${EMPTY}		${EMPTY}		${EMPTY}		${EMPTY}		${EMPTY}	${EMPTY}  	${EMPTY}	${EMPTY}	${EMPTY}	${EMPTY}	${EMPTY}	${EMPTY}	${EMPTY}	${EMPTY}
#	Check Overlapping							 olap-policy1		olap-policy2

#T5.2 Create Policy
#	Configure Big Tap Policy					 olap-policy3		admin-view		Forward			ixia-2-9		ixia-2-15		${EMPTY}		${EMPTY}	 
#  	Associate DPM Rule							 olap-policy3		UDP (17)     	Offset: 8		40000000		e0000000  		${EMPTY}		${EMPTY}	${EMPTY}	${EMPTY}	${EMPTY}	${EMPTY}	${EMPTY}	${EMPTY}	${EMPTY}	2123		${EMPTY}

#	Configure Big Tap Policy					 olap-policy4		admin-view		Forward			ixia-2-9		ixia-4-8		${EMPTY}		${EMPTY}	 
#	Associate DPM Rule							 olap-policy4		UDP (17)     	${EMPTY}		${EMPTY}		${EMPTY}		${EMPTY}		${EMPTY}	${EMPTY}  	${EMPTY}	${EMPTY}	${EMPTY}	${EMPTY}	${EMPTY}	${EMPTY}	${EMPTY}	${EMPTY}
#	Check Overlapping							 olap-policy3		olap-policy4

#T5.3 TearDown
#	Configure Match Mode								!Policy Overlap	



	
*** Keywords ***
Setup
	base suite setup
	${c1_ip}            params  node=c1  key=ip
    set suite variable  ${SERVER}  ${c1_ip}:8443
    Set URLs
    #Start Selenium Server  -trustAllSSLCertificates
    CLI Start Mininet Server  tree,3
    #Rest Open GUI Port
    Open Browser To Login Page
    Valid Login  admin  adminadmin
    Delete All Big Tap Resources
Teardown
	Close Browser
    #Stop Selenium Server
    base suite teardown

