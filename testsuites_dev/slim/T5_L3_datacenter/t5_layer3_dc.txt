* Setting
Documentation   T5 Basic L3 two spine three leaf rack with dual-tor Test Suite in datacenter
Suite Setup     T5 base suite setup
Suite Teardown  T5 base suite teardown
Test Setup      setup topology
Test Teardown   teardown topology
Force Tags      T5 Sanity
Library         keywords/Host.py
Library         keywords/BsnCommon.py
Library         keywords/T5.py
Library         keywords/T5L3.py
Library         keywords/T5Platform.py
Library         keywords/BsnCommon.py
Library         keywords/SwitchLight.py
Library	        Collections.py
Library         keywords/Ixia.py
Library         keywords/Host.py
Resource		testsuites_dev/slim/T5_L3_datacenter/t5_layer3_dc_variables.txt
Resource		testsuites_dev/slim/T5_L3_datacenter/t5_layer3_dc_resources.txt


* Test Cases
L3 intra tenant same rack untagged with dynamic endpoints via dhcp-relay
	L3 intra tenant same rack untagged with dynamic endpoints via dhcp-relay
	[Tags]									smoke				sanity				run1

L3 intra tenant across rack untagged with dynamic endpoints via dhcp-relay
    L3 intra tenant across rack untagged with dynamic endpoints via dhcp-relay
    [Tags]                                  smoke               sanity              run2

L3 intra tenant same rack tagged with dynamic endpoints via dhcp-relay
    L3 intra tenant same rack tagged with dynamic endpoints via dhcp-relay
    [Tags]                                  smoke               sanity              run3
    
L3 intra tenant across rack tagged with dynamic endpoints via dhcp-relay
    L3 intra tenant across rack tagged with dynamic endpoints via dhcp-relay   
    [Tags]                                  smoke               sanity              run4

L3 inter tenant same rack untagged with dynamic endpoints via dhcp-relay
    L3 intra tenant same rack untagged with dynamic endpoints via dhcp-relay
    [Tags]                                  smoke               sanity              run5

L3 inter tenant across rack untagged with dynamic endpoints via dhcp-relay
    L3 intra tenant across rack untagged with dynamic endpoints via dhcp-relay
    [Tags]                                  smoke               sanity              run6

L3 inter tenant same rack tagged with dynamic endpoints via dhcp-relay
    L3 intra tenant same rack tagged with dynamic endpoints via dhcp-relay
    [Tags]                                  smoke               sanity              run7
    
L3 inter tenant across rack tagged with dynamic endpoints via dhcp-relay
    L3 intra tenant across rack tagged with dynamic endpoints via dhcp-relay   
    [Tags]                                  smoke               sanity              run8
    
L3 intra tenant 16 hop ecmp group in same rack
    L3 intra tenant 16 hop ecmp group in same rack
    [Tags]                                  smoke               sanity              run9
    
L3 inter tenant 16 hop ecmp group in same rack
    L3 inter tenant 16 hop ecmp group in same rack
    [Tags]                                  smoke               sanity              run10

Verify L3 intra tenant ecmp group prefer local rack than remote rack
    Verify L3 intra tenant ecmp group prefer local rack than remote rack
    [Tags]                                  smoke               sanity              run11
    
Verify L3 intra tenant with no nexthop is dropped
    Verify L3 intra tenant with no nexthop is dropped
    [Tags]                                  smoke               sanity              run12
    
Add and delete nexthop members to nexthop group
    Add and delete nexthop members to nexthop group
    [Tags]                                  smoke               sanity              run13
            
L3 inter tenant add nexthop ip to 16 nexthop group
    L3 inter tenant add nexthop ip to 16 nexthop group
    [Tags]                                  smoke               sanity              run14
  
Add and delete config changes
    Add and delete config changes
    [Tags]                                  smoke               sanity              run15
  
    
More specific route for L3 inter tenant traffic to external host
    More specific route for L3 inter tenant traffic to external host
    [Tags]                                  smoke               sanity              run88
    
Controller HA failover with L3 intra tenant across rack tagged with dhcp-relay
    Controller HA failover with L3 intra tenant across rack tagged with dhcp-relay
    [Tags]                                  smoke               sanity              run100
    
    
Controller HA failover with L3 inter tenant across rack tagged with dhcp-relay
    Controller HA failover with L3 inter tenant across rack tagged with dhcp-relay
    [Tags]                                  smoke               sanity              run101
    
    
            
        
* Keywords
L3 intra tenant same rack untagged with dynamic endpoints via dhcp-relay
    ${value} =                                  REST enable endpoint flap protection
    Log                                         ${value}
    REST add portgroup to vns                   X                               X1                              leaf0-pc1           -1
    REST add portgroup to vns                   X                               X2                              leaf0-pc2           -1   
    REST add dhcp relay                         X                               X2                              10.251.1.9
    REST add dhcprelay circuitid                X                               X2                              10.251.1.9              private vns X2
    sleep                                       1
    ${result} =                                 REST show forwarding dhcp table
    REST get l3 cidr route info                 10.251.1.0                      255.255.255.0
    ${circuitid} =                              Set Variable                    ${result[0]['circuit-id']}
    ${dhcpip} =                                 Set Variable                    ${result[0]['dhcp-ip']}
    ${routerip} =                               Set Variable                    ${result[0]['router-ip']}
    Should Be Equal                             ${circuitid}                    private vns X2
    Should Be Equal                             ${dhcpip}                       10.251.1.9
    Should Be Equal                             ${routerip}                     10.251.2.1
    BASH ifup intf                              h1-rack0                        bond0
    BASH ifup intf                              h2-rack0                        bond0
    BASH ifconfig ip address                    h1-rack0                        10.251.1.9/24           bond0
    sleep                                       1
    BASH start service                          h1-rack0                        isc-dhcp-server
    ${value} =                                  BASH check service status       h1-rack0                        isc-dhcp-server    
    BASH add route                              h1-rack0                        10.251.2.0/24           10.251.1.1
    BASH add route                              h1-rack0                        10.251.3.0/24           10.251.1.1
    sleep                                       1
    ${value} =                                  BASH release dhcpv4 address     h2-rack0                bond0
    Should Be True                              ${value}
    sleep                                       1
    ${ipAddr} =                                 BASH renew dhcpv4 address       h2-rack0                bond0
    Should Not Be Empty                         ${ipAddr}
    sleep                                       1
    BASH ping                                   h1-rack0                        ${ipAddr}               count=10
    ${value} =                                  BASH verify arp                 h1-rack0                10.251.1.1
    Should Be True                              ${value}        
    ${value} =                                  BASH verify arp                 h2-rack0                10.251.2.1
    Should Be True                              ${value}    
    ${mac1} =                                   BASH get intf mac               h1-rack0                      bond0
    ${result} =                                 REST show endpoints mac         ${mac1}
    Should Be True                              ${result}                       
    ${mac2} =                                   BASH get intf mac               h2-rack0                      bond0
    ${result} =                                 REST show endpoints mac         ${mac2}
    Should Be True                              ${result}                       
    ${loss} =                                   BASH ping                       h1-rack0                      ${ipAddr}           count=10
    Should Be True                              ${loss} == 0    
    

L3 intra tenant across rack untagged with dynamic endpoints via dhcp-relay
    REST add portgroup to vns                   X                               X1          leaf0-pc1           -1
    REST add portgroup to vns                   X                               X2          leaf1-pc2           -1   
    REST add dhcp relay                         X                               X2                      10.251.1.9
    REST add dhcprelay circuitid                X                               X2                      10.251.1.9              private vns X2
    sleep                                       1
    ${result} =                                 REST show forwarding dhcp table
    ${circuitid} =                              Set Variable                    ${result[0]['circuit-id']}
    ${dhcpip} =                                 Set Variable                    ${result[0]['dhcp-ip']}
    ${routerip} =                               Set Variable                    ${result[0]['router-ip']}
    Should Be Equal                             ${circuitid}                    private vns X2
    Should Be Equal                             ${dhcpip}                       10.251.1.9
    Should Be Equal                             ${routerip}                     10.251.2.1
    BASH ifup intf                              h1-rack0                        bond0
    BASH ifup intf                              h2-rack1                        bond0
    BASH ifconfig ip address                    h1-rack0                        10.251.1.9/24           bond0
    sleep                                       1
    BASH add route                              h1-rack0                        10.251.2.0/24           10.251.1.1
    BASH add route                              h1-rack0                        10.251.3.0/24           10.251.1.1
    BASH start service                          h1-rack0                        isc-dhcp-server
    ${value} =                                  BASH check service status       h1-rack0                        isc-dhcp-server    
    sleep                                       1
    ${value} =                                  BASH release dhcpv4 address     h2-rack1                bond0
    Should Be True                              ${value}
    sleep                                       1
    ${ipAddr} =                                 BASH renew dhcpv4 address       h2-rack1                bond0
    Should Not Be Empty                         ${ipAddr}
    sleep                                       1
    BASH ping                                   h1-rack0                        ${ipAddr}               count=10
    ${value} =                                  BASH verify arp                 h1-rack0                10.251.1.1
    Should Be True                              ${value}        
    ${value} =                                  BASH verify arp                 h2-rack1                10.251.2.1
    Should Be True                              ${value}    
    ${mac1} =                                   BASH get intf mac               h1-rack0                      bond0
    ${result} =                                 REST show endpoints mac         ${mac1}
    Should Be True                              ${result}                       
    ${mac2} =                                   BASH get intf mac               h2-rack1                      bond0
    ${result} =                                 REST show endpoints mac         ${mac2}
    Should Be True                              ${result}                       
    ${loss} =                                   BASH ping                       h1-rack0                      ${ipAddr}           count=10
    Should Be True                              ${loss} == 0    

L3 intra tenant same rack tagged with dynamic endpoints via dhcp-relay
    ${value} =                                  REST enable endpoint flap protection
    Log                                         ${value}
    REST add portgroup to vns                   X                               X1                      leaf0-pc1               1001
    REST add portgroup to vns                   X                               X2                      leaf0-pc2               1002 
    REST add dhcp relay                         X                               X2                      10.251.1.9
    REST add dhcprelay circuitid                X                               X2                      10.251.1.9              private vns X2
    sleep                                       1
    ${result} =                                 REST show forwarding dhcp table
    ${circuitid} =                              Set Variable                    ${result[0]['circuit-id']}
    ${dhcpip} =                                 Set Variable                    ${result[0]['dhcp-ip']}
    ${routerip} =                               Set Variable                    ${result[0]['router-ip']}
    Should Be Equal                             ${circuitid}                    private vns X2
    Should Be Equal                             ${dhcpip}                       10.251.1.9
    Should Be Equal                             ${routerip}                     10.251.2.1
    BASH add tag                                h1-rack0                        bond0                   1001
    BASH add tag                                h2-rack0                        bond0                   1002
    BASH ifup intf                              h1-rack0                        bond0.1001
    BASH ifup intf                              h2-rack0                        bond0.1002
    BASH ifconfig ip address                    h1-rack0                        10.251.1.9/24           bond0.1001
    BASH start service                          h1-rack0                        isc-dhcp-server
    ${value} =                                  BASH check service status       h1-rack0                        isc-dhcp-server    
    sleep                                       1
    BASH add route                              h1-rack0                        10.251.2.0/24           10.251.1.1
    BASH add route                              h1-rack0                        10.251.3.0/24           10.251.1.1
    sleep                                       1
    ${value} =                                  BASH release dhcpv4 address     h2-rack0                bond0.1002
    Should Be True                              ${value}
    sleep                                       1
    ${ipAddr} =                                 BASH renew dhcpv4 address       h2-rack0                bond0.1002
    Should Not Be Empty                         ${ipAddr}
    sleep                                       1
    BASH ping                                   h1-rack0                        ${ipAddr}               count=10
    ${value} =                                  BASH verify arp                 h1-rack0                10.251.1.1
    Should Be True                              ${value}        
    ${value} =                                  BASH verify arp                 h2-rack0                10.251.2.1
    Should Be True                              ${value}    
    ${mac1} =                                   BASH get intf mac               h1-rack0                      bond0.1001
    ${result} =                                 REST show endpoints mac         ${mac1}
    Should Be True                              ${result}                       
    ${mac2} =                                   BASH get intf mac               h2-rack0                      bond0.1002
    ${result} =                                 REST show endpoints mac         ${mac2}
    Should Be True                              ${result}                       
    ${loss} =                                   BASH ping                       h1-rack0                      ${ipAddr}           count=10
    Should Be True                              ${loss} == 0    
    

L3 intra tenant across rack tagged with dynamic endpoints via dhcp-relay
    REST add portgroup to vns                   X                               X1          leaf0-pc1           1001
    REST add portgroup to vns                   X                               X2          leaf1-pc2           2002 
    REST add dhcp relay                         X                               X2                      10.251.1.9
    REST add dhcprelay circuitid                X                               X2                      10.251.1.9              private vns X2
    sleep                                       1
    ${result} =                                 REST show forwarding dhcp table
    ${circuitid} =                              Set Variable                    ${result[0]['circuit-id']}
    ${dhcpip} =                                 Set Variable                    ${result[0]['dhcp-ip']}
    ${routerip} =                               Set Variable                    ${result[0]['router-ip']}
    Should Be Equal                             ${circuitid}                    private vns X2
    Should Be Equal                             ${dhcpip}                       10.251.1.9
    Should Be Equal                             ${routerip}                     10.251.2.1
    BASH add tag                                h1-rack0                        bond0                   1001
    BASH add tag                                h2-rack1                        bond0                   2002
    BASH ifup intf                              h1-rack0                        bond0.1001
    BASH ifup intf                              h2-rack1                        bond0.2002
    BASH ifconfig ip address                    h1-rack0                        10.251.1.9/24           bond0.1001
    BASH start service                          h1-rack0                        isc-dhcp-server
    ${value} =                                  BASH check service status       h1-rack0                        isc-dhcp-server    
    sleep                                       1
    BASH add route                              h1-rack0                        10.251.2.0/24           10.251.1.1
    BASH add route                              h1-rack0                        10.251.3.0/24           10.251.1.1
    sleep                                       1
    ${value} =                                  BASH release dhcpv4 address     h2-rack1                bond0.2002
    Should Be True                              ${value}
    sleep                                       1
    ${ipAddr} =                                 BASH renew dhcpv4 address       h2-rack1                bond0.2002
    Should Not Be Empty                         ${ipAddr}
    sleep                                       1
    BASH ping                                   h1-rack0                        ${ipAddr}               count=10
    ${value} =                                  BASH verify arp                 h1-rack0                10.251.1.1
    Should Be True                              ${value}        
    ${value} =                                  BASH verify arp                 h2-rack1                10.251.2.1
    Should Be True                              ${value}    
    ${mac1} =                                   BASH get intf mac               h1-rack0                      bond0.1001
    ${result} =                                 REST show endpoints mac         ${mac1}
    Should Be True                              ${result}                       
    ${mac2} =                                   BASH get intf mac               h2-rack1                      bond0.2002
    ${result} =                                 REST show endpoints mac         ${mac2}
    Should Be True                              ${result}                       
    ${loss} =                                   BASH ping                       h1-rack0                      ${ipAddr}           count=10
    Should Be True                              ${loss} == 0    

L3 inter tenant same rack untagged with dynamic endpoints via dhcp-relay
    ${value} =                                  REST enable endpoint flap protection
    Log                                         ${value}
    REST add portgroup to vns                   X                               X1          leaf0-pc1           -1
    REST add portgroup to vns                   Y                               Y2          leaf0-pc2           -1   
    REST add dhcp relay                         Y                               Y2                      10.251.1.9
    REST add dhcprelay circuitid                Y                               Y2                      10.251.1.9              private vns Y2
    sleep                                       1
    ${result} =                                 REST show forwarding dhcp table
    ${circuitid} =                              Set Variable                    ${result[0]['circuit-id']}
    ${dhcpip} =                                 Set Variable                    ${result[0]['dhcp-ip']}
    ${routerip} =                               Set Variable                    ${result[0]['router-ip']}
    Should Be Equal                             ${circuitid}                    private vns Y2
    Should Be Equal                             ${dhcpip}                       10.251.1.9
    Should Be Equal                             ${routerip}                     10.252.2.1
    BASH ifup intf                              h1-rack0                        bond0
    BASH ifup intf                              h2-rack0                        bond0
    BASH ifconfig ip address                    h1-rack0                        10.251.1.9/24           bond0
    BASH start service                          h1-rack0                        isc-dhcp-server
    ${value} =                                  BASH check service status       h1-rack0                        isc-dhcp-server    
    sleep                                       1
    BASH add route                              h1-rack0                        10.252.0.0/16           10.251.1.1
    sleep                                       1
    ${value} =                                  BASH release dhcpv4 address     h2-rack0                bond0
    Should Be True                              ${value}
    sleep                                       1
    ${ipAddr} =                                 BASH renew dhcpv4 address       h2-rack0                bond0
    Should Not Be Empty                         ${ipAddr}
    sleep                                       1
    BASH ping                                   h1-rack0                        ${ipAddr}               count=10
    ${value} =                                  BASH verify arp                 h1-rack0                10.251.1.1
    Should Be True                              ${value}        
    ${value} =                                  BASH verify arp                 h2-rack0                10.252.2.1
    Should Be True                              ${value}    
    ${mac1} =                                   BASH get intf mac               h1-rack0                      bond0
    ${result} =                                 REST show endpoints mac         ${mac1}
    Should Be True                              ${result}                       
    ${mac2} =                                   BASH get intf mac               h2-rack0                      bond0
    ${result} =                                 REST show endpoints mac         ${mac2}
    Should Be True                              ${result}                       
    ${loss} =                                   BASH ping                       h1-rack0                      ${ipAddr}           count=10
    Should Be True                              ${loss} == 0    
    

L3 inter tenant across rack untagged with dynamic endpoints via dhcp-relay
    REST add portgroup to vns                   X                               X1                          leaf0-pc1           -1
    REST add portgroup to vns                   Y                               Y3                          leaf1-pc2           -1   
    REST add dhcp relay                         Y                               Y3                          10.251.1.9
    sleep                                       1
    ${result} =                                 REST show forwarding dhcp table
    ${dhcpip} =                                 Set Variable                    ${result[0]['dhcp-ip']}
    ${routerip} =                               Set Variable                    ${result[0]['router-ip']}
    Should Be Equal                             ${dhcpip}                       10.251.1.9
    Should Be Equal                             ${routerip}                     10.252.3.1
    BASH ifup intf                              h1-rack0                        bond0
    BASH ifup intf                              h2-rack1                        bond0
    BASH ifconfig ip address                    h1-rack0                        10.251.1.9/24               bond0
    BASH start service                          h1-rack0                        isc-dhcp-server
    ${value} =                                  BASH check service status       h1-rack0                        isc-dhcp-server    
    sleep                                       1
    BASH add route                              h1-rack0                        10.252.0.0/16               10.251.1.1
    sleep                                       1
    ${value} =                                  BASH release dhcpv4 address     h2-rack1                    bond0
    Should Be True                              ${value}
    sleep                                       1
    ${ipAddr} =                                 BASH renew dhcpv4 address       h2-rack1                    bond0
    Should Not Be Empty                         ${ipAddr}
    sleep                                       1
    BASH ping                                   h1-rack0                        ${ipAddr}                   count=10
    ${value} =                                  BASH verify arp                 h1-rack0                    10.251.1.1
    Should Be True                              ${value}        
    ${value} =                                  BASH verify arp                 h2-rack1                    10.252.3.1
    Should Be True                              ${value}    
    ${mac1} =                                   BASH get intf mac               h1-rack0                      bond0
    ${result} =                                 REST show endpoints mac         ${mac1}
    Should Be True                              ${result}                       
    ${mac2} =                                   BASH get intf mac               h2-rack1                      bond0
    ${result} =                                 REST show endpoints mac         ${mac2}
    Should Be True                              ${result}                       
    ${loss} =                                   BASH ping                       h1-rack0                      ${ipAddr}           count=10
    Should Be True                              ${loss} == 0    


L3 inter tenant same rack tagged with dynamic endpoints via dhcp-relay
    ${value} =                                  REST enable endpoint flap protection
    Log                                         ${value}
    REST add portgroup to vns                   X                               X1                      leaf0-pc1               1001
    REST add portgroup to vns                   Y                               Y2                      leaf0-pc2               1002 
    REST add dhcp relay                         Y                               Y2                      10.251.1.9
    REST add dhcprelay circuitid                Y                               Y2                      10.251.1.9              private vns Y2
    sleep                                       1
    ${result} =                                 REST show forwarding dhcp table
    ${circuitid} =                              Set Variable                    ${result[0]['circuit-id']}
    ${dhcpip} =                                 Set Variable                    ${result[0]['dhcp-ip']}
    ${routerip} =                               Set Variable                    ${result[0]['router-ip']}
    Should Be Equal                             ${circuitid}                    private vns Y2
    Should Be Equal                             ${dhcpip}                       10.251.1.9
    Should Be Equal                             ${routerip}                     10.251.2.1
    BASH add tag                                h1-rack0                        bond0                   1001
    BASH add tag                                h2-rack0                        bond0                   1002
    BASH ifup intf                              h1-rack0                        bond0.1001
    BASH ifup intf                              h2-rack0                        bond0.1002
    BASH ifconfig ip address                    h1-rack0                        10.251.1.9/24           bond0.1001
    BASH start service                          h1-rack0                        isc-dhcp-server
    ${value} =                                  BASH check service status       h1-rack0                        isc-dhcp-server    
    sleep                                       1
    BASH add route                              h1-rack0                        10.252.0.0/16           10.251.1.1
    sleep                                       1
    ${value} =                                  BASH release dhcpv4 address     h2-rack0                bond0.1002
    Should Be True                              ${value}
    sleep                                       1
    ${ipAddr} =                                 BASH renew dhcpv4 address       h2-rack0                bond0.1002
    Should Not Be Empty                         ${ipAddr}
    sleep                                       1
    BASH ping                                   h1-rack0                        ${ipAddr}               count=10
    ${value} =                                  BASH verify arp                 h1-rack0                10.251.1.1
    Should Be True                              ${value}        
    ${value} =                                  BASH verify arp                 h2-rack0                10.251.2.1
    Should Be True                              ${value}    
    ${mac1} =                                   BASH get intf mac               h1-rack0                      bond0.1001
    ${result} =                                 REST show endpoints mac         ${mac1}
    Should Be True                              ${result}                       
    ${mac2} =                                   BASH get intf mac               h2-rack0                      bond0.1002
    ${result} =                                 REST show endpoints mac         ${mac2}
    Should Be True                              ${result}                       
    ${loss} =                                   BASH ping                       h1-rack0                      ${ipAddr}           count=10
    Should Be True                              ${loss} == 0    
    

L3 inter tenant across rack tagged with dynamic endpoints via dhcp-relay
    REST add portgroup to vns                   X                               X1                      leaf0-pc1           1001
    REST add portgroup to vns                   Y                               Y3                      leaf1-pc2           2002 
    REST add dhcp relay                         Y                               Y3                      10.251.1.9
    sleep                                       1
    ${result} =                                 REST show forwarding dhcp table
    ${dhcpip} =                                 Set Variable                    ${result[0]['dhcp-ip']}
    ${routerip} =                               Set Variable                    ${result[0]['router-ip']}
    Should Be Equal                             ${dhcpip}                       10.251.1.9
    Should Be Equal                             ${routerip}                     10.252.3.1
    BASH add tag                                h1-rack0                        bond0                   1001
    BASH add tag                                h2-rack1                        bond0                   2002
    BASH ifup intf                              h1-rack0                        bond0.1001
    BASH ifup intf                              h2-rack1                        bond0.2002
    BASH ifconfig ip address                    h1-rack0                        10.251.1.9/24           bond0.1001
    BASH start service                          h1-rack0                        isc-dhcp-server
    ${value} =                                  BASH check service status       h1-rack0                        isc-dhcp-server    
    sleep                                       1
    BASH add route                              h1-rack0                        10.252.0.0/16           10.251.1.1
    sleep                                       1
    ${value} =                                  BASH release dhcpv4 address     h2-rack1                bond0.2002
    Should Be True                              ${value}
    sleep                                       1
    ${ipAddr} =                                 BASH renew dhcpv4 address       h2-rack1                bond0.2002
    Should Not Be Empty                         ${ipAddr}
    sleep                                       1
    BASH ping                                   h1-rack0                        ${ipAddr}               count=10
    ${value} =                                  BASH verify arp                 h1-rack0                10.251.1.1
    Should Be True                              ${value}        
    ${value} =                                  BASH verify arp                 h2-rack1                10.252.3.1
    Should Be True                              ${value}    
    ${mac1} =                                   BASH get intf mac               h1-rack0                      bond0.1001
    ${result} =                                 REST show endpoints mac         ${mac1}
    Should Be True                              ${result}                       
    ${mac2} =                                   BASH get intf mac               h2-rack1                      bond0.2002
    ${result} =                                 REST show endpoints mac         ${mac2}
    Should Be True                              ${result}                       
    ${loss} =                                   BASH ping                       h1-rack0                      ${ipAddr}           count=10
    Should Be True                              ${loss} == 0    

L3 intra tenant 16 hop ecmp group in same rack
    REST delete interface from vns                  Z                               Z192                    leaf2-a         ethernet33          -1   
    REST add interface to vns                       External                        External-Host           leaf2-a         ethernet33          -1
    sleep                                           1
    ${stream1}=                                     L3 add                          name=stream1            flow=g->a               frame_rate=100000           frame_size=128             frame_cnt=10000000000
    ...                                             src_ip=10.254.99.101            src_cnt=100             src_ip_step=0.0.0.1     src_gw=10.254.99.1          src_gw_step=0.0.0.0
    ...                                             dst_ip=10.99.255.101            dst_cnt=100             dst_ip_step=0.0.0.1     dst_gw=10.99.255.1          dst_gw_step=0.0.0.0

    sleep                                           1             
    start traffic                                   ${stream1}
    sleep                                           10
    stop traffic                                    ${stream1}
    sleep                                           1
    REST clear fabric interface stats
    sleep                                           1
    start traffic                                   ${stream1}
    sleep                                           5
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet33
    ${rx_33_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet35
    ${tx_35_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet36
    ${tx_36_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet37
    ${tx_37_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet38
    ${tx_38_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet39
    ${tx_39_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet40
    ${tx_40_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet41
    ${tx_41_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet42
    ${tx_42_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet47
    ${tx_47_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet48
    ${tx_48_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet49
    ${tx_49_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_49_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet50
    ${tx_50_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_50_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet35
    ${tx_35_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet36
    ${tx_36_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet37
    ${tx_37_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet38
    ${tx_38_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet39
    ${tx_39_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet40
    ${tx_40_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet41
    ${tx_41_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet42
    ${tx_42_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet47
    ${tx_47_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet48
    ${tx_48_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet49
    ${tx_49_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_49_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet50
    ${tx_50_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}    
    ${rx_50_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}    
    sleep                                           10
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet33
    ${rx_33_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet35
    ${tx_35_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet36
    ${tx_36_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet37
    ${tx_37_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet38
    ${tx_38_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet39
    ${tx_39_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet40
    ${tx_40_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet41
    ${tx_41_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet42
    ${tx_42_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet47
    ${tx_47_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet48
    ${tx_48_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet49
    ${tx_49_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_49_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet50
    ${tx_50_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_50_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet35
    ${tx_35_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet36
    ${tx_36_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet37
    ${tx_37_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet38
    ${tx_38_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet39
    ${tx_39_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet40
    ${tx_40_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet41
    ${tx_41_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet42
    ${tx_42_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet47
    ${tx_47_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet48
    ${tx_48_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']} 
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet49
    ${tx_49_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_49_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet50
    ${tx_50_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}    
    ${rx_50_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}    
    ${diffA1} =                                     evaluate                                ${rx_33_ucast_cnt2A} - ${rx_33_ucast_cnt1A}
    ${diffA2} =                                     evaluate                                ${tx_35_ucast_cnt2A} - ${tx_35_ucast_cnt1A}
    ${diffA3} =                                     evaluate                                ${tx_36_ucast_cnt2A} - ${tx_36_ucast_cnt1A}
    ${diffA4} =                                     evaluate                                ${tx_37_ucast_cnt2A} - ${tx_37_ucast_cnt1A}
    ${diffA5} =                                     evaluate                                ${tx_38_ucast_cnt2A} - ${tx_38_ucast_cnt1A}
    ${diffA6} =                                     evaluate                                ${tx_39_ucast_cnt2A} - ${tx_39_ucast_cnt1A}
    ${diffA7} =                                     evaluate                                ${tx_40_ucast_cnt2A} - ${tx_40_ucast_cnt1A}
    ${diffA8} =                                     evaluate                                ${tx_41_ucast_cnt2A} - ${tx_41_ucast_cnt1A}
    ${diffA9} =                                     evaluate                                ${tx_42_ucast_cnt2A} - ${tx_42_ucast_cnt1A}
    ${diffA10} =                                    evaluate                                ${tx_47_ucast_cnt2A} - ${tx_47_ucast_cnt1A}
    ${diffA11} =                                    evaluate                                ${tx_48_ucast_cnt2A} - ${tx_48_ucast_cnt1A}
    ${diffA12} =                                    evaluate                                ${tx_49_ucast_cnt2A} - ${tx_49_ucast_cnt1A}
    ${diffA13} =                                    evaluate                                ${tx_50_ucast_cnt2A} - ${tx_50_ucast_cnt1A}
    ${diffA14} =                                    evaluate                                ${rx_49_ucast_cnt2A} - ${rx_49_ucast_cnt1A}
    ${diffA15} =                                    evaluate                                ${rx_50_ucast_cnt2A} - ${rx_50_ucast_cnt1A}
    ${diffB2} =                                     evaluate                                ${tx_35_ucast_cnt2B} - ${tx_35_ucast_cnt1B}
    ${diffB3} =                                     evaluate                                ${tx_36_ucast_cnt2B} - ${tx_36_ucast_cnt1B}
    ${diffB4} =                                     evaluate                                ${tx_37_ucast_cnt2B} - ${tx_37_ucast_cnt1B}
    ${diffB5} =                                     evaluate                                ${tx_38_ucast_cnt2B} - ${tx_38_ucast_cnt1B}
    ${diffB6} =                                     evaluate                                ${tx_39_ucast_cnt2B} - ${tx_39_ucast_cnt1B}
    ${diffB7} =                                     evaluate                                ${tx_40_ucast_cnt2B} - ${tx_40_ucast_cnt1B}
    ${diffB8} =                                     evaluate                                ${tx_41_ucast_cnt2B} - ${tx_41_ucast_cnt1B}
    ${diffB9} =                                     evaluate                                ${tx_42_ucast_cnt2B} - ${tx_42_ucast_cnt1B}
    ${diffB10} =                                    evaluate                                ${tx_47_ucast_cnt2B} - ${tx_47_ucast_cnt1B}
    ${diffB11} =                                    evaluate                                ${tx_48_ucast_cnt2B} - ${tx_48_ucast_cnt1B}    
    ${diffB12} =                                    evaluate                                ${tx_49_ucast_cnt2B} - ${tx_49_ucast_cnt1B}
    ${diffB13} =                                    evaluate                                ${tx_50_ucast_cnt2B} - ${tx_50_ucast_cnt1B}    
    ${diffB14} =                                    evaluate                                ${rx_49_ucast_cnt2B} - ${rx_49_ucast_cnt1B}
    ${diffB15} =                                    evaluate                                ${rx_50_ucast_cnt2B} - ${rx_50_ucast_cnt1B}   
    stop traffic                                    ${stream1}
    Should Be True                                  ${diffA1} > 400000
    Should Be True                                  ${diffA2} > 40000
    Should Be True                                  ${diffA3} > 40000
    Should Be True                                  ${diffA4} > 40000
    Should Be True                                  ${diffA5} > 40000
    Should Be True                                  ${diffA6} > 40000
    Should Be True                                  ${diffA7} > 40000
    Should Be True                                  ${diffA8} > 40000
    Should Be True                                  ${diffA9} > 40000
    #### Check that leaf to spine link is not sending any traffic to spine
    Should Be True                                  ${diffA12} < 1000 and ${diffA13} < 1000 and ${diffA14} < 1000 and ${diffA15} < 1000
    Should Be True                                  ${diffB2} > 40000
    Should Be True                                  ${diffB3} > 40000
    Should Be True                                  ${diffB4} > 40000
    Should Be True                                  ${diffB5} > 40000
    Should Be True                                  ${diffB6} > 40000
    Should Be True                                  ${diffB7} > 40000
    Should Be True                                  ${diffB8} > 40000
    Should Be True                                  ${diffB9} > 40000 
    #### Check that leaf to spine link is not receiving traffic from spine
    Should Be True                                  ${diffB12} < 1000 and ${diffB13} < 1000 and ${diffB14} < 1000 and ${diffB15} < 1000
    verify results                                  transmitted_frames                      received_frames         ${stream1}              stream1
    

L3 inter tenant 16 hop ecmp group in same rack
    REST delete interface from vns                  Z                               Z192                    leaf2-a         ethernet33          -1   
    REST add interface to vns                       X                               X1                      leaf2-a         ethernet33          -1
    REST add static routes                          system                          10.99.255.0/24          {"tenant": "External"}
    sleep                                           1
    ${stream1}=                                     L3 add                          name=stream1            flow=g->a               frame_rate=100000           frame_size=128             frame_cnt=10000000000
    ...                                             src_ip=10.251.1.101             src_cnt=100             src_ip_step=0.0.0.1     src_gw=10.251.1.1           src_gw_step=0.0.0.0
    ...                                             dst_ip=10.99.255.101            dst_cnt=100             dst_ip_step=0.0.0.1     dst_gw=10.99.255.1          dst_gw_step=0.0.0.0

    sleep                                           1             
    start traffic                                   ${stream1}
    sleep                                           10
    stop traffic                                    ${stream1}
    sleep                                           1
    REST clear fabric interface stats
    sleep                                           1
    start traffic                                   ${stream1}
    sleep                                           5
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet33
    ${rx_33_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet35
    ${tx_35_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet36
    ${tx_36_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet37
    ${tx_37_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet38
    ${tx_38_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet39
    ${tx_39_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet40
    ${tx_40_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet41
    ${tx_41_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet42
    ${tx_42_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet47
    ${tx_47_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet48
    ${tx_48_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet49
    ${tx_49_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_49_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet50
    ${tx_50_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_50_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet35
    ${tx_35_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet36
    ${tx_36_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet37
    ${tx_37_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet38
    ${tx_38_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet39
    ${tx_39_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet40
    ${tx_40_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet41
    ${tx_41_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet42
    ${tx_42_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet47
    ${tx_47_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet48
    ${tx_48_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet49
    ${tx_49_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_49_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet50
    ${tx_50_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}    
    ${rx_50_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}    
    sleep                                           10
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet33
    ${rx_33_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet35
    ${tx_35_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet36
    ${tx_36_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet37
    ${tx_37_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet38
    ${tx_38_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet39
    ${tx_39_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet40
    ${tx_40_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet41
    ${tx_41_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet42
    ${tx_42_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet47
    ${tx_47_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet48
    ${tx_48_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet49
    ${tx_49_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_49_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet50
    ${tx_50_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_50_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet35
    ${tx_35_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet36
    ${tx_36_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet37
    ${tx_37_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet38
    ${tx_38_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet39
    ${tx_39_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet40
    ${tx_40_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet41
    ${tx_41_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet42
    ${tx_42_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet47
    ${tx_47_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet48
    ${tx_48_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']} 
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet49
    ${tx_49_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_49_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet50
    ${tx_50_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}    
    ${rx_50_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}    
    ${diffA1} =                                     evaluate                                ${rx_33_ucast_cnt2A} - ${rx_33_ucast_cnt1A}
    ${diffA2} =                                     evaluate                                ${tx_35_ucast_cnt2A} - ${tx_35_ucast_cnt1A}
    ${diffA3} =                                     evaluate                                ${tx_36_ucast_cnt2A} - ${tx_36_ucast_cnt1A}
    ${diffA4} =                                     evaluate                                ${tx_37_ucast_cnt2A} - ${tx_37_ucast_cnt1A}
    ${diffA5} =                                     evaluate                                ${tx_38_ucast_cnt2A} - ${tx_38_ucast_cnt1A}
    ${diffA6} =                                     evaluate                                ${tx_39_ucast_cnt2A} - ${tx_39_ucast_cnt1A}
    ${diffA7} =                                     evaluate                                ${tx_40_ucast_cnt2A} - ${tx_40_ucast_cnt1A}
    ${diffA8} =                                     evaluate                                ${tx_41_ucast_cnt2A} - ${tx_41_ucast_cnt1A}
    ${diffA9} =                                     evaluate                                ${tx_42_ucast_cnt2A} - ${tx_42_ucast_cnt1A}
    ${diffA10} =                                    evaluate                                ${tx_47_ucast_cnt2A} - ${tx_47_ucast_cnt1A}
    ${diffA11} =                                    evaluate                                ${tx_48_ucast_cnt2A} - ${tx_48_ucast_cnt1A}
    ${diffA12} =                                    evaluate                                ${tx_49_ucast_cnt2A} - ${tx_49_ucast_cnt1A}
    ${diffA13} =                                    evaluate                                ${tx_50_ucast_cnt2A} - ${tx_50_ucast_cnt1A}
    ${diffA14} =                                    evaluate                                ${rx_49_ucast_cnt2A} - ${rx_49_ucast_cnt1A}
    ${diffA15} =                                    evaluate                                ${rx_50_ucast_cnt2A} - ${rx_50_ucast_cnt1A}
    ${diffB2} =                                     evaluate                                ${tx_35_ucast_cnt2B} - ${tx_35_ucast_cnt1B}
    ${diffB3} =                                     evaluate                                ${tx_36_ucast_cnt2B} - ${tx_36_ucast_cnt1B}
    ${diffB4} =                                     evaluate                                ${tx_37_ucast_cnt2B} - ${tx_37_ucast_cnt1B}
    ${diffB5} =                                     evaluate                                ${tx_38_ucast_cnt2B} - ${tx_38_ucast_cnt1B}
    ${diffB6} =                                     evaluate                                ${tx_39_ucast_cnt2B} - ${tx_39_ucast_cnt1B}
    ${diffB7} =                                     evaluate                                ${tx_40_ucast_cnt2B} - ${tx_40_ucast_cnt1B}
    ${diffB8} =                                     evaluate                                ${tx_41_ucast_cnt2B} - ${tx_41_ucast_cnt1B}
    ${diffB9} =                                     evaluate                                ${tx_42_ucast_cnt2B} - ${tx_42_ucast_cnt1B}
    ${diffB10} =                                    evaluate                                ${tx_47_ucast_cnt2B} - ${tx_47_ucast_cnt1B}
    ${diffB11} =                                    evaluate                                ${tx_48_ucast_cnt2B} - ${tx_48_ucast_cnt1B}    
    ${diffB12} =                                    evaluate                                ${tx_49_ucast_cnt2B} - ${tx_49_ucast_cnt1B}
    ${diffB13} =                                    evaluate                                ${tx_50_ucast_cnt2B} - ${tx_50_ucast_cnt1B}    
    ${diffB14} =                                    evaluate                                ${rx_49_ucast_cnt2B} - ${rx_49_ucast_cnt1B}
    ${diffB15} =                                    evaluate                                ${rx_50_ucast_cnt2B} - ${rx_50_ucast_cnt1B}   
    stop traffic                                    ${stream1}
    Should Be True                                  ${diffA1} > 400000
    Should Be True                                  ${diffA2} > 40000
    Should Be True                                  ${diffA3} > 40000
    Should Be True                                  ${diffA4} > 40000
    Should Be True                                  ${diffA5} > 40000
    Should Be True                                  ${diffA6} > 40000
    Should Be True                                  ${diffA7} > 40000
    Should Be True                                  ${diffA8} > 40000
    Should Be True                                  ${diffA9} > 40000
    Should Be True                                  ${diffB2} > 40000
    Should Be True                                  ${diffB3} > 40000
    Should Be True                                  ${diffB4} > 40000
    Should Be True                                  ${diffB5} > 40000
    Should Be True                                  ${diffB6} > 40000
    Should Be True                                  ${diffB7} > 40000
    Should Be True                                  ${diffB8} > 40000
    Should Be True                                  ${diffB9} > 40000
    #### Check that one leaf to spine link is sending inter tenant traffic to spine 
    Should Be True                                  ${diffA12} > 100000 or ${diffA13} > 100000 or ${diffB12} > 100000 or ${diffB13} > 100000
    #### Check that one leaf to spine link is receiving inter tenant traffic from spine 
    Should Be True                                  ${diffA14} > 100000 or ${diffA15} > 100000 or ${diffB14} > 100000 or ${diffB15} > 100000
    verify results                                  transmitted_frames                      received_frames         ${stream1}              stream1

Verify L3 intra tenant ecmp group prefer local rack than remote rack
    REST delete interface from vns                  Z                               Z192                    leaf2-a         ethernet33          -1   
    REST add interface to vns                       External                        External-Host           leaf2-a         ethernet33          -1
    REST add static routes                          External                        10.99.255.0/24          {"next-hop-group": "ecmp-A1"}
    sleep                                           1
    ${stream1}=                                     L3 add                          name=stream1            flow=g->a               frame_rate=100000           frame_size=128             frame_cnt=10000000000
    ...                                             src_ip=10.254.99.101            src_cnt=100             src_ip_step=0.0.0.1     src_gw=10.254.99.1          src_gw_step=0.0.0.0
    ...                                             dst_ip=10.99.255.101            dst_cnt=100             dst_ip_step=0.0.0.1     dst_gw=10.99.255.1          dst_gw_step=0.0.0.0
    sleep                                           1             
    start traffic                                   ${stream1}
    sleep                                           10
    stop traffic                                    ${stream1}
    sleep                                           1
    REST clear fabric interface stats
    sleep                                           1
    start traffic                                   ${stream1}
    sleep                                           5
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet17
    ${tx_17_ucast_cnt2A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet19
    ${tx_19_ucast_cnt2A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet17
    ${tx_17_ucast_cnt2B-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet19
    ${tx_19_ucast_cnt2B-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet17
    ${tx_17_ucast_cnt1A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet19
    ${tx_19_ucast_cnt1A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    sleep                                           10
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet17
    ${tx_17_ucast_cnt2A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet19
    ${tx_19_ucast_cnt2A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet17
    ${tx_17_ucast_cnt2B-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet19
    ${tx_19_ucast_cnt2B-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet17
    ${tx_17_ucast_cnt1A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet19
    ${tx_19_ucast_cnt1A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}

    ${diffA1} =                                     evaluate                                ${tx_17_ucast_cnt2A-2} - ${tx_17_ucast_cnt2A-1}
    ${diffA2} =                                     evaluate                                ${tx_19_ucast_cnt2A-2} - ${tx_19_ucast_cnt2A-1}
    ${diffA3} =                                     evaluate                                ${tx_17_ucast_cnt2B-2} - ${tx_17_ucast_cnt2B-1}
    ${diffA4} =                                     evaluate                                ${tx_19_ucast_cnt2B-2} - ${tx_19_ucast_cnt2B-1}
    ${diffB1} =                                     evaluate                                ${tx_17_ucast_cnt1A-2} - ${tx_17_ucast_cnt1A-1}
    ${diffB2} =                                     evaluate                                ${tx_19_ucast_cnt1A-2} - ${tx_19_ucast_cnt1A-1}
    stop traffic                                    ${stream1}
    ### Current switch implementation for LAG hashing only hashes on src and dst ip add
    Should Be True                                  ${diffA1} > 200000 or ${diffA2} > 200000 or ${diffA3} > 200000 or ${diffA4} > 200000
    Should Be True                                  ${diffB1} < 100 and ${diffB2} < 100
    verify results                                  transmitted_frames                      received_frames         ${stream1}              stream1


Verify L3 intra tenant with no nexthop is dropped
    REST delete interface from vns                  Z                               Z192                    leaf2-a         ethernet33          -1   
    REST add interface to vns                       External                        External-Host           leaf2-a         ethernet33          -1
    REST add nexthop group                          External                        test
    REST add static routes                          External                        10.99.255.0/24          {"next-hop-group": "test"}
    sleep                                           1
    ${stream1}=                                     L3 add                          name=stream1            flow=g->a               frame_rate=100000           frame_size=128             frame_cnt=10000000000
    ...                                             src_ip=10.254.99.101            src_cnt=100             src_ip_step=0.0.0.1     src_gw=10.254.99.1          src_gw_step=0.0.0.0
    ...                                             dst_ip=10.99.255.101            dst_cnt=100             dst_ip_step=0.0.0.1     dst_gw=10.99.255.1          dst_gw_step=0.0.0.0
    sleep                                           1             
    start traffic                                   ${stream1}
    sleep                                           10
    stop traffic                                    ${stream1}
    sleep                                           1
    REST clear fabric interface stats
    sleep                                           1
    start traffic                                   ${stream1}
    sleep                                           5
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet17
    ${tx_17_ucast_cnt2A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet19
    ${tx_19_ucast_cnt2A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet17
    ${tx_17_ucast_cnt2B-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet19
    ${tx_19_ucast_cnt2B-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet17
    ${tx_17_ucast_cnt1A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet19
    ${tx_19_ucast_cnt1A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    sleep                                           10
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet17
    ${tx_17_ucast_cnt2A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet19
    ${tx_19_ucast_cnt2A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet17
    ${tx_17_ucast_cnt2B-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet19
    ${tx_19_ucast_cnt2B-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet17
    ${tx_17_ucast_cnt1A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet19
    ${tx_19_ucast_cnt1A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${diffA1} =                                     evaluate                                ${tx_17_ucast_cnt2A-2} - ${tx_17_ucast_cnt2A-1}
    ${diffA2} =                                     evaluate                                ${tx_19_ucast_cnt2A-2} - ${tx_19_ucast_cnt2A-1}
    ${diffA3} =                                     evaluate                                ${tx_17_ucast_cnt2B-2} - ${tx_17_ucast_cnt2B-1}
    ${diffA4} =                                     evaluate                                ${tx_19_ucast_cnt2B-2} - ${tx_19_ucast_cnt2B-1}
    ${diffB1} =                                     evaluate                                ${tx_17_ucast_cnt1A-2} - ${tx_17_ucast_cnt1A-1}
    ${diffB2} =                                     evaluate                                ${tx_19_ucast_cnt1A-2} - ${tx_19_ucast_cnt1A-1}
    stop traffic                                    ${stream1}
    ### Current switch implementation for LAG hashing only hashes on src and dst ip add
    Should Be True                                  ${diffA1} < 100 and ${diffA2} < 100 and ${diffA3} < 100 and ${diffA4} < 100
    Should Be True                                  ${diffB1} < 100 and ${diffB2} < 100
    calculate loss                                  transmitted_frames                      received_frames         ${stream1}              stream1
    REST add nexthopGroup ip                        External                                test                    10.99.3.1
    sleep                                           1
    REST clear fabric interface stats
    sleep                                           1
    start traffic                                   ${stream1}
    sleep                                           5
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet17
    ${tx_17_ucast_cnt2A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet19
    ${tx_19_ucast_cnt2A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet17
    ${tx_17_ucast_cnt2B-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet19
    ${tx_19_ucast_cnt2B-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet17
    ${tx_17_ucast_cnt1A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet19
    ${tx_19_ucast_cnt1A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    sleep                                           10
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet17
    ${tx_17_ucast_cnt2A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet19
    ${tx_19_ucast_cnt2A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet17
    ${tx_17_ucast_cnt2B-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet19
    ${tx_19_ucast_cnt2B-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet17
    ${tx_17_ucast_cnt1A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet19
    ${tx_19_ucast_cnt1A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${diffA1} =                                     evaluate                                ${tx_17_ucast_cnt2A-2} - ${tx_17_ucast_cnt2A-1}
    ${diffA2} =                                     evaluate                                ${tx_19_ucast_cnt2A-2} - ${tx_19_ucast_cnt2A-1}
    ${diffA3} =                                     evaluate                                ${tx_17_ucast_cnt2B-2} - ${tx_17_ucast_cnt2B-1}
    ${diffA4} =                                     evaluate                                ${tx_19_ucast_cnt2B-2} - ${tx_19_ucast_cnt2B-1}
    ${diffB1} =                                     evaluate                                ${tx_17_ucast_cnt1A-2} - ${tx_17_ucast_cnt1A-1}
    ${diffB2} =                                     evaluate                                ${tx_19_ucast_cnt1A-2} - ${tx_19_ucast_cnt1A-1}
    stop traffic                                    ${stream1}
    Should Be True                                  ${diffA1} < 100 and ${diffA2} < 100 and ${diffA3} < 100 and ${diffA4} < 100
    Should Be True                                  ${diffB1} > 500000 or ${diffB2} > 500000
    verify results                                  transmitted_frames                      received_frames         ${stream1}              stream1
    REST delete nexthop group                       External                                test 


Add and delete nexthop members to nexthop group
    REST delete interface from vns                  Z                               Z192                    leaf2-a         ethernet33          -1   
    REST add interface to vns                       External                        External-Host           leaf2-a         ethernet33          -1
    REST add nexthop group                          External                        test
    REST add static routes                          External                        10.99.255.0/24          {"next-hop-group": "test"}
    REST add nexthopGroup ip                        External                        test                    10.99.3.1
    sleep                                           1
    ${stream1}=                                     L3 add                          name=stream1            flow=g->a               frame_rate=100000           frame_size=128             frame_cnt=10000000000
    ...                                             src_ip=10.254.99.101            src_cnt=100             src_ip_step=0.0.0.1     src_gw=10.254.99.1          src_gw_step=0.0.0.0
    ...                                             dst_ip=10.99.255.101            dst_cnt=100             dst_ip_step=0.0.0.1     dst_gw=10.99.255.1          dst_gw_step=0.0.0.0
    sleep                                           1             
    start traffic                                   ${stream1}
    sleep                                           10
    stop traffic                                    ${stream1}
    sleep                                           1
    REST clear fabric interface stats
    sleep                                           1
    start traffic                                   ${stream1}
    sleep                                           5
    ${result} =                                     REST get fabric interface stats         leaf0-a                     ethernet17
    ${tx_17_ucast_cnt0A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf0-b                     ethernet17
    ${tx_17_ucast_cnt0B-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet17
    ${tx_17_ucast_cnt1A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet19
    ${tx_19_ucast_cnt1A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    sleep                                           10
    ${result} =                                     REST get fabric interface stats         leaf0-a                     ethernet17
    ${tx_17_ucast_cnt0A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf0-b                     ethernet17
    ${tx_17_ucast_cnt0B-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet17
    ${tx_17_ucast_cnt1A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet19
    ${tx_19_ucast_cnt1A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${diffA1} =                                     evaluate                                ${tx_17_ucast_cnt0A-2} - ${tx_17_ucast_cnt0A-1}
    ${diffA2} =                                     evaluate                                ${tx_17_ucast_cnt0B-2} - ${tx_17_ucast_cnt0B-1}
    ${diffA3} =                                     evaluate                                ${tx_17_ucast_cnt1A-2} - ${tx_17_ucast_cnt1A-1}
    ${diffA4} =                                     evaluate                                ${tx_19_ucast_cnt1A-2} - ${tx_19_ucast_cnt1A-1}
    stop traffic                                    ${stream1}
    Should Be True                                  ${diffA1} < 100 and ${diffA2} < 100 
    Should Be True                                  ${diffA3} > 5000000 or ${diffA4} > 500000
    verify results                                  transmitted_frames                      received_frames         ${stream1}              stream1
    REST add nexthopGroup ip                        External                                test                    10.99.1.1
    sleep                                           5
    REST clear fabric interface stats
    sleep                                           1
    start traffic                                   ${stream1}
    sleep                                           5
    ${result} =                                     REST get fabric interface stats         leaf0-a                     ethernet17
    ${tx_17_ucast_cnt0A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf0-b                     ethernet17
    ${tx_17_ucast_cnt0B-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet17
    ${tx_17_ucast_cnt1A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet19
    ${tx_19_ucast_cnt1A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    sleep                                           10
    ${result} =                                     REST get fabric interface stats         leaf0-a                     ethernet17
    ${tx_17_ucast_cnt0A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf0-b                     ethernet17
    ${tx_17_ucast_cnt0B-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet17
    ${tx_17_ucast_cnt1A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet19
    ${tx_19_ucast_cnt1A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${diffA1} =                                     evaluate                                ${tx_17_ucast_cnt0A-2} - ${tx_17_ucast_cnt0A-1}
    ${diffA2} =                                     evaluate                                ${tx_17_ucast_cnt0B-2} - ${tx_17_ucast_cnt0B-1}
    ${diffA3} =                                     evaluate                                ${tx_17_ucast_cnt1A-2} - ${tx_17_ucast_cnt1A-1}
    ${diffA4} =                                     evaluate                                ${tx_19_ucast_cnt1A-2} - ${tx_19_ucast_cnt1A-1}
    stop traffic                                    ${stream1}
    Should Be True                                  ${diffA1} > 500000 or ${diffA2} > 500000
    Should Be True                                  ${diffA3} > 500000 or ${diffA4} > 500000
    verify results                                  transmitted_frames                      received_frames         ${stream1}              stream1
    REST delete nexthopGroup ip                     External                                test                    10.99.3.1
    sleep                                           1
    REST clear fabric interface stats
    sleep                                           1
    start traffic                                   ${stream1}
    sleep                                           5
    ${result} =                                     REST get fabric interface stats         leaf0-a                     ethernet17
    ${tx_17_ucast_cnt0A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf0-b                     ethernet17
    ${tx_17_ucast_cnt0B-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet17
    ${tx_17_ucast_cnt1A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet19
    ${tx_19_ucast_cnt1A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    sleep                                           10
    ${result} =                                     REST get fabric interface stats         leaf0-a                     ethernet17
    ${tx_17_ucast_cnt0A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf0-b                     ethernet17
    ${tx_17_ucast_cnt0B-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet17
    ${tx_17_ucast_cnt1A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet19
    ${tx_19_ucast_cnt1A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${diffA1} =                                     evaluate                                ${tx_17_ucast_cnt0A-2} - ${tx_17_ucast_cnt0A-1}
    ${diffA2} =                                     evaluate                                ${tx_17_ucast_cnt0B-2} - ${tx_17_ucast_cnt0B-1}
    ${diffA3} =                                     evaluate                                ${tx_17_ucast_cnt1A-2} - ${tx_17_ucast_cnt1A-1}
    ${diffA4} =                                     evaluate                                ${tx_19_ucast_cnt1A-2} - ${tx_19_ucast_cnt1A-1}
    stop traffic                                    ${stream1}
    Should Be True                                  ${diffA3} < 100 and ${diffA4} < 100 
    Should Be True                                  ${diffA1} > 5000000 or ${diffA2} > 500000
    verify results                                  transmitted_frames                      received_frames         ${stream1}              stream1
    REST delete nexthop group                       External                                test 

L3 inter tenant add nexthop ip to 16 nexthop group
    REST add interface to vns                       X                               X1                      leaf0-a         ethernet33          -1
    REST add static routes                          system                          10.99.255.0/24          {"tenant": "External"}
    ${result} =                                     REST get l3 cidr route info     10.99.255.0             255.255.255.0
    Should Not Be Empty                             ${result}
    ${ecmpIndex} =                                  Set Variable                    ${result['ecmp-index']}
    Should Not Be True                              ${ecmpIndex} == 0
    ${count} =                                      REST ecmp nexthop count         ${ecmpIndex}
    Should Be True                                  ${count} == 16
    sleep                                           1
    ${stream1}=                                     L3 add                          name=stream1            flow=c->a               frame_rate=100000           frame_size=128             frame_cnt=10000000000
    ...                                             src_ip=10.251.1.101             src_cnt=100             src_ip_step=0.0.0.1     src_gw=10.251.1.1           src_gw_step=0.0.0.0
    ...                                             dst_ip=10.99.255.101            dst_cnt=100             dst_ip_step=0.0.0.1     dst_gw=10.99.255.1          dst_gw_step=0.0.0.0

    sleep                                           1             
    start traffic                                   ${stream1}
    sleep                                           10
    stop traffic                                    ${stream1}
    sleep                                           1
    REST clear fabric interface stats
    sleep                                           1
    start traffic                                   ${stream1}
    sleep                                           5
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet35
    ${tx_35_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet36
    ${tx_36_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet37
    ${tx_37_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet38
    ${tx_38_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet39
    ${tx_39_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet40
    ${tx_40_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet41
    ${tx_41_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet42
    ${tx_42_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet47
    ${tx_47_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet48
    ${tx_48_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet49
    ${tx_49_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_49_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet50
    ${tx_50_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_50_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet35
    ${tx_35_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet36
    ${tx_36_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet37
    ${tx_37_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet38
    ${tx_38_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet39
    ${tx_39_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet40
    ${tx_40_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet41
    ${tx_41_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet42
    ${tx_42_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet47
    ${tx_47_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet48
    ${tx_48_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet49
    ${tx_49_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_49_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet50
    ${tx_50_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}    
    ${rx_50_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}    
    sleep                                           11
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet35
    ${tx_35_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet36
    ${tx_36_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet37
    ${tx_37_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet38
    ${tx_38_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet39
    ${tx_39_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet40
    ${tx_40_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet41
    ${tx_41_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet42
    ${tx_42_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet47
    ${tx_47_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet48
    ${tx_48_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet49
    ${tx_49_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_49_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet50
    ${tx_50_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_50_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet35
    ${tx_35_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet36
    ${tx_36_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet37
    ${tx_37_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet38
    ${tx_38_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet39
    ${tx_39_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet40
    ${tx_40_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet41
    ${tx_41_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet42
    ${tx_42_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet47
    ${tx_47_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet48
    ${tx_48_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']} 
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet49
    ${tx_49_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_49_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet50
    ${tx_50_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}    
    ${rx_50_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}    
    ${diffA2} =                                     evaluate                                ${tx_35_ucast_cnt2A} - ${tx_35_ucast_cnt1A}
    ${diffA3} =                                     evaluate                                ${tx_36_ucast_cnt2A} - ${tx_36_ucast_cnt1A}
    ${diffA4} =                                     evaluate                                ${tx_37_ucast_cnt2A} - ${tx_37_ucast_cnt1A}
    ${diffA5} =                                     evaluate                                ${tx_38_ucast_cnt2A} - ${tx_38_ucast_cnt1A}
    ${diffA6} =                                     evaluate                                ${tx_39_ucast_cnt2A} - ${tx_39_ucast_cnt1A}
    ${diffA7} =                                     evaluate                                ${tx_40_ucast_cnt2A} - ${tx_40_ucast_cnt1A}
    ${diffA8} =                                     evaluate                                ${tx_41_ucast_cnt2A} - ${tx_41_ucast_cnt1A}
    ${diffA9} =                                     evaluate                                ${tx_42_ucast_cnt2A} - ${tx_42_ucast_cnt1A}
    ${diffA10} =                                    evaluate                                ${tx_47_ucast_cnt2A} - ${tx_47_ucast_cnt1A}
    ${diffA11} =                                    evaluate                                ${tx_48_ucast_cnt2A} - ${tx_48_ucast_cnt1A}
    ${diffA12} =                                    evaluate                                ${tx_49_ucast_cnt2A} - ${tx_49_ucast_cnt1A}
    ${diffA13} =                                    evaluate                                ${tx_50_ucast_cnt2A} - ${tx_50_ucast_cnt1A}
    ${diffA14} =                                    evaluate                                ${rx_49_ucast_cnt2A} - ${rx_49_ucast_cnt1A}
    ${diffA15} =                                    evaluate                                ${rx_50_ucast_cnt2A} - ${rx_50_ucast_cnt1A}
    ${diffB2} =                                     evaluate                                ${tx_35_ucast_cnt2B} - ${tx_35_ucast_cnt1B}
    ${diffB3} =                                     evaluate                                ${tx_36_ucast_cnt2B} - ${tx_36_ucast_cnt1B}
    ${diffB4} =                                     evaluate                                ${tx_37_ucast_cnt2B} - ${tx_37_ucast_cnt1B}
    ${diffB5} =                                     evaluate                                ${tx_38_ucast_cnt2B} - ${tx_38_ucast_cnt1B}
    ${diffB6} =                                     evaluate                                ${tx_39_ucast_cnt2B} - ${tx_39_ucast_cnt1B}
    ${diffB7} =                                     evaluate                                ${tx_40_ucast_cnt2B} - ${tx_40_ucast_cnt1B}
    ${diffB8} =                                     evaluate                                ${tx_41_ucast_cnt2B} - ${tx_41_ucast_cnt1B}
    ${diffB9} =                                     evaluate                                ${tx_42_ucast_cnt2B} - ${tx_42_ucast_cnt1B}
    ${diffB10} =                                    evaluate                                ${tx_47_ucast_cnt2B} - ${tx_47_ucast_cnt1B}
    ${diffB11} =                                    evaluate                                ${tx_48_ucast_cnt2B} - ${tx_48_ucast_cnt1B}    
    ${diffB12} =                                    evaluate                                ${tx_49_ucast_cnt2B} - ${tx_49_ucast_cnt1B}
    ${diffB13} =                                    evaluate                                ${tx_50_ucast_cnt2B} - ${tx_50_ucast_cnt1B}    
    ${diffB14} =                                    evaluate                                ${rx_49_ucast_cnt2B} - ${rx_49_ucast_cnt1B}
    ${diffB15} =                                    evaluate                                ${rx_50_ucast_cnt2B} - ${rx_50_ucast_cnt1B}   
    stop traffic                                    ${stream1}
    Should Be True                                  ${diffA2} > 40000
    Should Be True                                  ${diffA3} > 40000
    Should Be True                                  ${diffA4} > 40000
    Should Be True                                  ${diffA5} > 40000
    Should Be True                                  ${diffA6} > 40000
    Should Be True                                  ${diffA7} > 40000
    Should Be True                                  ${diffA8} > 40000
    Should Be True                                  ${diffA9} > 40000
    Should Be True                                  ${diffB2} > 40000
    Should Be True                                  ${diffB3} > 40000
    Should Be True                                  ${diffB4} > 40000
    Should Be True                                  ${diffB5} > 40000
    Should Be True                                  ${diffB6} > 40000
    Should Be True                                  ${diffB7} > 40000
    Should Be True                                  ${diffB8} > 40000
    Should Be True                                  ${diffB9} > 40000
    #### Check that one leaf to spine link is receiving inter tenant traffic from spine 
    Should Be True                                  ${diffA14} > 100000 or ${diffA15} > 100000 or ${diffB14} > 100000 or ${diffB15} > 100000
    verify results                                  transmitted_frames                      received_frames         ${stream1}              stream1
    ${result} =                                     REST add nexthopGroup ip                External                                ecmp-A16                    10.99.3.1
    Should Not Be True                              ${result}
    ${result} =                                     REST add nexthopGroup ip                External                                ecmp-A16                    10.99.5.1
    Should Not Be True                              ${result}
    sleep                                           1
    ${result} =                                     REST get l3 cidr route info             10.99.255.0             255.255.255.0
    Should Not Be Empty                             ${result}
    ${ecmpIndex} =                                  Set Variable                            ${result['ecmp-index']}
    Should Not Be True                              ${ecmpIndex} == 0
    ${count} =                                      REST ecmp nexthop count                 ${ecmpIndex}
    Should Be True                                  ${count} == 16
    sleep                                           1
    REST delete nexthopGroup ip                     External                                ecmp-A16                                10.99.28.1
    REST delete nexthopGroup ip                     External                                ecmp-A16                                10.98.28.1
    sleep                                           1
    ${result} =                                     REST get l3 cidr route info             10.99.255.0             255.255.255.0
    Should Not Be Empty                             ${result}
    ${ecmpIndex} =                                  Set Variable                            ${result['ecmp-index']}
    Should Not Be True                              ${ecmpIndex} == 0
    ${count} =                                      REST ecmp nexthop count                 ${ecmpIndex}
    Should Be True                                  ${count} == 14
    sleep                                           1
    start traffic                                   ${stream1}
    sleep                                           5
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet17
    ${tx_17_ucast_cnt1A_1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet19
    ${tx_19_ucast_cnt1A_1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet17
    ${tx_17_ucast_cnt2A_1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet19
    ${tx_19_ucast_cnt2A_1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet17
    ${tx_17_ucast_cnt2B_1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet19
    ${tx_19_ucast_cnt2B_1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet35
    ${tx_35_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet36
    ${tx_36_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet37
    ${tx_37_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet38
    ${tx_38_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet39
    ${tx_39_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet40
    ${tx_40_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet41
    ${tx_41_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet42
    ${tx_42_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet47
    ${tx_47_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet48
    ${tx_48_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet49
    ${tx_49_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_49_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet50
    ${tx_50_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_50_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet35
    ${tx_35_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet36
    ${tx_36_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet37
    ${tx_37_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet38
    ${tx_38_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet39
    ${tx_39_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet40
    ${tx_40_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet41
    ${tx_41_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet42
    ${tx_42_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet47
    ${tx_47_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet48
    ${tx_48_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet49
    ${tx_49_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_49_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet50
    ${tx_50_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}    
    ${rx_50_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}    
    sleep                                           11
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet17
    ${tx_17_ucast_cnt1A_2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet19
    ${tx_19_ucast_cnt1A_2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet17
    ${tx_17_ucast_cnt2A_2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet19
    ${tx_19_ucast_cnt2A_2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet17
    ${tx_17_ucast_cnt2B_2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet19
    ${tx_19_ucast_cnt2B_2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet35
    ${tx_35_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet36
    ${tx_36_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet37
    ${tx_37_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet38
    ${tx_38_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet39
    ${tx_39_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet40
    ${tx_40_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet41
    ${tx_41_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet42
    ${tx_42_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet47
    ${tx_47_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet48
    ${tx_48_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet49
    ${tx_49_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_49_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet50
    ${tx_50_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_50_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet35
    ${tx_35_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet36
    ${tx_36_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet37
    ${tx_37_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet38
    ${tx_38_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet39
    ${tx_39_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet40
    ${tx_40_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet41
    ${tx_41_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet42
    ${tx_42_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet47
    ${tx_47_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet48
    ${tx_48_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']} 
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet49
    ${tx_49_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_49_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet50
    ${tx_50_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}    
    ${rx_50_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}    
    ${diffA2} =                                     evaluate                                ${tx_35_ucast_cnt2A} - ${tx_35_ucast_cnt1A}
    ${diffA3} =                                     evaluate                                ${tx_36_ucast_cnt2A} - ${tx_36_ucast_cnt1A}
    ${diffA4} =                                     evaluate                                ${tx_37_ucast_cnt2A} - ${tx_37_ucast_cnt1A}
    ${diffA5} =                                     evaluate                                ${tx_38_ucast_cnt2A} - ${tx_38_ucast_cnt1A}
    ${diffA6} =                                     evaluate                                ${tx_39_ucast_cnt2A} - ${tx_39_ucast_cnt1A}
    ${diffA7} =                                     evaluate                                ${tx_40_ucast_cnt2A} - ${tx_40_ucast_cnt1A}
    ${diffA8} =                                     evaluate                                ${tx_41_ucast_cnt2A} - ${tx_41_ucast_cnt1A}
    ${diffA9} =                                     evaluate                                ${tx_42_ucast_cnt2A} - ${tx_42_ucast_cnt1A}
    ${diffA10} =                                    evaluate                                ${tx_47_ucast_cnt2A} - ${tx_47_ucast_cnt1A}
    ${diffA11} =                                    evaluate                                ${tx_48_ucast_cnt2A} - ${tx_48_ucast_cnt1A}
    ${diffA12} =                                    evaluate                                ${tx_49_ucast_cnt2A} - ${tx_49_ucast_cnt1A}
    ${diffA13} =                                    evaluate                                ${tx_50_ucast_cnt2A} - ${tx_50_ucast_cnt1A}
    ${diffA14} =                                    evaluate                                ${rx_49_ucast_cnt2A} - ${rx_49_ucast_cnt1A}
    ${diffA15} =                                    evaluate                                ${rx_50_ucast_cnt2A} - ${rx_50_ucast_cnt1A}
    ${diffB2} =                                     evaluate                                ${tx_35_ucast_cnt2B} - ${tx_35_ucast_cnt1B}
    ${diffB3} =                                     evaluate                                ${tx_36_ucast_cnt2B} - ${tx_36_ucast_cnt1B}
    ${diffB4} =                                     evaluate                                ${tx_37_ucast_cnt2B} - ${tx_37_ucast_cnt1B}
    ${diffB5} =                                     evaluate                                ${tx_38_ucast_cnt2B} - ${tx_38_ucast_cnt1B}
    ${diffB6} =                                     evaluate                                ${tx_39_ucast_cnt2B} - ${tx_39_ucast_cnt1B}
    ${diffB7} =                                     evaluate                                ${tx_40_ucast_cnt2B} - ${tx_40_ucast_cnt1B}
    ${diffB8} =                                     evaluate                                ${tx_41_ucast_cnt2B} - ${tx_41_ucast_cnt1B}
    ${diffB9} =                                     evaluate                                ${tx_42_ucast_cnt2B} - ${tx_42_ucast_cnt1B}
    ${diffB10} =                                    evaluate                                ${tx_47_ucast_cnt2B} - ${tx_47_ucast_cnt1B}
    ${diffB11} =                                    evaluate                                ${tx_48_ucast_cnt2B} - ${tx_48_ucast_cnt1B}    
    ${diffB12} =                                    evaluate                                ${tx_49_ucast_cnt2B} - ${tx_49_ucast_cnt1B}
    ${diffB13} =                                    evaluate                                ${tx_50_ucast_cnt2B} - ${tx_50_ucast_cnt1B}    
    ${diffB14} =                                    evaluate                                ${rx_49_ucast_cnt2B} - ${rx_49_ucast_cnt1B}
    ${diffB15} =                                    evaluate                                ${rx_50_ucast_cnt2B} - ${rx_50_ucast_cnt1B}   
    ${diffC1} =                                     evaluate                                ${tx_17_ucast_cnt1A_2} - ${tx_17_ucast_cnt1A_1}
    ${diffC2} =                                     evaluate                                ${tx_19_ucast_cnt1A_2} - ${tx_19_ucast_cnt1A_1}
    ${diffC3} =                                     evaluate                                ${tx_17_ucast_cnt2A_2} - ${tx_17_ucast_cnt2A_1}
    ${diffC4} =                                     evaluate                                ${tx_19_ucast_cnt2A_2} - ${tx_19_ucast_cnt2A_1}
    ${diffC5} =                                     evaluate                                ${tx_17_ucast_cnt2B_2} - ${tx_17_ucast_cnt2B_1}
    ${diffC6} =                                     evaluate                                ${tx_19_ucast_cnt2B_2} - ${tx_19_ucast_cnt2B_1}
    stop traffic                                    ${stream1}
    Should Be True                                  ${diffA2} > 20000
    Should Be True                                  ${diffA3} > 20000
    Should Be True                                  ${diffA4} > 20000
    Should Be True                                  ${diffA5} > 20000
    Should Be True                                  ${diffA6} > 20000
    Should Be True                                  ${diffA7} > 20000
    Should Be True                                  ${diffA8} > 20000
    Should Be True                                  ${diffA9} < 100
    Should Be True                                  ${diffB2} > 20000
    Should Be True                                  ${diffB3} > 20000
    Should Be True                                  ${diffB4} > 20000
    Should Be True                                  ${diffB5} > 20000
    Should Be True                                  ${diffB6} > 20000
    Should Be True                                  ${diffB7} > 20000
    Should Be True                                  ${diffB8} > 20000
    Should Be True                                  ${diffB9} < 100
    Should Be True                                  ${diffC1} < 100 and ${diffC2} < 100 and ${diffC3} < 100 and ${diffC4} < 100 and ${diffC5} < 100 and ${diffC6} < 100 
    verify results                                  transmitted_frames                      received_frames         ${stream1}              stream1
    sleep                                           1
    ${result} =                                     REST add nexthopGroup ip                External                                ecmp-A16                    10.99.3.1
    Should Be True                                  ${result}
    ${result} =                                     REST add nexthopGroup ip                External                                ecmp-A16                    10.99.5.1
    Should Be True                                  ${result}
    sleep                                           1
    ${result} =                                     REST get l3 cidr route info             10.99.255.0             255.255.255.0
    Should Not Be Empty                             ${result}
    ${ecmpIndex} =                                  Set Variable                            ${result['ecmp-index']}
    Should Not Be True                              ${ecmpIndex} == 0
    ${count} =                                      REST ecmp nexthop count                 ${ecmpIndex}
    Should Be True                                  ${count} == 16
    sleep                                           1    
    start traffic                                   ${stream1}
    sleep                                           5
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet17
    ${tx_17_ucast_cnt1A_1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet19
    ${tx_19_ucast_cnt1A_1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet17
    ${tx_17_ucast_cnt2A_1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet19
    ${tx_19_ucast_cnt2A_1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet17
    ${tx_17_ucast_cnt2B_1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet19
    ${tx_19_ucast_cnt2B_1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet35
    ${tx_35_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet36
    ${tx_36_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet37
    ${tx_37_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet38
    ${tx_38_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet39
    ${tx_39_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet40
    ${tx_40_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet41
    ${tx_41_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet42
    ${tx_42_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet47
    ${tx_47_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet48
    ${tx_48_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet49
    ${tx_49_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_49_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet50
    ${tx_50_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_50_ucast_cnt1A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet35
    ${tx_35_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet36
    ${tx_36_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet37
    ${tx_37_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet38
    ${tx_38_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet39
    ${tx_39_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet40
    ${tx_40_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet41
    ${tx_41_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet42
    ${tx_42_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet47
    ${tx_47_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet48
    ${tx_48_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet49
    ${tx_49_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_49_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet50
    ${tx_50_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}    
    ${rx_50_ucast_cnt1B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}    
    sleep                                           11
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet17
    ${tx_17_ucast_cnt1A_2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet19
    ${tx_19_ucast_cnt1A_2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet17
    ${tx_17_ucast_cnt2A_2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet19
    ${tx_19_ucast_cnt2A_2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet17
    ${tx_17_ucast_cnt2B_2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet19
    ${tx_19_ucast_cnt2B_2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet35
    ${tx_35_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet36
    ${tx_36_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet37
    ${tx_37_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet38
    ${tx_38_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet39
    ${tx_39_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet40
    ${tx_40_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet41
    ${tx_41_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet42
    ${tx_42_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet47
    ${tx_47_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet48
    ${tx_48_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet49
    ${tx_49_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_49_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-a                     ethernet50
    ${tx_50_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_50_ucast_cnt2A} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet35
    ${tx_35_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet36
    ${tx_36_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet37
    ${tx_37_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet38
    ${tx_38_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet39
    ${tx_39_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet40
    ${tx_40_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet41
    ${tx_41_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet42
    ${tx_42_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet47
    ${tx_47_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet48
    ${tx_48_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']} 
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet49
    ${tx_49_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${rx_49_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf2-b                     ethernet50
    ${tx_50_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}    
    ${rx_50_ucast_cnt2B} =                          Set Variable                            ${result[0]['interface'][0]['counter']['rx-unicast-packet']}    
    ${diffA2} =                                     evaluate                                ${tx_35_ucast_cnt2A} - ${tx_35_ucast_cnt1A}
    ${diffA3} =                                     evaluate                                ${tx_36_ucast_cnt2A} - ${tx_36_ucast_cnt1A}
    ${diffA4} =                                     evaluate                                ${tx_37_ucast_cnt2A} - ${tx_37_ucast_cnt1A}
    ${diffA5} =                                     evaluate                                ${tx_38_ucast_cnt2A} - ${tx_38_ucast_cnt1A}
    ${diffA6} =                                     evaluate                                ${tx_39_ucast_cnt2A} - ${tx_39_ucast_cnt1A}
    ${diffA7} =                                     evaluate                                ${tx_40_ucast_cnt2A} - ${tx_40_ucast_cnt1A}
    ${diffA8} =                                     evaluate                                ${tx_41_ucast_cnt2A} - ${tx_41_ucast_cnt1A}
    ${diffA9} =                                     evaluate                                ${tx_42_ucast_cnt2A} - ${tx_42_ucast_cnt1A}
    ${diffA10} =                                    evaluate                                ${tx_47_ucast_cnt2A} - ${tx_47_ucast_cnt1A}
    ${diffA11} =                                    evaluate                                ${tx_48_ucast_cnt2A} - ${tx_48_ucast_cnt1A}
    ${diffA12} =                                    evaluate                                ${tx_49_ucast_cnt2A} - ${tx_49_ucast_cnt1A}
    ${diffA13} =                                    evaluate                                ${tx_50_ucast_cnt2A} - ${tx_50_ucast_cnt1A}
    ${diffA14} =                                    evaluate                                ${rx_49_ucast_cnt2A} - ${rx_49_ucast_cnt1A}
    ${diffA15} =                                    evaluate                                ${rx_50_ucast_cnt2A} - ${rx_50_ucast_cnt1A}
    ${diffB2} =                                     evaluate                                ${tx_35_ucast_cnt2B} - ${tx_35_ucast_cnt1B}
    ${diffB3} =                                     evaluate                                ${tx_36_ucast_cnt2B} - ${tx_36_ucast_cnt1B}
    ${diffB4} =                                     evaluate                                ${tx_37_ucast_cnt2B} - ${tx_37_ucast_cnt1B}
    ${diffB5} =                                     evaluate                                ${tx_38_ucast_cnt2B} - ${tx_38_ucast_cnt1B}
    ${diffB6} =                                     evaluate                                ${tx_39_ucast_cnt2B} - ${tx_39_ucast_cnt1B}
    ${diffB7} =                                     evaluate                                ${tx_40_ucast_cnt2B} - ${tx_40_ucast_cnt1B}
    ${diffB8} =                                     evaluate                                ${tx_41_ucast_cnt2B} - ${tx_41_ucast_cnt1B}
    ${diffB9} =                                     evaluate                                ${tx_42_ucast_cnt2B} - ${tx_42_ucast_cnt1B}
    ${diffB10} =                                    evaluate                                ${tx_47_ucast_cnt2B} - ${tx_47_ucast_cnt1B}
    ${diffB11} =                                    evaluate                                ${tx_48_ucast_cnt2B} - ${tx_48_ucast_cnt1B}    
    ${diffB12} =                                    evaluate                                ${tx_49_ucast_cnt2B} - ${tx_49_ucast_cnt1B}
    ${diffB13} =                                    evaluate                                ${tx_50_ucast_cnt2B} - ${tx_50_ucast_cnt1B}    
    ${diffB14} =                                    evaluate                                ${rx_49_ucast_cnt2B} - ${rx_49_ucast_cnt1B}
    ${diffB15} =                                    evaluate                                ${rx_50_ucast_cnt2B} - ${rx_50_ucast_cnt1B}   
    ${diffC1} =                                     evaluate                                ${tx_17_ucast_cnt1A_2} - ${tx_17_ucast_cnt1A_1}
    ${diffC2} =                                     evaluate                                ${tx_19_ucast_cnt1A_2} - ${tx_19_ucast_cnt1A_1}
    ${diffC3} =                                     evaluate                                ${tx_17_ucast_cnt2A_2} - ${tx_17_ucast_cnt2A_1}
    ${diffC4} =                                     evaluate                                ${tx_19_ucast_cnt2A_2} - ${tx_19_ucast_cnt2A_1}
    ${diffC5} =                                     evaluate                                ${tx_17_ucast_cnt2B_2} - ${tx_17_ucast_cnt2B_1}
    ${diffC6} =                                     evaluate                                ${tx_19_ucast_cnt2B_2} - ${tx_19_ucast_cnt2B_1}
    stop traffic                                    ${stream1}
    Should Be True                                  ${diffA2} > 40000
    Should Be True                                  ${diffA3} > 40000
    Should Be True                                  ${diffA4} > 40000
    Should Be True                                  ${diffA5} > 40000
    Should Be True                                  ${diffA6} > 40000
    Should Be True                                  ${diffA7} > 40000
    Should Be True                                  ${diffA8} > 40000
    Should Be True                                  ${diffA9} < 100
    Should Be True                                  ${diffB2} > 40000
    Should Be True                                  ${diffB3} > 40000
    Should Be True                                  ${diffB4} > 40000
    Should Be True                                  ${diffB5} > 40000
    Should Be True                                  ${diffB6} > 40000
    Should Be True                                  ${diffB7} > 40000
    Should Be True                                  ${diffB8} > 40000
    Should Be True                                  ${diffB9} < 100
    Should Be True                                  ${diffC1} > 40000 or ${diffC2} > 40000
    Should Be True                                  ${diffC3} > 40000 or ${diffC4} > 40000 or ${diffC5}> 40000 or ${diffC6} > 40000
    verify results                                  transmitted_frames                      received_frames         ${stream1}              stream1
    
Verify add and delete a second member to nexthop group change to ecmp and back
    REST delete interface from vns                  Z                               Z192                    leaf2-a         ethernet33          -1   
    REST add interface to vns                       External                        External-Host           leaf2-a         ethernet33          -1
    REST add nexthop group                          External                        test
    REST add static routes                          External                        10.99.255.0/24          {"next-hop-group": "test"}
    REST add nexthopGroup ip                        External                        test                    10.99.3.1

    ${result} =                                     REST get l3 cidr route info             10.99.255.0             255.255.255.0
    Should Not Be Empty                             ${result}
    ${ecmpIndex} =                                  Set Variable                            ${result['ecmp-index']}
    Should Be True                                  ${ecmpIndex} == 0
    sleep                                           1
    ${stream1}=                                     L3 add                          name=stream1            flow=g->a               frame_rate=100000           frame_size=128             frame_cnt=10000000000
    ...                                             src_ip=10.254.99.101            src_cnt=100             src_ip_step=0.0.0.1     src_gw=10.254.99.1          src_gw_step=0.0.0.0
    ...                                             dst_ip=10.99.255.101            dst_cnt=100             dst_ip_step=0.0.0.1     dst_gw=10.99.255.1          dst_gw_step=0.0.0.0
    sleep                                           1             
    start traffic                                   ${stream1}
    sleep                                           10
    stop traffic                                    ${stream1}
    sleep                                           1
    REST clear fabric interface stats
    sleep                                           1
    start traffic                                   ${stream1}
    sleep                                           5
    ${result} =                                     REST get fabric interface stats         leaf0-a                     ethernet17
    ${tx_17_ucast_cnt0A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf0-b                     ethernet17
    ${tx_17_ucast_cnt0B-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet17
    ${tx_17_ucast_cnt1A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet19
    ${tx_19_ucast_cnt1A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    sleep                                           10
    ${result} =                                     REST get fabric interface stats         leaf0-a                     ethernet17
    ${tx_17_ucast_cnt0A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf0-b                     ethernet17
    ${tx_17_ucast_cnt0B-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet17
    ${tx_17_ucast_cnt1A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet19
    ${tx_19_ucast_cnt1A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${diffA1} =                                     evaluate                                ${tx_17_ucast_cnt0A-2} - ${tx_17_ucast_cnt0A-1}
    ${diffA2} =                                     evaluate                                ${tx_17_ucast_cnt0B-2} - ${tx_17_ucast_cnt0B-1}
    ${diffA3} =                                     evaluate                                ${tx_17_ucast_cnt1A-2} - ${tx_17_ucast_cnt1A-1}
    ${diffA4} =                                     evaluate                                ${tx_19_ucast_cnt1A-2} - ${tx_19_ucast_cnt1A-1}
    stop traffic                                    ${stream1}
    Should Be True                                  ${diffA1} < 100 and ${diffA2} < 100 
    Should Be True                                  ${diffA3} > 5000000 or ${diffA4} > 500000
    verify results                                  transmitted_frames                      received_frames         ${stream1}              stream1
    REST add nexthopGroup ip                        External                                test                    10.99.1.1
    sleep                                           1
    ${result} =                                     REST get l3 cidr route info             10.99.255.0             255.255.255.0
    Should Not Be Empty                             ${result}
    ${ecmpIndex} =                                  Set Variable                            ${result['ecmp-index']}
    Should Not Be True                              ${ecmpIndex} == 0
    ${count} =                                      REST ecmp nexthop count                 ${ecmpIndex}
    Should Be True                                  ${count} == 2
    REST clear fabric interface stats
    sleep                                           1
    start traffic                                   ${stream1}
    sleep                                           5
    ${result} =                                     REST get fabric interface stats         leaf0-a                     ethernet17
    ${tx_17_ucast_cnt0A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf0-b                     ethernet17
    ${tx_17_ucast_cnt0B-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet17
    ${tx_17_ucast_cnt1A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet19
    ${tx_19_ucast_cnt1A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    sleep                                           10
    ${result} =                                     REST get fabric interface stats         leaf0-a                     ethernet17
    ${tx_17_ucast_cnt0A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf0-b                     ethernet17
    ${tx_17_ucast_cnt0B-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet17
    ${tx_17_ucast_cnt1A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet19
    ${tx_19_ucast_cnt1A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${diffA1} =                                     evaluate                                ${tx_17_ucast_cnt0A-2} - ${tx_17_ucast_cnt0A-1}
    ${diffA2} =                                     evaluate                                ${tx_17_ucast_cnt0B-2} - ${tx_17_ucast_cnt0B-1}
    ${diffA3} =                                     evaluate                                ${tx_17_ucast_cnt1A-2} - ${tx_17_ucast_cnt1A-1}
    ${diffA4} =                                     evaluate                                ${tx_19_ucast_cnt1A-2} - ${tx_19_ucast_cnt1A-1}
    stop traffic                                    ${stream1}
    Should Be True                                  ${diffA1} > 500000 or ${diffA2} > 500000
    Should Be True                                  ${diffA3} > 500000 or ${diffA4} > 500000
    verify results                                  transmitted_frames                      received_frames         ${stream1}              stream1
    REST delete nexthopGroup ip                     External                                test                    10.99.3.1
    sleep                                           1
    ${result} =                                     REST get l3 cidr route info             10.99.255.0             255.255.255.0
    Should Not Be Empty                             ${result}
    ${ecmpIndex} =                                  Set Variable                            ${result['ecmp-index']}
    Should Be True                                  ${ecmpIndex} == 0
    REST clear fabric interface stats
    sleep                                           1
    start traffic                                   ${stream1}
    sleep                                           5
    ${result} =                                     REST get fabric interface stats         leaf0-a                     ethernet17
    ${tx_17_ucast_cnt0A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf0-b                     ethernet17
    ${tx_17_ucast_cnt0B-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet17
    ${tx_17_ucast_cnt1A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet19
    ${tx_19_ucast_cnt1A-1} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    sleep                                           10
    ${result} =                                     REST get fabric interface stats         leaf0-a                     ethernet17
    ${tx_17_ucast_cnt0A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf0-b                     ethernet17
    ${tx_17_ucast_cnt0B-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet17
    ${tx_17_ucast_cnt1A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${result} =                                     REST get fabric interface stats         leaf1-a                     ethernet19
    ${tx_19_ucast_cnt1A-2} =                        Set Variable                            ${result[0]['interface'][0]['counter']['tx-unicast-packet']}
    ${diffA1} =                                     evaluate                                ${tx_17_ucast_cnt0A-2} - ${tx_17_ucast_cnt0A-1}
    ${diffA2} =                                     evaluate                                ${tx_17_ucast_cnt0B-2} - ${tx_17_ucast_cnt0B-1}
    ${diffA3} =                                     evaluate                                ${tx_17_ucast_cnt1A-2} - ${tx_17_ucast_cnt1A-1}
    ${diffA4} =                                     evaluate                                ${tx_19_ucast_cnt1A-2} - ${tx_19_ucast_cnt1A-1}
    stop traffic                                    ${stream1}
    Should Be True                                  ${diffA3} < 100 and ${diffA4} < 100 
    Should Be True                                  ${diffA1} > 5000000 or ${diffA2} > 500000
    verify results                                  transmitted_frames                      received_frames         ${stream1}              stream1
    REST delete nexthop group                       External                                test 


Add and delete config changes
    ${value} =                                  REST enable endpoint flap protection
    Log                                         ${value}
    REST add portgroup to vns                   X                               X1                              leaf0-pc1           -1
    REST add portgroup to vns                   X                               X3                              leaf0-pc2           -1  
    REST add portgroup to vns                   X                               X1                              leaf1-pc2           -1  
    REST add dhcp relay                         X                               X3                              10.251.1.9
    sleep                                       1
    ${result} =                                 REST show forwarding dhcp table
    REST get l3 cidr route info                 10.251.1.0                      255.255.255.0
    ${dhcpip} =                                 Set Variable                    ${result[0]['dhcp-ip']}
    ${routerip} =                               Set Variable                    ${result[0]['router-ip']}
    Should Be Equal                             ${dhcpip}                       10.251.1.9
    Should Be Equal                             ${routerip}                     10.251.3.1
    BASH ifup intf                              h1-rack0                        bond0
    BASH ifup intf                              h2-rack0                        bond0
    BASH ifup intf                              h2-rack1                        bond0
    BASH ifconfig ip address                    h1-rack0                        10.251.1.9/24           bond0
    sleep                                       1
    BASH start service                          h1-rack0                        isc-dhcp-server
    ${value} =                                  BASH check service status       h1-rack0                        isc-dhcp-server    
    BASH add route                              h1-rack0                        10.251.2.0/24           10.251.1.1
    BASH add route                              h1-rack0                        10.251.3.0/24           10.251.1.1
    sleep                                       1
    ${value} =                                  BASH release dhcpv4 address     h2-rack0                bond0
    Should Be True                              ${value}
    sleep                                       1
    ${ipAddr2} =                                BASH renew dhcpv4 address       h2-rack0                bond0
    Should Not Be Empty                         ${ipAddr2}
    ${value} =                                  BASH release dhcpv4 address     h2-rack1                bond0
    Should Be True                              ${value}
    sleep                                       1
    ${ipAddr3} =                                BASH renew dhcpv4 address       h2-rack1                bond0
    Should Not Be Empty                         ${ipAddr3}
    sleep                                       1
    BASH ping                                   h1-rack0                        ${ipAddr2}               count=10
    BASH ping                                   h1-rack0                        ${ipAddr3}               count=10
    ${loss} =                                   BASH ping                       h1-rack0                 ${ipAddr2}           count=10
    Should Be True                              ${loss} == 0    
    ${loss} =                                   BASH ping                       h1-rack0                 ${ipAddr3}           count=10
    Should Be True                              ${loss} == 0    
    REST delete portgroup from vns              X                               X1                       leaf1-pc2               -1
    sleep                                       1
    ${loss} =                                   BASH ping                       h1-rack0                 ${ipAddr3}           count=10
    Should Be True                              ${loss} == 100
    ${value} =                                  BASH release dhcpv4 address     h2-rack1                bond0
    Should Be True                              ${value}
    sleep                                       1
    ${ipAddr3} =                                BASH renew dhcpv4 address       h2-rack1                bond0
    Should Be Empty                             ${ipAddr3}
    sleep                                       1
    REST add portgroup to vns                   X                               X1                      leaf1-pc2           -1
    ${ipAddr3} =                                BASH renew dhcpv4 address       h2-rack1                bond0
    Should Not Be Empty                         ${ipAddr3}
    ${loss} =                                   BASH ping                       h1-rack0                 ${ipAddr3}           count=10
    Should Be True                              ${loss} < 50    
    REST delete vns                             X                               X3
    sleep                                       1
    ${loss} =                                   BASH ping                       h1-rack0                 ${ipAddr2}           count=10
    Should Be True                              ${loss} == 100    
    ${value} =                                  BASH release dhcpv4 address     h2-rack0                bond0
    Should Be True                              ${value}
    sleep                                       1
    ${ipAddr4} =                                BASH renew dhcpv4 address       h2-rack0                bond0
    Should Be Empty                             ${ipAddr4}
    REST add vns                                X                               X3
    ${ipAddr4} =                                BASH renew dhcpv4 address       h2-rack0                bond0
    Should Be Empty                             ${ipAddr4}
    ${loss} =                                   BASH ping                       h1-rack0                        ${ipAddr2}               count=10
    Should Be True                              ${loss} == 100
    REST add portgroup to vns                   X                               X3                              leaf0-pc2           -1  
    ${ipAddr4} =                                BASH renew dhcpv4 address       h2-rack0                bond0
    Should Not Be Empty                         ${ipAddr4}
    ${loss} =                                   BASH ping                       h1-rack0                 ${ipAddr4}           count=10
    Should Be True                              ${loss} < 50    
    REST delete vns ip                          X                               X1                      10.251.1.1              24
    sleep                                       1    
    ${loss} =                                   BASH ping                       h1-rack0                 ${ipAddr4}           count=10
    Should Be True                              ${loss} == 100
    ${loss} =                                   BASH ping                       h1-rack0                 ${ipAddr2}           count=10
    Should Be True                              ${loss} == 0 
    ${value} =                                  BASH release dhcpv4 address     h2-rack1                bond0
    Should Be True                              ${value}
    sleep                                       1
    ${ipAddr3} =                                BASH renew dhcpv4 address       h2-rack1                bond0
    Should Not Be Empty                         ${ipAddr3}
    ${value} =                                  BASH release dhcpv4 address     h2-rack0                bond0
    Should Be True                              ${value}
    sleep                                       1
    ${ipAddr4} =                                BASH renew dhcpv4 address       h2-rack0                bond0
    Should Be Empty                             ${ipAddr4}
    REST add vns ip                             X                               X1                      10.251.1.1              24
    sleep                                       1    
    ${value} =                                  BASH release dhcpv4 address     h2-rack1                bond0
    Should Be True                              ${value}
    sleep                                       1
    ${ipAddr3} =                                BASH renew dhcpv4 address       h2-rack1                bond0
    Should Not Be Empty                         ${ipAddr3}
    ${value} =                                  BASH release dhcpv4 address     h2-rack0                bond0
    Should Be True                              ${value}
    sleep                                       1
    ${ipAddr4} =                                BASH renew dhcpv4 address       h2-rack0                bond0
    Should Not Be Empty                         ${ipAddr4}
    ${loss} =                                   BASH ping                       h1-rack0                 ${ipAddr4}           count=10
    Should Be True                              ${loss} == 0
    ${loss} =                                   BASH ping                       h1-rack0                 ${ipAddr2}           count=10
    Should Be True                              ${loss} == 0         
    REST delete tenant                          X
    sleep                                       1
    ${value} =                                  BASH release dhcpv4 address     h2-rack1                bond0
    sleep                                       1
    ${ipAddr5} =                                BASH renew dhcpv4 address       h2-rack1                bond0
    Should Be Empty                             ${ipAddr5}
    ${value} =                                  BASH release dhcpv4 address     h2-rack0                bond0
    sleep                                       1
    ${ipAddr6} =                                BASH renew dhcpv4 address       h2-rack0                bond0
    Should Be Empty                             ${ipAddr6}
    ${loss} =                                   BASH ping                       h1-rack0                 ${ipAddr4}           count=10
    Should Be True                              ${loss} == 100
    ${loss} =                                   BASH ping                       h1-rack0                 ${ipAddr2}           count=10
    Should Be True                              ${loss} == 100      
    REST add tenant                             X
    REST add vns                                X                           X1
    REST add vns                                X                           X2
    REST add vns                                X                           X3
    REST add vns ip                             X                           X1              10.251.1.1              24  
    REST add vns ip                             X                           X2              10.251.2.1              24  
    REST add vns ip                             X                           X3              10.251.3.1              24  
    REST add portgroup to vns                   X                           X1                              leaf0-pc1           -1
    REST add portgroup to vns                   X                           X3                              leaf0-pc2           -1  
    REST add portgroup to vns                   X                           X1                              leaf1-pc2           -1  
    REST add dhcp relay                         X                           X3                              10.251.1.9
    sleep                                       1
    ${value} =                                  BASH release dhcpv4 address     h2-rack1                bond0
    sleep                                       1
    ${ipAddr5} =                                BASH renew dhcpv4 address       h2-rack1                bond0
    Should Not Be Empty                         ${ipAddr5}
    ${value} =                                  BASH release dhcpv4 address     h2-rack0                bond0
    sleep                                       1
    ${ipAddr6} =                                BASH renew dhcpv4 address       h2-rack0                bond0
    Should Not Be Empty                         ${ipAddr6}
    ${loss} =                                   BASH ping                       h1-rack0                 ${ipAddr4}           count=10
    Should Be True                              ${loss} == 0
    ${loss} =                                   BASH ping                       h1-rack0                 ${ipAddr6}           count=10
    Should Be True                              ${loss} == 0     
    
    
   

Controller HA failover with L3 intra tenant across rack tagged with dhcp-relay
    REST add portgroup to vns                   X                               X1          leaf0-pc1           1001
    REST add portgroup to vns                   X                               X2          leaf1-pc2           2002 
    REST add dhcp relay                         X                               X2                      10.251.1.9
    REST add dhcprelay circuitid                X                               X2                      10.251.1.9              private vns X2
    sleep                                       1
    ${result} =                                 REST show forwarding dhcp table
    ${circuitid} =                              Set Variable                    ${result[0]['circuit-id']}
    ${dhcpip} =                                 Set Variable                    ${result[0]['dhcp-ip']}
    ${routerip} =                               Set Variable                    ${result[0]['router-ip']}
    Should Be Equal                             ${circuitid}                    private vns X2
    Should Be Equal                             ${dhcpip}                       10.251.1.9
    Should Be Equal                             ${routerip}                     10.251.2.1
    BASH add tag                                h1-rack0                        bond0                   1001
    BASH add tag                                h2-rack1                        bond0                   2002
    BASH ifup intf                              h1-rack0                        bond0.1001
    BASH ifup intf                              h2-rack1                        bond0.2002
    BASH ifconfig ip address                    h1-rack0                        10.251.1.9/24           bond0.1001
    BASH start service                          h1-rack0                        isc-dhcp-server
    ${value} =                                  BASH check service status       h1-rack0                        isc-dhcp-server    
    sleep                                       1
    BASH add route                              h1-rack0                        10.251.2.0/24           10.251.1.1
    BASH add route                              h1-rack0                        10.251.3.0/24           10.251.1.1
    sleep                                       1
    ${value} =                                  BASH release dhcpv4 address     h2-rack1                bond0.2002
    Should Be True                              ${value}
    sleep                                       1
    ${ipAddr} =                                 BASH renew dhcpv4 address       h2-rack1                bond0.2002
    Should Not Be Empty                         ${ipAddr}
    sleep                                       1
    BASH ping                                   h1-rack0                        ${ipAddr}               count=10
    ${value} =                                  BASH verify arp                 h1-rack0                10.251.1.1
    Should Be True                              ${value}        
    ${value} =                                  BASH verify arp                 h2-rack1                10.251.2.1
    Should Be True                              ${value}    
    ${mac1} =                                   BASH get intf mac               h1-rack0                      bond0.1001
    ${result} =                                 REST show endpoints mac         ${mac1}
    Should Be True                              ${result}                       
    ${mac2} =                                   BASH get intf mac               h2-rack1                      bond0.2002
    ${result} =                                 REST show endpoints mac         ${mac2}
    Should Be True                              ${result}                       
    ${loss} =                                   BASH ping                       h1-rack0                      ${ipAddr}           count=10
    Should Be True                              ${loss} == 0    
    ${value} =                                  REST verify cluster election take leader
    Should Be True                              ${value}
    sleep                                       10
    ${value} =                                  BASH release dhcpv4 address     h2-rack1                bond0.2002
    Should Be True                              ${value}
    sleep                                       1
    ${ipAddr} =                                 BASH renew dhcpv4 address       h2-rack1                bond0.2002
    Should Not Be Empty                         ${ipAddr}
    sleep                                       1
    ${loss} =                                   BASH ping                       h1-rack0                      ${ipAddr}           count=10
    Should Be True                              ${loss} == 0    


Controller HA failover with L3 inter tenant across rack tagged with dhcp-relay
    REST add portgroup to vns                   X                               X1                      leaf0-pc1           1001
    REST add portgroup to vns                   Y                               Y3                      leaf1-pc2           2002 
    REST add dhcp relay                         Y                               Y3                      10.251.1.9
    sleep                                       1
    ${result} =                                 REST show forwarding dhcp table
    ${dhcpip} =                                 Set Variable                    ${result[0]['dhcp-ip']}
    ${routerip} =                               Set Variable                    ${result[0]['router-ip']}
    Should Be Equal                             ${dhcpip}                       10.251.1.9
    Should Be Equal                             ${routerip}                     10.252.3.1
    BASH add tag                                h1-rack0                        bond0                   1001
    BASH add tag                                h2-rack1                        bond0                   2002
    BASH ifup intf                              h1-rack0                        bond0.1001
    BASH ifup intf                              h2-rack1                        bond0.2002
    BASH ifconfig ip address                    h1-rack0                        10.251.1.9/24           bond0.1001
    BASH start service                          h1-rack0                        isc-dhcp-server
    ${value} =                                  BASH check service status       h1-rack0                        isc-dhcp-server    
    sleep                                       1
    BASH add route                              h1-rack0                        10.252.0.0/16           10.251.1.1
    sleep                                       1
    ${value} =                                  BASH release dhcpv4 address     h2-rack1                bond0.2002
    Should Be True                              ${value}
    sleep                                       1
    ${ipAddr} =                                 BASH renew dhcpv4 address       h2-rack1                bond0.2002
    Should Not Be Empty                         ${ipAddr}
    sleep                                       1
    BASH ping                                   h1-rack0                        ${ipAddr}               count=10
    ${value} =                                  BASH verify arp                 h1-rack0                10.251.1.1
    Should Be True                              ${value}        
    ${value} =                                  BASH verify arp                 h2-rack1                10.252.3.1
    Should Be True                              ${value}    
    ${mac1} =                                   BASH get intf mac               h1-rack0                      bond0.1001
    ${result} =                                 REST show endpoints mac         ${mac1}
    Should Be True                              ${result}                       
    ${mac2} =                                   BASH get intf mac               h2-rack1                      bond0.2002
    ${result} =                                 REST show endpoints mac         ${mac2}
    Should Be True                              ${result}                       
    ${loss} =                                   BASH ping                       h1-rack0                      ${ipAddr}           count=10
    Should Be True                              ${loss} == 0    
    ${value} =                                  REST verify cluster election take leader
    Should Be True                              ${value}
    sleep                                       10
    ${value} =                                  BASH release dhcpv4 address     h2-rack1                bond0.2002
    Should Be True                              ${value}
    sleep                                       1
    ${ipAddr} =                                 BASH renew dhcpv4 address       h2-rack1                bond0.2002
    Should Not Be Empty                         ${ipAddr}
    sleep                                       1
    ${loss} =                                   BASH ping                       h1-rack0                      ${ipAddr}           count=10
    Should Be True                              ${loss} == 0    
    
initialize host
    BASH run command                                h1-rack0                                ifdown bond0
    BASH run command                                h2-rack0                                ifdown bond0
    BASH run command                                h3-rack0                                ifdown bond0
    BASH run command                                h1-rack1                                ifdown bond0
    BASH run command                                h2-rack1                                ifdown bond0
    BASH run command                                h3-rack1                                ifdown bond0
    BASH run command                                h1-rack2                                ifdown bond0
    BASH run command                                h2-rack2                                ifdown bond0
    BASH run command                                h3-rack2                                ifdown bond0
    sleep                                       1
    BASH run command                                h1-rack0                                ifup eth2
    sleep                                           1
    BASH run command                                h1-rack0                                ifup eth3
    BASH run command                                h2-rack0                                ifup eth2
    sleep                                           1
    BASH run command                                h2-rack0                                ifup eth3
    BASH run command                                h3-rack0                                ifup eth2
    sleep                                           1
    BASH run command                                h3-rack0                                ifup eth3
    BASH run command                                h1-rack1                                ifup eth2
    sleep                                           1
    BASH run command                                h1-rack1                                ifup eth3
    BASH run command                                h2-rack1                                ifup eth2
    sleep                                           1
    BASH run command                                h2-rack1                                ifup eth3
    BASH run command                                h3-rack1                                ifup eth2
    sleep                                           1
    BASH run command                                h3-rack1                                ifup eth3
    BASH run command                                h1-rack2                                ifup eth2
    sleep                                           1
    BASH run command                                h1-rack2                                ifup eth3
    BASH run command                                h2-rack2                                ifup eth2
    sleep                                           1
    BASH run command                                h2-rack2                                ifup eth3
    BASH run command                                h3-rack2                                ifup eth2
    sleep                                           1
    BASH run command                                h3-rack2                                ifup eth3
      
	BASH ifup intf							    h1-rack0 								bond0
	BASH ifup intf							    h2-rack0								bond0
	BASH ifup intf							    h3-rack0								bond0
	BASH ifup intf							    h1-rack1								bond0
	BASH ifup intf							    h2-rack1								bond0
	BASH ifup intf							    h3-rack1								bond0
	BASH ifup intf                              h1-rack2                                bond0
    BASH ifup intf                              h2-rack2                                bond0
    BASH ifup intf                              h3-rack2                                bond0
    
    BASH init intf                              h1-rack0                                bond0
    BASH init intf                              h2-rack0                                bond0
    BASH init intf                              h3-rack0                                bond0
    BASH init intf                              h1-rack1                                bond0
    BASH init intf                              h2-rack1                                bond0
    BASH init intf                              h3-rack1                                bond0
    BASH init intf                              h1-rack2                                bond0
    BASH init intf                              h2-rack2                                bond0
    BASH init intf                              h3-rack2                                bond0
    BASH stop service                           h1-rack0                        isc-dhcp-server

setup topology
	initialize host
	REST add tenant								system
	REST add tenant                             External
	REST add tenant 							X
	REST add tenant								Y
	REST add tenant								Z
	REST add vns								X							X1
	REST add vns								X							X2
	REST add vns								X							X3
    REST add vns                                X                           X192
    REST add vns                                X                           X224
	REST add vns								Y							Y1
	REST add vns								Y							Y2
	REST add vns								Y							Y3
    REST add vns                                Y                           Y192
    REST add vns                                Y                           Y224
	REST add vns								Z							Z1
	REST add vns								Z							Z2
	REST add vns								Z						    Z3
    REST add vns                                Z                           Z192
    REST add vns                                Z                           Z224

	REST add vns								External				    Arista1-e13
	REST add vns								External				    Arista1-e14
    REST add vns                                External                    Arista1-e15
    REST add vns                                External                    Arista1-e16
    REST add vns                                External                    Arista1-e21
    REST add vns                                External                    Arista1-e22
    REST add vns                                External                    Arista1-e23
    REST add vns                                External                    Arista1-e24
    REST add vns                                External                    Arista1-e25
    REST add vns                                External                    Arista1-e26
	REST add vns                                External                    Arista1-e27
    REST add vns                                External                    Arista1-e28
	REST add vns                                External                    Arista1-e29
    REST add vns                                External                    Arista1-e30
    REST add vns                                External                    Arista1-pc1
    REST add vns                                External                    Arista1-pc2
    REST add vns                                External                    Arista1-pc3
    REST add vns                                External                    Arista1-pc4
    REST add vns                                External                    Arista1-pc5	
    REST add vns                                External                    Arista2-e13
    REST add vns                                External                    Arista2-e14
    REST add vns                                External                    Arista2-e15
    REST add vns                                External                    Arista2-e16
    REST add vns                                External                    Arista2-e21
    REST add vns                                External                    Arista2-e22
    REST add vns                                External                    Arista2-e23
    REST add vns                                External                    Arista2-e24
    REST add vns                                External                    Arista2-e25
    REST add vns                                External                    Arista2-e26
    REST add vns                                External                    Arista2-e27
    REST add vns                                External                    Arista2-e28
    REST add vns                                External                    Arista2-e29
    REST add vns                                External                    Arista2-e30
    REST add vns                                External                    Arista2-pc1
    REST add vns                                External                    Arista2-pc2
    REST add vns                                External                    Arista2-pc3
    REST add vns                                External                    Arista2-pc4
    REST add vns                                External                    Arista2-pc5  	
    REST add vns                                External                    external-vrrp
    REST add vns                                External                    External-Host
	REST add router intf							X							X1
	REST add router intf							X							X2
	REST add router intf							X							X3
	REST add router intf                            X                           X192
    REST add router intf                            X                           X224
    
	REST add router intf							Y							Y1
	REST add router intf							Y							Y2
	REST add router intf							Y							Y3
	REST add router intf                            Y                           Y192
    REST add router intf                            Y                           Y224
    
	REST add router intf							Z							Z1
	REST add router intf							Z							Z2
	REST add router intf							Z							Z3
	REST add router intf                            Z                           Z192
    REST add router intf                            Z                           Z224
    
    REST add router intf                                External                   Arista1-e13
    REST add router intf                                External                   Arista1-e14
    REST add router intf                                External                   Arista1-e15
    REST add router intf                                External                   Arista1-e16
    REST add router intf                                External                   Arista1-e21
    REST add router intf                                External                   Arista1-e22
    REST add router intf                                External                   Arista1-e23
    REST add router intf                                External                   Arista1-e24
    REST add router intf                                External                   Arista1-e25
    REST add router intf                                External                   Arista1-e26
    REST add router intf                                External                   Arista1-e27
    REST add router intf                                External                   Arista1-e28
    REST add router intf                                External                   Arista1-e29
    REST add router intf                                External                   Arista1-e30
    REST add router intf                                External                   Arista1-pc1
    REST add router intf                                External                   Arista1-pc2
    REST add router intf                                External                   Arista1-pc3
    REST add router intf                                External                   Arista1-pc4
    REST add router intf                                External                   Arista1-pc5  
    REST add router intf                                External                   Arista2-e13
    REST add router intf                                External                   Arista2-e14
    REST add router intf                                External                   Arista2-e15
    REST add router intf                                External                   Arista2-e16
    REST add router intf                                External                   Arista2-e21
    REST add router intf                                External                   Arista2-e22
    REST add router intf                                External                   Arista2-e23
    REST add router intf                                External                   Arista2-e24
    REST add router intf                                External                   Arista2-e25
    REST add router intf                                External                   Arista2-e26
    REST add router intf                                External                   Arista2-e27
    REST add router intf                                External                   Arista2-e28
    REST add router intf                                External                   Arista2-e29
    REST add router intf                                External                   Arista2-e30
    REST add router intf                                External                   Arista2-pc1
    REST add router intf                                External                   Arista2-pc2
    REST add router intf                                External                   Arista2-pc3
    REST add router intf                                External                   Arista2-pc4
    REST add router intf                                External                   Arista2-pc5      
    REST add router intf                                External                   external-vrrp
    REST add router intf                                External                   External-Host

	REST add vns ip  								X							X1				10.251.1.1				24	
	REST add vns ip  								X							X2				10.251.2.1				24	
	REST add vns ip  								X							X3				10.251.3.1				24
	REST add vns ip                                 X                           X192            10.251.192.1            19
    REST add vns ip                                 X                           X224            10.251.224.1            19
	REST add vns ip  								Y							Y1				10.252.1.1				24	
	REST add vns ip  								Y							Y2				10.252.2.1				24	
	REST add vns ip  								Y							Y3				10.252.3.1				24	
    REST add vns ip                                 Y                           Y192            10.252.192.1            19
    REST add vns ip                                 Y                           Y224            10.252.224.1            19

	REST add vns ip  								Z							Z1				10.253.1.1				24	
	REST add vns ip  								Z							Z2				10.253.2.1				24	
	REST add vns ip  								Z							Z3				10.253.3.1				24	
    REST add vns ip                                 Z                           Z192            10.253.192.1            19
    REST add vns ip                                 Z                           Z224            10.253.224.1            19

    REST add vns ip             External                   Arista1-e13          10.99.13.2          24
    REST add vns ip             External                   Arista1-e14          10.99.14.2          24  
    REST add vns ip             External                   Arista1-e15          10.99.15.2          24
    REST add vns ip             External                   Arista1-e16          10.99.16.2          24
    REST add vns ip             External                   Arista1-e21          10.99.21.2          24
    REST add vns ip             External                   Arista1-e22          10.99.22.2          24    
    REST add vns ip             External                   Arista1-e23          10.99.23.2          24    
    REST add vns ip             External                   Arista1-e24          10.99.24.2          24    
    REST add vns ip             External                   Arista1-e25          10.99.25.2          24   
    REST add vns ip             External                   Arista1-e26          10.99.26.2          24    
    REST add vns ip             External                   Arista1-e27          10.99.27.2          24    
    REST add vns ip             External                   Arista1-e28          10.99.28.2          24    
    REST add vns ip             External                   Arista1-e29          10.99.29.2          24    
    REST add vns ip             External                   Arista1-e30          10.99.30.2          24    
    REST add vns ip             External                   Arista1-pc1          10.99.1.2           24    
    REST add vns ip             External                   Arista1-pc2          10.99.2.2           24        
    REST add vns ip             External                   Arista1-pc3          10.99.3.2           24          
    REST add vns ip             External                   Arista1-pc4          10.99.4.2           24    
    REST add vns ip             External                   Arista1-pc5          10.99.5.2           24            
    REST add vns ip             External                   Arista2-e13          10.98.13.2          24        
    REST add vns ip             External                   Arista2-e14          10.98.14.2          24    
    REST add vns ip             External                   Arista2-e15          10.98.15.2          24   
    REST add vns ip             External                   Arista2-e16          10.98.16.2          24    
    REST add vns ip             External                   Arista2-e21          10.98.21.2          24    
    REST add vns ip             External                   Arista2-e22          10.98.22.2          24    
    REST add vns ip             External                   Arista2-e23          10.98.23.2          24    
    REST add vns ip             External                   Arista2-e24          10.98.24.2          24    
    REST add vns ip             External                   Arista2-e25          10.98.25.2          24    
    REST add vns ip             External                   Arista2-e26          10.98.26.2          24    
    REST add vns ip             External                   Arista2-e27          10.98.27.2          24    
    REST add vns ip             External                   Arista2-e28          10.98.28.2          24    
    REST add vns ip             External                   Arista2-e29          10.98.29.2          24    
    REST add vns ip             External                   Arista2-e30          10.98.30.2          24    
    REST add vns ip             External                   Arista2-pc1          10.98.1.2           24    
    REST add vns ip             External                   Arista2-pc2          10.98.2.2           24         
    REST add vns ip             External                   Arista2-pc3          10.98.3.2           24        
    REST add vns ip             External                   Arista2-pc4          10.98.4.2           24        
    REST add vns ip             External                   Arista2-pc5          10.98.5.2           24              
    REST add vns ip             External                   external-vrrp        10.99.99.5          24   
    REST add vns ip             External                   External-Host        10.254.99.1         24    
	REST add nexthop group                          External                        ecmp-A1
    REST add nexthop group                          External                        ecmp-A16
    REST add nexthopGroup ip                        External                        ecmp-A1                 10.99.3.1
    REST add nexthopGroup ip                        External                        ecmp-A1                 10.99.5.1
    REST add nexthopGroup ip                        External                        ecmp-A16                10.98.21.1
    REST add nexthopGroup ip                        External                        ecmp-A16                10.98.22.1
    REST add nexthopGroup ip                        External                        ecmp-A16                10.98.23.1
    REST add nexthopGroup ip                        External                        ecmp-A16                10.98.24.1
    REST add nexthopGroup ip                        External                        ecmp-A16                10.98.25.1
    REST add nexthopGroup ip                        External                        ecmp-A16                10.98.26.1
    REST add nexthopGroup ip                        External                        ecmp-A16                10.98.27.1
    REST add nexthopGroup ip                        External                        ecmp-A16                10.98.28.1
    REST add nexthopGroup ip                        External                        ecmp-A16                10.99.21.1
    REST add nexthopGroup ip                        External                        ecmp-A16                10.99.22.1
    REST add nexthopGroup ip                        External                        ecmp-A16                10.99.23.1
    REST add nexthopGroup ip                        External                        ecmp-A16                10.99.24.1
    REST add nexthopGroup ip                        External                        ecmp-A16                10.99.25.1
    REST add nexthopGroup ip                        External                        ecmp-A16                10.99.26.1
    REST add nexthopGroup ip                        External                        ecmp-A16                10.99.27.1
    REST add nexthopGroup ip                        External                        ecmp-A16                10.99.28.1
	REST add static routes							External						10.98.0.0/24			{"next-hop-group": "ecmp-A1"}
	REST add static routes                          External                        10.99.255.0/24          {"next-hop-group": "ecmp-A16"}
    REST add interface to vns           External            Arista1-e13         leaf0-a     ethernet23      -1
    REST add interface to vns           External            Arista1-e14         leaf0-b     ethernet23      -1
    REST add interface to vns           External            Arista1-e15         leaf2-a     ethernet23      -1
    REST add interface to vns           External            Arista1-e16         leaf2-b     ethernet23      -1
    REST add interface to vns           External            Arista1-e21         leaf2-a     ethernet35      -1
    REST add interface to vns           External            Arista1-e22         leaf2-a     ethernet36      -1
    REST add interface to vns           External            Arista1-e23         leaf2-a     ethernet37      -1
    REST add interface to vns           External            Arista1-e24         leaf2-a     ethernet38      -1
    REST add interface to vns           External            Arista1-e25         leaf2-a     ethernet39      -1
    REST add interface to vns           External            Arista1-e26         leaf2-a     ethernet40      -1
    REST add interface to vns           External            Arista1-e27         leaf2-a     ethernet41      -1
    REST add interface to vns           External            Arista1-e28         leaf2-a     ethernet42      -1
    REST add interface to vns           External            Arista1-e29         leaf2-a     ethernet43      -1
    REST add interface to vns           External            Arista1-e30         leaf2-a     ethernet44      -1
    REST add portgroup to vns           External            Arista1-pc1         Arista1-pc1             -1
    REST add portgroup to vns           External            Arista1-pc2         Arista1-pc2             -1
    REST add portgroup to vns           External            Arista1-pc3         Arista1-pc3             -1
    REST add portgroup to vns           External            Arista1-pc4         Arista1-pc4             -1
    REST add portgroup to vns           External            Arista1-pc5         Arista1-pc5             -1
    REST add interface to vns           External            Arista2-e13         leaf1-a     ethernet23      -1
    REST add interface to vns           External            Arista2-e14         leaf1-a     ethernet15      -1
    REST add interface to vns           External            Arista2-e14         leaf1-b     ethernet23      -1
    REST add interface to vns           External            Arista2-e15         leaf0-a     ethernet24      -1
    REST add interface to vns           External            Arista2-e16         leaf0-b     ethernet24      -1
    REST add interface to vns           External            Arista2-e21         leaf2-b     ethernet35      -1
    REST add interface to vns           External            Arista2-e22         leaf2-b     ethernet36      -1
    REST add interface to vns           External            Arista2-e23         leaf2-b     ethernet37      -1
    REST add interface to vns           External            Arista2-e24         leaf2-b     ethernet38      -1
    REST add interface to vns           External            Arista2-e25         leaf2-b     ethernet39      -1
    REST add interface to vns           External            Arista2-e26         leaf2-b     ethernet40      -1
    REST add interface to vns           External            Arista2-e27         leaf2-b     ethernet41      -1
    REST add interface to vns           External            Arista2-e28         leaf2-b     ethernet42      -1
    REST add interface to vns           External            Arista2-e29         leaf2-b     ethernet43      -1
    REST add interface to vns           External            Arista2-e30         leaf2-b     ethernet44      -1
    REST add portgroup to vns           External            Arista2-pc1         Arista2-pc1             -1
    REST add portgroup to vns           External            Arista2-pc2         Arista2-pc2             -1
    REST add portgroup to vns           External            Arista2-pc3         Arista2-pc3             -1
    REST add portgroup to vns           External            Arista2-pc4         Arista2-pc4             -1
    REST add portgroup to vns           External            Arista2-pc5         Arista2-pc5             -1
    REST add interface to vns           External            external-vrrp       leaf1-a         ethernet31      -1
    REST add interface to vns           External            external-vrrp       leaf1-b         ethernet31      -1
    REST add interface to vns           External            external-vrrp       leaf2-b         ethernet31      -1
    # REST add portgroup to vns       X           X1          leaf0-pc1           -1
    # REST add portgroup to vns       X           X1          leaf1-pc1           -1
    # REST add interface to vns       X           X1          leaf1-a             ethernet33      1
    # REST add interface to vns       X           X1          leaf2-a             ethernet33      1
    # REST add interface to vns       X           X192        leaf0-a             ethernet33      -1
    # REST add portgroup to vns       X           X2          leaf0-pc2           -1
    # REST add portgroup to vns       X           X2          leaf1-pc3           -1
    # REST add interface to vns       X           X2          leaf1-a             ethernet33      2
    # REST add interface to vns       X           X2          leaf2-a             ethernet33      2
    # REST add interface to vns       X           X224        leaf0-b             ethernet33      -1
    # REST add interface to vns       X           X3          leaf1-a             ethernet33      3
    # REST add interface to vns       X           X3          leaf2-a             ethernet33      3
    # REST add interface to vns       Y           Y192        leaf1-a             ethernet33      -1
    # REST add interface to vns       Y           X224        leaf1-b             ethernet33      -1
    # REST add portgroup to vns       Y           Y2          leaf1-pc2               -1
    # REST add portgroup to vns       Y           Y2          leaf1-pc3               -1  
    # REST add interface to vns       Z           Y192        leaf2-a             ethernet33      -1
    # REST add interface to vns       Z           X224        leaf2-b             ethernet33      -1
    # REST add portgroup to vns       Z           Z3          leaf2-pc3               -1
    #REST add interface to vns               X                   X192             leaf0-a    ethernet33          -1
    #REST add interface to vns               X                   X224             leaf0-b    ethernet33          -1
    #REST add interface to vns               Y                   Y192             leaf1-a    ethernet33          -1
    #REST add interface to vns               Y                   Y224             leaf1-b    ethernet33          -1
    #REST add interface to vns               Z                   Z192             leaf2-a    ethernet33          -1
    #REST add interface to vns               Z                   Z224             leaf2-b    ethernet33          -1
    REST add tenant routers intf to system          X
    REST add tenant routers intf to system          Y
    REST add tenant routers intf to system          Z
    REST add tenant routers intf to system          External
    REST add system intf to tenant routers          External
    REST add system intf to tenant routers          X
    REST add system intf to tenant routers          Y
    REST add system intf to tenant routers          Z
    REST add static routes                          X                           0.0.0.0/0           {"tenant": "system"}
    REST add static routes                          Y                           0.0.0.0/0           {"tenant": "system"}
    REST add static routes                          Z                           0.0.0.0/0           {"tenant": "system"}
    REST add static routes                          External                    10.251.0.0/16       {"tenant": "system"}
    REST add static routes                          External                    10.252.0.0/16       {"tenant": "system"}
    REST add static routes                          External                    10.253.0.0/16       {"tenant": "system"}

  	
teardown topology
	delete traffic
    initialize host

T5 base suite setup
	base suite setup
	add fabric switch
	sleep 											5
#	add ntp timezone                                master
	${result} = 									CLI verify controller		s1							c1		
	Should Be True									${result}
	${result} = 									CLI verify controller   	s1							c2
	Should Be True									${result}
	${result} = 									CLI verify controller       s2							c1
	Should Be True									${result}
	${result} = 									CLI verify controller       s2							c2
	Should Be True									${result}
	${result} = 									CLI verify controller       s3							c1
	Should Be True									${result}
	${result} = 									CLI verify controller       s3							c2
	Should Be True									${result}
	${result} = 									CLI verify controller       s4							c1
	Should Be True									${result}
	${result} = 									CLI verify controller       s4							c2
	Should Be True									${result}
	${result} = 									CLI verify controller       s5							c1
	Should Be True									${result}
	${result} = 									CLI verify controller       s5							c2
	Should Be True									${result}
	${result} = 									CLI verify controller       s7							c1
	Should Be True									${result}
	${result} = 									CLI verify controller       s7							c2
	Should Be True									${result}
	${result} = 									CLI verify controller       s8							c1
	Should Be True									${result}
	${result} = 									CLI verify controller       s8							c2
	Should Be True									${result}
	${result} = 									CLI verify controller       s9							c1
	Should Be True									${result}
	${result} = 									CLI verify controller       s9							c2
	Should Be True									${result}
    REST add portgroup                      Arista1-pc1
    REST add portgroup                      Arista1-pc2
    REST add portgroup                      Arista1-pc3
    REST add portgroup                      Arista1-pc4
    REST add portgroup                      Arista1-pc5
    REST add portgroup                      Arista2-pc1
    REST add portgroup                      Arista2-pc2
    REST add portgroup                      Arista2-pc3
    REST add portgroup                      Arista2-pc4
    REST add portgroup                      Arista2-pc5
    REST add portgroup                      leaf0-pc1
    REST add portgroup                      leaf0-pc2
    REST add portgroup                      leaf0-pc3
    REST add portgroup                      leaf1-pc1
    REST add portgroup                      leaf1-pc2
    REST add portgroup                      leaf1-pc3
    REST add portgroup                      leaf2-pc1
    REST add portgroup                      leaf2-pc2
    REST add portgroup                      leaf2-pc3
    REST add portgroup lacp                 Arista1-pc1
    REST add portgroup lacp                 Arista1-pc2
    REST add portgroup lacp                 Arista1-pc3
    REST add portgroup lacp                 Arista1-pc4
    REST add portgroup lacp                 Arista1-pc5
    REST add portgroup lacp                 Arista2-pc1
    REST add portgroup lacp                 Arista2-pc2
    REST add portgroup lacp                 Arista2-pc3
    REST add portgroup lacp                 Arista2-pc4
    REST add portgroup lacp                 Arista2-pc5
    REST add portgroup lacp                 leaf0-pc1
    REST add portgroup lacp                 leaf0-pc2
    REST add portgroup lacp                 leaf0-pc3
    REST add portgroup lacp                 leaf1-pc1
    REST add portgroup lacp                 leaf1-pc2
    REST add portgroup lacp                 leaf1-pc3
    REST add portgroup lacp                 leaf2-pc1
    REST add portgroup lacp                 leaf2-pc2
    REST add portgroup lacp                 leaf2-pc3
    REST add interface to portgroup      leaf0-a     ethernet17    Arista1-pc1         
    REST add interface to portgroup      leaf0-b     ethernet17    Arista1-pc1         
    REST add interface to portgroup      leaf0-a     ethernet18    Arista1-pc2         
    REST add interface to portgroup      leaf0-b     ethernet18    Arista1-pc2         
    REST add interface to portgroup      leaf1-a     ethernet17    Arista1-pc3         
    REST add interface to portgroup      leaf1-a     ethernet19    Arista1-pc3         
    REST add interface to portgroup      leaf1-a     ethernet11    Arista1-pc4         
    REST add interface to portgroup      leaf1-a     ethernet13    Arista1-pc4         
    REST add interface to portgroup      leaf1-b     ethernet17    Arista1-pc4         
    REST add interface to portgroup      leaf1-b     ethernet19    Arista1-pc4         
    REST add interface to portgroup      leaf2-a     ethernet17    Arista1-pc5         
    REST add interface to portgroup      leaf2-a     ethernet19    Arista1-pc5         
    REST add interface to portgroup      leaf2-b     ethernet17    Arista1-pc5         
    REST add interface to portgroup      leaf2-b     ethernet19    Arista1-pc5         
    REST add interface to portgroup      leaf0-a     ethernet19    Arista2-pc1         
    REST add interface to portgroup      leaf0-b     ethernet19    Arista2-pc1         
    REST add interface to portgroup      leaf0-a     ethernet20    Arista2-pc2         
    REST add interface to portgroup      leaf0-b     ethernet20    Arista2-pc2         
    REST add interface to portgroup      leaf1-a     ethernet18    Arista2-pc3         
    REST add interface to portgroup      leaf1-a     ethernet20    Arista2-pc3         
    REST add interface to portgroup      leaf1-a     ethernet12    Arista2-pc4         
    REST add interface to portgroup      leaf1-a     ethernet14    Arista2-pc4         
    REST add interface to portgroup      leaf1-b     ethernet18    Arista2-pc4         
    REST add interface to portgroup      leaf1-b     ethernet20    Arista2-pc4         
    REST add interface to portgroup      leaf2-a     ethernet18    Arista2-pc5         
    REST add interface to portgroup      leaf2-a     ethernet20    Arista2-pc5         
    REST add interface to portgroup      leaf2-b     ethernet18    Arista2-pc5         
    REST add interface to portgroup      leaf2-b     ethernet20    Arista2-pc5         
    REST add interface to portgroup      leaf0-a     ethernet1     leaf0-pc1           
    REST add interface to portgroup      leaf0-b     ethernet1     leaf0-pc1           
    REST add interface to portgroup      leaf0-a     ethernet2     leaf0-pc2           
    REST add interface to portgroup      leaf0-b     ethernet2     leaf0-pc2           
    REST add interface to portgroup      leaf0-a     ethernet3     leaf0-pc3           
    REST add interface to portgroup      leaf0-b     ethernet3     leaf0-pc3           
    REST add interface to portgroup      leaf1-a     ethernet1     leaf1-pc1           
    REST add interface to portgroup      leaf1-a     ethernet5     leaf1-pc1           
    REST add interface to portgroup      leaf1-b     ethernet1     leaf1-pc1           
    REST add interface to portgroup      leaf1-a     ethernet2     leaf1-pc2           
    REST add interface to portgroup      leaf1-a     ethernet6     leaf1-pc2           
    REST add interface to portgroup      leaf1-b     ethernet2     leaf1-pc2           
    REST add interface to portgroup      leaf1-a     ethernet3     leaf1-pc3           
    REST add interface to portgroup      leaf1-a     ethernet7     leaf1-pc3           
    REST add interface to portgroup      leaf1-b     ethernet3     leaf1-pc3           
    REST add interface to portgroup      leaf2-a     ethernet1     leaf2-pc1           
    REST add interface to portgroup      leaf2-b     ethernet1     leaf2-pc1           
    REST add interface to portgroup      leaf2-a     ethernet2     leaf2-pc2           
    REST add interface to portgroup      leaf2-b     ethernet2     leaf2-pc2           
    REST add interface to portgroup      leaf2-a     ethernet3     leaf2-pc3           
    REST add interface to portgroup      leaf2-b     ethernet3     leaf2-pc3           

	
T5 base suite teardown
	delete fabric switch  
	REST delete portgroup                      Arista1-pc1
    REST delete portgroup                      Arista1-pc2
    REST delete portgroup                      Arista1-pc3
    REST delete portgroup                      Arista1-pc4
    REST delete portgroup                      Arista1-pc5
    REST delete portgroup                      Arista2-pc1
    REST delete portgroup                      Arista2-pc2
    REST delete portgroup                      Arista2-pc3
    REST delete portgroup                      Arista2-pc4
    REST delete portgroup                      Arista2-pc5
    REST delete portgroup                      leaf0-pc1
    REST delete portgroup                      leaf0-pc2
    REST delete portgroup                      leaf0-pc3
    REST delete portgroup                      leaf1-pc1
    REST delete portgroup                      leaf1-pc2
    REST delete portgroup                      leaf1-pc3
    REST delete portgroup                      leaf2-pc1
    REST delete portgroup                      leaf2-pc2
    REST delete portgroup                      leaf2-pc3
    REST delete tenant                         X
    REST delete tenant                         Y
    REST delete tenant                         Z
    REST delete tenant                         External
    REST delete tenant                         system
    BASH restart networking service             h1-rack0            timeout=60
    bash_restart_networking_service             h1-rack1            timeout=60


verify results   [Arguments]  ${transmitted_frames}  ${received_frames}  ${stream}  ${stream_name}
    Sleep  5
    ${report}=  fetch port stats  stream=${stream}  
    ${tx_value}=  verify dict key  ${report}  ${stream_name}  ${transmitted_frames}
    ${rx_value}=  verify dict key  ${report}  ${stream_name}  ${received_frames}
    ${in_range}=  ixia verify traffic rate  ${tx_value}  ${rx_value}
 	Log 		${in_range}
   Should be true  ${in_range}	
  	
calculate loss	 [Arguments]  ${transmitted_frames}  ${received_frames}  ${stream}  ${stream_name}
    Sleep  5
    ${report} =  	fetch port stats  	stream=${stream}  
    ${tx_value} =  	verify dict key  	${report}  ${stream_name}  ${transmitted_frames}
    ${rx_value} =  	verify dict key  	${report}  ${stream_name}  ${received_frames}
	${loss} = 		evaluate 			${tx_value} - ${rx_value}
	Log 			${loss}
	
verify traffic rate   [Arguments]  ${tx_rate}  ${rx_rate}  ${tx_intf}  ${rx_intf}
    Sleep  5
    ${report}=  fetch port stats
    Log  	${report}
    ${tx_value}=  verify dict key  ${report}  ${tx_intf}  transmitted_frame_rate
    ${rx_value}=  verify dict key  ${report}  ${rx_intf}  received_valid_frame_rate
    ixia verify traffic rate  ${tx_value}  ${rx_value}
    
verify traffic packet  [Arguments]  ${tx_cnt}  ${rx_cnt}  ${tx_intf}  ${rx_intf}
	Sleep  5
    ${report} =  	fetch port stats
    ${tx_value} =  	verify dict key  	${report}  ${tx_intf}  transmitted_frames
    ${rx_value} =  	verify dict key  	${report}  ${rx_intf}  received_valid_frames
    ${result} =  	evaluate  			${tx_value} - ${rx_value}
    Log 	${result}
#   Should Be True   -100000 < ${result} < 100000


    