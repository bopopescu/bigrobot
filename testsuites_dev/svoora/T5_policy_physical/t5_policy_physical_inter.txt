* Setting
Documentation   T5 Policy with two spine three leaf rack with dual-tor Test Suite
Suite Setup     test setup topology
Suite Teardown  test teardown topology
Test Setup      base test setup
Test Teardown   test teardown
Force Tags      IronHorse  T5  Policy
Library         keywords/BsnCommon.py
Library         keywords/Host.py
Library         keywords/T5.py
Library         keywords/T5L3.py
Library         keywords/T5Platform.py
Library		keywords/SwitchLight.py
Library 	keywords/T5Utilities.py
Library         keywords/BsnCommon.py
Library	        Collections.py
Library         keywords/Ixia.py
Resource	testsuites_dev/svoora/T5_policy_physical/t5_policy_physical_inter_variables.txt
Library         OperatingSystem
Library         Collections
Library         Dialogs



* Test Cases

###### Policy at tenant interface ############
#---------------------------------------------

T1 Interface tenant add/remove permit policy src-ip to dest-ip 
	[Tags]  feature  run
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}
	rest add policy							${tenantX}		${tenant2_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant2_polname}  seqnum=10  action=permit  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant				${tenantX}		${tenant2_polname}
	pause  FREEZZ!
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
	pause  FREEZZ!
	sleep				   5
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenantX}		${tenant2_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1


T2 Interface tenant add/removedeny policy src-ip to dest-ip 
	[Tags]  feature  deny
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}
	rest add policy							${tenantX}		${tenant2_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant2_polname}  seqnum=10  action=deny  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant				${tenantX}		${tenant2_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenantX}		${tenant2_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1


T3 Interface tenant add/remove permit policy src-ip to dest-vns
	[Tags]  feature
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}
	${dst_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX}
	rest add policy								X		${tenant2_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant2_polname}  seqnum=10  action=permit  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant					X				${tenant2_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant					X				${tenant2_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1

    

T4 Interface tenant add/remove deny policy src-ip to dest-vns
	[Tags]  feature
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}
	${dst_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX}
	rest add policy								X		${tenant2_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant2_polname}  seqnum=10  action=deny  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant					X				${tenant2_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    delete traffic
	sleep  2
	rest remove policy on tenant					X				${tenant2_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    
T5 Interface tenant add/remove permit policy src-ip to dest-tenant
	[Tags]  feature
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}
	${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=permit  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant				X				${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    delete traffic
	sleep  2
	rest remove policy on tenant				X				${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1

T6 Interface tenant add/remove deny policy src-ip to dest-tenant
	[Tags]  feature
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}
	${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=deny  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant				X				${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    delete traffic
	sleep  2
	rest remove policy on tenant				X				${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1

######  **  ANY **  ########	
T7 Interface tenant add/remove permit policy src-ip to any
	[Tags]  feature
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}
	#${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=permit  srcdata=${src_dict}   
	rest apply policy on tenant					X				${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant					X				${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    
######  **  ANY **  ########	
T8 Interface tenant add/remove deny policy src-ip to any
	[Tags]  feature
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}
	#${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=deny  srcdata=${src_dict}   
	rest apply policy on tenant					X				${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant					X				${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    
T9 Interface tenant add/remove permit policy src-tenant to dest-ip
	[Tags]  feature
	${src_dict}=  Create Dictionary  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=permit  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant					X				${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant					X				${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1

T10 Interface tenant add/remove deny policy src-tenant to dest-ip
	[Tags]  feature
	${src_dict}=  Create Dictionary  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=deny  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant					X				${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant					X				${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    
T11 Interface tenant add/remove permit policy src-tenant to dest-tenant
	[Tags]  feature
	${src_dict}=  Create Dictionary  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=permit  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant					X				${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant					X				${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    
T12 Interface tenant add/remove deny policy src-tenant to dest-tenant
	[Tags]  feature
	${src_dict}=  Create Dictionary  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=deny  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant					X				${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant					X				${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1

T13 Interface tenant add/remove permit policy src-tenant to dest-vns
	[Tags]  feature
	${src_dict}=  Create Dictionary  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=permit  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant					X				${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    delete traffic
	sleep  2
	rest remove policy on tenant					X				${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    

T14 Interface tenant add/remove deny policy src-tenant to dest-vns
	[Tags]  feature
	${src_dict}=  Create Dictionary  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=deny  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant					X				${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant					X				${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    
######  **  ANY need more investigation  **  ########	
T15 Interface tenant add/remove permit policy src-tenant to any
	[Tags]  feature
	${src_dict}=  Create Dictionary  tenant  ${tenantY} 
	#${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=permit  srcdata=${src_dict}   
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1



######  **  ANY need more investigation  **  ########	
T16 Interface tenant add/remove deny policy src-tenant to any
	[Tags]  feature
	${src_dict}=  Create Dictionary  tenant  ${tenantX} 
	#${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=deny  srcdata=${src_dict}
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    


T17 Interface tenant add/remove permit policy src-vns to dest-ip
	[Tags]  feature
	${src_dict}=  Create Dictionary  segment  ${vnsY1}  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=permit  srcdata=${src_dict}  dstdata=${dst_dict}
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1

T18 Interface tenant add/remove deny policy src-vns to dest-ip
	[Tags]  feature
	${src_dict}=  Create Dictionary  segment  ${vnsY1}  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  cidr  ${ixia4_ip}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=deny  srcdata=${src_dict}  dstdata=${dst_dict}
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1

T19 Interface tenant add/remove permit policy src-vns to dest-tenant
	[Tags]  smoke  feature
	${src_dict}=  Create Dictionary  segment  ${vnsY1}  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=permit  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1

T20 Interface tenant add/remove deny policy src-vns to dest-tenant
	[Tags]  smoke  feature
	${src_dict}=  Create Dictionary  segment  ${vnsY1}  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=deny  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1

T21 Interface tenant add/remove permit policy src-vns to dest-vns
	[Tags]  smoke  feature
	${src_dict}=  Create Dictionary  segment  ${vnsY1}  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=permit  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1

T22 Interface tenant add/remove deny policy src-vns to dest-vns
	[Tags]  smoke  feature
	${src_dict}=  Create Dictionary  segment  ${vnsY1}  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=deny  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1

######  **  ANY need more investigation  **  ########	
T23 Interface tenant add/remove permit policy src-vns to any
	[Tags]  feature
	${src_dict}=  Create Dictionary  segment  ${vnsY1}  tenant  ${tenantY} 
	#${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=permit  srcdata=${src_dict}  
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1

T24 Interface tenant add/remove deny policy src-vns to any
	[Tags]  feature
	${src_dict}=  Create Dictionary  segment  ${vnsY1}  tenant  ${tenantY} 
	#${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=deny  srcdata=${src_dict}  
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1

######  **  ANY need more investigation  **  ########	
T25 Interface tenant add/remove permit policy any to dest-ip
	[Tags]  feature
	#${src_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX} 
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=permit  dstdata=${dst_dict} 
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1

######  **  ANY need more investigation  **  ########	
T26 Interface tenant add/remove deny policy any to dest-ip
	[Tags]  feature
	#${src_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX} 
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=deny  dstdata=${dst_dict} 
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1


######  **  ANY need more investigation  **  ########	
T27 Interface tenant add/remove permit policy any to dest-tenant
	[Tags]  feature
	#${src_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX} 
	${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=permit  dstdata=${dst_dict} 
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    
######  **  ANY need more investigation  **  ########	
T28 Interface tenant add/remove deny policy any to dest-tenant
	[Tags]  feature
	#${src_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX} 
	${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=deny  dstdata=${dst_dict} 
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    
######  **  ANY need more investigation  **  ########	
T29 Interface tenant add/remove permit policy any to dest-vns
	[Tags]  feature
	#${src_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX} 
	${dst_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=permit  dstdata=${dst_dict} 
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    
######  **  ANY need more investigation  **  ########	
T30 Interface tenant add/remove deny policy any to dest-vns
	[Tags]  feature
	#${src_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX} 
	${dst_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=deny  dstdata=${dst_dict} 
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    
######  **  ANY need more investigation  **  ########	
T31 Interface tenant add/remove permit policy any to any
	[Tags]  feature
	#${src_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX} 
	#${dst_dict}=  Create Dictionary  segment  ${vnsX3}  
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=permit
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1


######  **  ANY need more investigation  **  ########	
T32 Interface tenant add/remove deny policy any to any
	[Tags]  feature
	#${src_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX} 
	#${dst_dict}=  Create Dictionary  segment  ${vnsX3}  
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=deny
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    
##Below are for ip and port combination specified at tenant interface
##-------------------------------------##

T33 Interface tenant add/remove permit policy src-ip-port to dest-ip-port
	[Tags]  feature
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}  port  ${tcp_port}
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}  port  ${tcp_port}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=permit  
	...								srcdata=${src_dict}  dstdata=${dst_dict}  proto=6
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    
T34 Interface tenant add/remove deny policy src-ip-port to dest-ip-port
	[Tags]  smoke  feature
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}  port  ${tcp_port}
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}  port  ${tcp_port}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=deny  
	...								srcdata=${src_dict}  dstdata=${dst_dict}  proto=6
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    
T35 Interface tenant add/remove permit policy src-ip-port to dest-vns
	[Tags]  smoke  feature
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}  port  ${tcp_port}
	${dst_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=permit  
	...								srcdata=${src_dict}  dstdata=${dst_dict}  proto=6
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
T36 Interface tenant add/remove deny policy src-ip-port to dest-vns
	[Tags]  smoke  feature
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}  port  ${tcp_port}
	${dst_dict}=  Create Dictionary  segment  ${vnsX1}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=deny  
	...								srcdata=${src_dict}  dstdata=${dst_dict}  proto=6
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
T37 Interface tenant add/remove permit src-ip-port to dest-tenant
	[Tags]  smoke  feature
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}  port  ${tcp_port}
	${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=permit  
	...								srcdata=${src_dict}  dstdata=${dst_dict}  proto=6
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
	delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
T38 Interface tenant add/remove deny src-ip-port to dest-tenant
	[Tags]  smoke  feature
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}  port  ${tcp_port}
	${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=deny  
	...								srcdata=${src_dict}  dstdata=${dst_dict}  proto=6
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
	delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
######  **  ANY need more investigation  **  ########	
T39 Interface tenant add/remove permit policy src-ip-port to any
	[Tags]  feature
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}  port  ${tcp_port}
	#${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=permit  
	...								srcdata=${src_dict}  proto=6
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
	delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
######  **  ANY need more investigation  **  ########	
T40 Interface tenant add/remove deny policy src-ip-port to any
	[Tags]  feature
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}  port  ${tcp_port}
	#${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=deny  
	...								srcdata=${src_dict}  proto=6
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
	delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
T41 Interface tenant add/remove permit policy src-tenant to dest-ip-port
	[Tags]  smoke  feature
	${src_dict}=  Create Dictionary  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}  port  ${tcp_port}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=permit  
	...								srcdata=${src_dict}  proto=6
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
	delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
T42 Interface tenant add/remove deny policy src-tenant to dest-ip-port
	[Tags]  smoke  feature
	${src_dict}=  Create Dictionary  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}  port  ${tcp_port}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=deny  
	...								srcdata=${src_dict}  proto=6
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
	delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2

T43 Interface tenant add/remove permit policy src-vns to dest-ip-port
	[Tags]  smoke  feature  T96
	${src_dict}=  Create Dictionary  segment  ${vnsY1}  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}  port  ${tcp_port}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=permit  
	...								srcdata=${src_dict}  dstdata=${dst_dict}  proto=6
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
	delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
T44 Interface tenant add/remove deny policy src-vns to dest-ip-port
	[Tags]  smoke  feature
	${src_dict}=  Create Dictionary  segment  ${vnsY1}  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}  port  ${tcp_port}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=deny  
	...								srcdata=${src_dict}  dstdata=${dst_dict}  proto=6
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
	delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
######  **  ANY need more investigation  **  ########	
T45 Interface tenant add/remove permit policy any to dest-ip-port
	[Tags]  feature
	#${src_dict}=  Create Dictionary  segment  ${vnsX3}
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}  port  ${tcp_port}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=permit  
	...								dstdata=${dst_dict}  proto=6
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
	delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
######  **  ANY need more investigation  **  ########	
T46 Interface tenant add/remove deny policy any to dest-ip-port
	[Tags]  feature
	#${src_dict}=  Create Dictionary  segment  ${vnsX3}
	${dst_dict}=  Create Dictionary  cidr  ${ixia4_ip}  port  ${tcp_port}
	rest add policy								X		${tenant1_polname}		
	rest add policy item example  tenant=${tenantX}  polname=${tenant1_polname}  seqnum=10  action=deny  
	...								dstdata=${dst_dict}  proto=6
	rest apply policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
	delete traffic
	sleep  2
	rest remove policy on tenant					X			${tenant1_polname}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2



###### Policy at default system tenant interface ############
#---------------------------------------------

T48 Interface system tenant add/remove permit policy src-ip to dest-ip 
	[Tags]  feature  systemt  deny
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=permit  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1

T49 Interface system tenant add/remove deny policy src-ip to dest-ip 
	[Tags]  feature  deny  systemt
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=deny  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1


T50 Interface system tenant add/remove permit policy src-ip to dest-vns
	[Tags]  feature  systemt
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}
	${dst_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=permit  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
   	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1 

T51 Interface system tenant add/remove deny policy src-ip to dest-vns
	[Tags]  feature  systemt
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}
	${dst_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=deny  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
   	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1 
T52 Interface system tenant add/remove permit policy src-ip to dest-tenant
	[Tags]  feature  systemt
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}
	${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=permit  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1

T53 Interface system tenant add/remove deny policy src-ip to dest-tenant
	[Tags]  feature  systemt  T6
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}
	${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=deny  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
    delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
######  **  ANY **  ########	
T54 Interface system tenant add/remove permit policy src-ip to any
	[Tags]  feature  systemt
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}
	#${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=permit  srcdata=${src_dict}
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
######  **  ANY **  ########	
T55 Interface system tenant add/remove deny policy src-ip to any
	[Tags]  feature  systemt
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}
	#${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=deny  srcdata=${src_dict} 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
T56 Interface system tenant add/remove permit policy src-tenant to dest-ip
	[Tags]  feature  systemt
	${src_dict}=  Create Dictionary  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=permit  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1

T57 Interface system tenant add/remove deny policy src-tenant to dest-ip
	[Tags]  feature  systemt
	${src_dict}=  Create Dictionary  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=deny  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
T58 Interface system tenant add/remove permit policy src-tenant to dest-tenant
	[Tags]  feature  systemt
	${src_dict}=  Create Dictionary  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=permit  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
T59 Interface system tenant add/remove deny policy src-tenant to dest-tenant
	[Tags]  feature  systemt
	${src_dict}=  Create Dictionary  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=deny  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1

T60 Interface system tenant add/remove permit policy src-tenant to dest-vns
	[Tags]  feature  systemt
	${src_dict}=  Create Dictionary  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=permit  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
T61 Interface system tenant add/remove deny policy src-tenant to dest-vns
	[Tags]  feature  systemt
	${src_dict}=  Create Dictionary  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=deny  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
######  **  ANY need more investigation  **  ########	
T62 Interface system tenant add/remove permit policy src-tenant to any
	[Tags]  feature  systemt
	${src_dict}=  Create Dictionary  tenant  ${tenantY} 
	#${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=permit  srcdata=${src_dict}
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1


######  **  ANY need more investigation  **  ########	
T63 Interface system tenant add/remove deny policy src-tenant to any
	[Tags]  feature  systemt
	${src_dict}=  Create Dictionary  tenant  ${tenantX} 
	#${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=deny  srcdata=${src_dict}
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1

T64 Interface system tenant add/remove permit policy src-vns to dest-ip
	[Tags]  feature  systemt
	${src_dict}=  Create Dictionary  segment  ${vnsY1}  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=permit  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
T65 Interface system tenant add/remove deny policy src-vns to dest-ip
	[Tags]  feature  systemt
	${src_dict}=  Create Dictionary  segment  ${vnsY1}  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=deny  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
T66 Interface system tenant add/remove permit policy src-vns to dest-tenant
	[Tags]  smoke  feature  systemt
	${src_dict}=  Create Dictionary  segment  ${vnsY1}  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=permit  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
T67 Interface system tenant add/remove deny policy src-vns to dest-tenant
	[Tags]  smoke  feature  systemt
	${src_dict}=  Create Dictionary  segment  ${vnsY1}  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=deny  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
T68 Interface system tenant add/remove permit policy src-vns to dest-vns
	[Tags]  smoke  feature  systemt
	${src_dict}=  Create Dictionary  segment  ${vnsY1}  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=permit  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
T69 Interface system tenant add/remove deny policy src-vns to dest-vns
	[Tags]  smoke  feature  systemt
	${src_dict}=  Create Dictionary  segment  ${vnsY1}  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=deny  srcdata=${src_dict}  dstdata=${dst_dict} 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
######  **  ANY need more investigation  **  ########	
T70 Interface system tenant add/remove permit policy src-vns to any
	[Tags]  feature  systemt
	${src_dict}=  Create Dictionary  segment  ${vnsY1}  tenant  ${tenantY} 
	#${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=permit  srcdata=${src_dict}
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
T71 Interface system tenant add/remove deny policy src-vns to any
	[Tags]  feature  systemt
	${src_dict}=  Create Dictionary  segment  ${vnsY1}  tenant  ${tenantY} 
	#${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=deny  srcdata=${src_dict}
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
######  **  ANY need more investigation  **  ########	
T72 Interface system tenant add/remove permit policy any to dest-ip
	[Tags]  feature  systemt
	#${src_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX} 
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=permit  dstdata=${dst_dict} 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
######  **  ANY need more investigation  **  ########	
T73 Interface system tenant add/remove deny policy any to dest-ip
	[Tags]  feature  systemt
	#${src_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX} 
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=deny  dstdata=${dst_dict} 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1

######  **  ANY need more investigation  **  ########	
T74 Interface system tenant add/remove permit policy any to dest-tenant
	[Tags]  feature  systemt
	#${src_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX} 
	${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=permit  dstdata=${dst_dict} 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
######  **  ANY need more investigation  **  ########	
T75 Interface system tenant add/remove deny policy any to dest-tenant
	[Tags]  feature  systemt
	#${src_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX} 
	${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=deny  dstdata=${dst_dict} 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
######  **  ANY need more investigation  **  ########	
T76 Interface system tenant add/remove permit policy any to dest-vns
	[Tags]  feature  systemT29
	#${src_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX} 
	${dst_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=permit  dstdata=${dst_dict} 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
######  **  ANY need more investigation  **  ########	
T77 Interface system tenant add/remove deny policy any to dest-vns
	[Tags]  feature  systemt
	#${src_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX} 
	${dst_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=deny  dstdata=${dst_dict} 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
######  **  ANY need more investigation  **  ########	
T78 Interface system tenant add/remove permit policy any to any
	[Tags]  feature  systemt
	#${src_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX} 
	#${dst_dict}=  Create Dictionary  segment  ${vnsX3}  
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=permit
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1


######  **  ANY need more investigation  **  ########	
T79 Interface system tenant add/remove deny policy any to any
	[Tags]  feature  systemt
	#${src_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX} 
	#${dst_dict}=  Create Dictionary  segment  ${vnsX3}  
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=deny
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
##Below are for ip and port combination specified at tenant interface
##-------------------------------------##

T80 Interface system tenant add/remove permit policy src-ip-port to dest-ip-port
	[Tags]  feature  systemt
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}  port  ${tcp_port}
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}  port  ${tcp_port}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=permit  
	...								srcdata=${src_dict}  dstdata=${dst_dict}  proto=6 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
T81 Interface system tenant add/remove deny policy src-ip-port to dest-ip-port
	[Tags]  smoke  feature  systemt
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}  port  ${tcp_port}
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}  port  ${tcp_port}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=deny  
	...								srcdata=${src_dict}  dstdata=${dst_dict}  proto=6 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
T82 Interface system tenant add/remove permit policy src-ip-port to dest-vns
	[Tags]  smoke  feature  systemT88
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}  port  ${tcp_port}
	${dst_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=permit  
	...								srcdata=${src_dict}  dstdata=${dst_dict}  proto=6 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
T83 Interface system tenant add/remove deny policy src-ip-port to dest-vns
	[Tags]  smoke  feature  systemt
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}  port  ${tcp_port}
	${dst_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=deny  
	...								srcdata=${src_dict}  dstdata=${dst_dict}  proto=6 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix4-to-ix1
T84 Interface system tenant add/remove permit src-ip-port to dest-tenant
	[Tags]  smoke  feature  systemt
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}  port  ${tcp_port}
	${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=permit  
	...								srcdata=${src_dict}  dstdata=${dst_dict}  proto=6 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
T85 Interface system tenant add/remove deny src-ip-port to dest-tenant
	[Tags]  smoke  feature  systemt
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}  port  ${tcp_port}
	${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=deny  
	...								srcdata=${src_dict}  dstdata=${dst_dict}  proto=6 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
######  **  ANY need more investigation  **  ########	
T86 Interface system tenant add/remove permit policy src-ip-port to any
	[Tags]  feature  systemt
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}  port  ${tcp_port}
	#${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=permit  
	...								srcdata=${src_dict}  proto=6 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
######  **  ANY need more investigation  **  ########	
T87 Interface system tenant add/remove deny policy src-ip-port to any
	[Tags]  feature  systemt
	${src_dict}=  Create Dictionary  cidr  ${ixia4_ip}  port  ${tcp_port}
	#${dst_dict}=  Create Dictionary  tenant  ${tenantX}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=deny  
	...								srcdata=${src_dict}  proto=6 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
T88 Interface system tenant add/remove permit policy src-tenant to dest-ip-port
	[Tags]  smoke  feature  systemT94
	${src_dict}=  Create Dictionary  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}  port  ${tcp_port}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=permit  
	...								srcdata=${src_dict}  dstdata=${dst_dict}  proto=6 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
T89 Interface system tenant add/remove deny policy src-tenant to dest-ip-port
	[Tags]  smoke  feature  systemt
	${src_dict}=  Create Dictionary  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}  port  ${tcp_port}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=deny  
	...								srcdata=${src_dict}  dstdata=${dst_dict}  proto=6 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2

T90 Interface system tenant add/remove permit policy src-vns to dest-ip-port
	[Tags]  smoke  feature  T96  systemT96
	${src_dict}=  Create Dictionary  segment  ${vnsY1}  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}  port  ${tcp_port}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=permit  
	...								srcdata=${src_dict}  dstdata=${dst_dict}  proto=6 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
T91 Interface system tenant add/remove deny policy src-vns to dest-ip-port
	[Tags]  smoke  feature  systemt
	${src_dict}=  Create Dictionary  segment  ${vnsY1}  tenant  ${tenantY}
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}  port  ${tcp_port}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=deny  
	...								srcdata=${src_dict}  dstdata=${dst_dict}  proto=6 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
######  **  ANY need more investigation  **  ########	
T92 Interface system tenant add/remove permit policy any to dest-ip-port
	[Tags]  feature  systemt
	#${src_dict}=  Create Dictionary  segment  ${vnsX3}
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}  port  ${tcp_port}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=permit  
	...								dstdata=${dst_dict}  proto=6 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
######  **  ANY need more investigation  **  ########	
T93 Interface system tenant add/remove deny policy any to dest-ip-port
	[Tags]  feature  systemt
	#${src_dict}=  Create Dictionary  segment  ${vnsX3}
	${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}  port  ${tcp_port}
	rest add policy							${tenant_system}		${tenant2_polname}		
	rest add policy item example  tenant=${tenant_system}  polname=${tenant2_polname}  seqnum=10  action=deny  
	...								dstdata=${dst_dict}  proto=6 
	rest apply policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats false  transmitted_frames  received_frames  ${stream}  ix1-to-ix2
	delete traffic
	sleep  2
	rest remove policy on tenant				${tenant_system}		${tenant2_polname}  ${tenantY}
	${stream}=             L3 add  name=ix1-to-ix2  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...						dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    ...						protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    #sleep                  
    ${report}=             fetch port stats  stream=${stream}
    verify stats true  transmitted_frames  received_frames  ${stream}  ix1-to-ix2





###### Policy with next-hop group ############
#---------------------------------------------

T94 policy add/remove redirect(next-hop) from src-ip to dest-ip
    [Tags]  feature  nhg
    ${src_dict}=  Create Dictionary  cidr  ${ixia3_ip}
    ${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}
    ${next_hop}=  Create Dictionary  next-hop-group  ${next-hop-grp}
    rest add policy                         ${tenantX}      ${tenant2_polname}  
    rest add nexthop group  ${tenantX}  ${next-hop-grp}
    rest add nexthopGroup ip  ${tenantX}  ${next-hop-grp}  ${next-hop-ip}
    rest add policy item example  tenant=${tenantX}  polname=${tenant2_polname}  seqnum=10  action=next-hop  srcdata=${src_dict}  dstdata=${dst_dict}  next-hop=${next_hop}
    rest apply policy on tenant             ${tenantX}      ${tenant2_polname}
    ${redirect-host}=  L3 add host  src_ip=${next-hop-ip}  gw_ip=${next-hop-gw}  port_name=b
    #pause      FREEZZEEEE!
    L3 start hosts  port_name=b
    ${result}=  L3 chk gw arp
    should be true  ${result}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    clear stats
    sleep                  5
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia1_ip}
    should be true  ${result}
    
    start traffic  ${stream}
    sleep                  5
    #pause  FREZZEE!!
    stop traffic   ${stream}
    verify results   c   b
    delete traffic
    sleep  2
    rest remove policy on tenant                ${tenantX}      ${tenant2_polname}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    clear stats
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia1_ip}
    should not be true  ${result}
    
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    sleep  2                  
    verify results   c   a
    delete traffic



T95 policy add/remove redirect(next-hop) from src-ip to dest-vns
    [Tags]  feature  T95   nhg
    ${dst_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX}
    ${src_dict}=  Create Dictionary  cidr  ${ixia3_ip}
    ${next_hop}=  Create Dictionary  next-hop-group  ${next-hop-grp}
    rest add policy                         ${tenantX}      ${tenant2_polname}  
    rest add nexthop group  ${tenantX}  ${next-hop-grp}
    rest add nexthopGroup ip  ${tenantX}  ${next-hop-grp}  ${next-hop-ip}
    rest add policy item example  tenant=${tenantX}  polname=${tenant2_polname}  seqnum=10  action=next-hop  srcdata=${src_dict}  dstdata=${dst_dict}  next-hop=${next_hop}
    rest apply policy on tenant             ${tenantX}      ${tenant2_polname}
    ${redirect-host}=  L3 add host  src_ip=${next-hop-ip}  gw_ip=${next-hop-gw}  port_name=b
    #pause      FREEZZEEEE!
    L3 start hosts  port_name=b
    ${result}=  L3 chk gw arp
    should be true  ${result}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    clear stats
    sleep                  5
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia1_ipsubnet}
    should be true  ${result}
    start traffic  ${stream}
    sleep                  5
    #pause  FREZZEE!!
    stop traffic   ${stream}
    verify results   c   b
    delete traffic
    sleep  2
    rest remove policy on tenant                ${tenantX}      ${tenant2_polname}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    clear stats
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia1_ipsubnet}
    should not be true  ${result}
    
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    sleep  2                  
    verify results   c   a
    delete traffic
    

    
T96 policy add/remove redirect(next-hop) from src-ip to dest-tenant
    [Tags]  feature  T96    nhg
    ${dst_dict}=  Create Dictionary  tenant  ${tenantX}
    ${src_dict}=  Create Dictionary  cidr  ${ixia3_ip}
    ${next_hop}=  Create Dictionary  next-hop-group  ${next-hop-grp}
    rest add policy                         ${tenantX}      ${tenant2_polname}  
    rest add nexthop group  ${tenantX}  ${next-hop-grp}
    rest add nexthopGroup ip  ${tenantX}  ${next-hop-grp}  ${next-hop-ip}
    rest add policy item example  tenant=${tenantX}  polname=${tenant2_polname}  seqnum=10  action=next-hop  srcdata=${src_dict}  dstdata=${dst_dict}  next-hop=${next_hop}
    rest apply policy on tenant             ${tenantX}      ${tenant2_polname}
    ${redirect-host}=  L3 add host  src_ip=${next-hop-ip}  gw_ip=${next-hop-gw}  port_name=b
    #pause      FREEZZEEEE!
    L3 start hosts  port_name=b
    ${result}=  L3 chk gw arp
    should be true  ${result}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    clear stats
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia1_ipsubnet}
    should be true  ${result}
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia2_ipsubnet}
    should be true  ${result}
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia3_ipsubnet}
    should be true  ${result}
    
    sleep                  5
    start traffic  ${stream}
    sleep                  5
    #pause  FREZZEE!!
    stop traffic   ${stream}
    verify results   c   b
    delete traffic
    sleep  2
    rest remove policy on tenant                ${tenantX}      ${tenant2_polname}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    clear stats
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia1_ipsubnet}
    should not be true  ${result}
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia2_ipsubnet}
    should not be true  ${result}
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia3_ipsubnet}
    should not be true  ${result}
    
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    sleep  2                  
    verify results   c   a
    delete traffic


######  **  ANY **  ########    
T97 policy add/remove redirect(next-hop) from src-ip to any
    [Tags]  feature  T97   nhg
    #${dst_dict}=  Create Dictionary  tenant  ${tenantX}
    ${src_dict}=  Create Dictionary  cidr  ${ixia3_ip}
    ${next_hop}=  Create Dictionary  next-hop-group  ${next-hop-grp}
    rest add policy                         ${tenantX}      ${tenant2_polname}  
    rest add nexthop group  ${tenantX}  ${next-hop-grp}
    rest add nexthopGroup ip  ${tenantX}  ${next-hop-grp}  ${next-hop-ip}
    rest add policy item example  tenant=${tenantX}  polname=${tenant2_polname}  seqnum=10  action=next-hop  srcdata=${src_dict}  next-hop=${next_hop}
    rest apply policy on tenant             ${tenantX}      ${tenant2_polname}
    ${redirect-host}=  L3 add host  src_ip=${next-hop-ip}  gw_ip=${next-hop-gw}  port_name=b
    #pause      FREEZZEEEE!
    L3 start hosts  port_name=b
    ${result}=  L3 chk gw arp
    should be true  ${result}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    clear stats
    sleep                  5
    start traffic  ${stream}
    sleep                  5
    #pause  FREZZEE!!
    stop traffic   ${stream}
    verify results   c   b
    delete traffic
    sleep  2
    rest remove policy on tenant                ${tenantX}      ${tenant2_polname}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    sleep  2                  
    verify results   c   a
    delete traffic
    
T98 policy add/remove redirect(next-hop) from src-tenant to dest-ip
    [Tags]  feature  T98    nhg
    ${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}
    ${src_dict}=  Create Dictionary  tenant  ${tenantX}
    ${next_hop}=  Create Dictionary  next-hop-group  ${next-hop-grp}
    rest add policy                         ${tenantX}      ${tenant2_polname}  
    rest add nexthop group  ${tenantX}  ${next-hop-grp}
    rest add nexthopGroup ip  ${tenantX}  ${next-hop-grp}  ${next-hop-ip}
    rest add policy item example  tenant=${tenantX}  polname=${tenant2_polname}  seqnum=10  action=next-hop  srcdata=${src_dict}  dstdata=${dst_dict}  next-hop=${next_hop}
    rest apply policy on tenant             ${tenantX}      ${tenant2_polname}
    ${redirect-host}=  L3 add host  src_ip=${next-hop-ip}  gw_ip=${next-hop-gw}  port_name=b
    #pause      FREEZZEEEE!
    L3 start hosts  port_name=b
    ${result}=  L3 chk gw arp
    should be true  ${result}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    clear stats
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia1_ip}
    should be true  ${result}
    
    sleep                  5
    start traffic  ${stream}
    sleep                  5
    #pause  FREZZEE!!
    stop traffic   ${stream}
    verify results   c   b
    delete traffic
    sleep  2
    rest remove policy on tenant                ${tenantX}      ${tenant2_polname}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    clear stats
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia1_ip}
    should not be true  ${result}
    start traffic  ${stream}
    sleep                  5
    #pause      FREEZZEEE!!!
    stop traffic   ${stream}
    sleep  2                  
    verify results   c   a
    delete traffic

    
T99 policy add/remove redirect(next-hop) from src-tenant to dest-tenant
    [Tags]  feature  T99    nhg
    ${src_dict}=  Create Dictionary  tenant  ${tenantY}
    ${dst_dict}=  Create Dictionary  tenant  ${tenantX}
    ${next_hop}=  Create Dictionary  next-hop-group  ${next-hop-grp}
    rest add policy                         ${tenantX}      ${tenant2_polname}  
    rest add nexthop group  ${tenantX}  ${next-hop-grp}
    rest add nexthopGroup ip  ${tenantX}  ${next-hop-grp}  ${next-hop-ip}
    rest add policy item example  tenant=${tenantX}  polname=${tenant2_polname}  seqnum=10  action=next-hop  srcdata=${src_dict}  dstdata=${dst_dict}  next-hop=${next_hop}
    rest apply policy on tenant             ${tenantX}      ${tenant2_polname}
    ${redirect-host}=  L3 add host  src_ip=${next-hop-ip}  gw_ip=${next-hop-gw}  port_name=b
    #pause      FREEZZEEEE!
    L3 start hosts  port_name=b
    ${result}=  L3 chk gw arp
    should be true  ${result}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    #pause     FREEZZEEEE!!
    clear stats
    sleep                  5
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia1_ipsubnet}
    should be true  ${result}
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia2_ipsubnet}
    should be true  ${result}
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia3_ipsubnet}
    should be true  ${result}
    
    start traffic  ${stream}
    sleep                  5
    #pause  FREZZEE!!
    stop traffic   ${stream}
    verify results   d   b
    delete traffic
    sleep  2
    rest remove policy on tenant                ${tenantX}      ${tenant2_polname}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia1_ipsubnet}
    should not be true  ${result}
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia2_ipsubnet}
    should not be true  ${result}
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia3_ipsubnet}
    should not be true  ${result}
    
    start traffic  ${stream}
    sleep                  5
    #pause      FREEZZEEE!!!
    stop traffic   ${stream}
    sleep  2                  
    verify results   d   a
    delete traffic
    

T100 policy add/remove redirect(next-hop) from src-tenant to dest-vns
    [Tags]  feature   T100   nhg
    ${src_dict}=  Create Dictionary  tenant  ${tenantY}
    ${dst_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX}
    ${next_hop}=  Create Dictionary  next-hop-group  ${next-hop-grp}
    rest add policy                         ${tenantX}      ${tenant2_polname}  
    rest add nexthop group  ${tenantX}  ${next-hop-grp}
    rest add nexthopGroup ip  ${tenantX}  ${next-hop-grp}  ${next-hop-ip}
    rest add policy item example  tenant=${tenantX}  polname=${tenant2_polname}  seqnum=10  action=next-hop  srcdata=${src_dict}  dstdata=${dst_dict}  next-hop=${next_hop}
    rest apply policy on tenant             ${tenantX}      ${tenant2_polname}
    ${redirect-host}=  L3 add host  src_ip=${next-hop-ip}  gw_ip=${next-hop-gw}  port_name=b
    #pause      FREEZZEEEE!
    L3 start hosts  port_name=b
    ${result}=  L3 chk gw arp
    should be true  ${result}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    #pause     FREEZZEEEE!!
    clear stats
    sleep                  5
    start traffic  ${stream}
    sleep                  5
    #pause  FREZZEE!!
    stop traffic   ${stream}
    verify results   d   b
    delete traffic
    sleep  2
    rest remove policy on tenant                ${tenantX}      ${tenant2_polname}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    #pause      FREEZZEEE!!!
    stop traffic   ${stream}
    sleep  2                  
    verify results   d   a
    delete traffic

    
######  **  ANY need more investigation  **  ########   
T101 policy add/remove redirect(next-hop) from src-tenant to any
    [Tags]  feature    T101   nhg
    ${src_dict}=  Create Dictionary  tenant  ${tenantY}
    #${dst_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX}
    ${next_hop}=  Create Dictionary  next-hop-group  ${next-hop-grp}
    rest add policy                         ${tenantX}      ${tenant2_polname}  
    rest add nexthop group  ${tenantX}  ${next-hop-grp}
    rest add nexthopGroup ip  ${tenantX}  ${next-hop-grp}  ${next-hop-ip}
    rest add policy item example  tenant=${tenantX}  polname=${tenant2_polname}  seqnum=10  action=next-hop  srcdata=${src_dict}  next-hop=${next_hop}
    rest apply policy on tenant             ${tenantX}      ${tenant2_polname}
    ${redirect-host}=  L3 add host  src_ip=${next-hop-ip}  gw_ip=${next-hop-gw}  port_name=b
    #pause      FREEZZEEEE!
    L3 start hosts  port_name=b
    ${result}=  L3 chk gw arp
    should be true  ${result}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    #pause     FREEZZEEEE!!
    clear stats
    sleep                  5
    start traffic  ${stream}
    sleep                  5
    #pause  FREZZEE!!
    stop traffic   ${stream}
    verify results   d   b
    delete traffic
    sleep  2
    rest remove policy on tenant                ${tenantX}      ${tenant2_polname}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=d->a  src_ip=10.252.1.2  src_gw=10.252.1.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia4_mac}  dst_mac=${ixia1_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    #pause      FREEZZEEE!!!
    stop traffic   ${stream}
    sleep  2                  
    verify results   d   a
    delete traffic


######  **  ANY need more investigation  **  ########   



T102 policy add/remove redirect(next-hop) from src-vns to dest-ip
    [Tags]  feature  T102    nhg
    ${src_dict}=  Create Dictionary  segment  ${vnsX2}  tenant  ${tenantX}
    ${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}
    ${next_hop}=  Create Dictionary  next-hop-group  ${next-hop-grp}
    rest add policy                         ${tenantX}      ${tenant2_polname}  
    rest add nexthop group  ${tenantX}  ${next-hop-grp}
    rest add nexthopGroup ip  ${tenantX}  ${next-hop-grp}  ${next-hop-ip}
    rest add policy item example  tenant=${tenantX}  polname=${tenant2_polname}  seqnum=10  action=next-hop  srcdata=${src_dict}  dstdata=${dst_dict}  next-hop=${next_hop}
    rest apply policy on tenant             ${tenantX}      ${tenant2_polname}
    ${redirect-host}=  L3 add host  src_ip=${next-hop-ip}  gw_ip=${next-hop-gw}  port_name=b
    #pause      FREEZZEEEE!
    L3 start hosts  port_name=b
    ${result}=  L3 chk gw arp
    should be true  ${result}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}  src_port=${tcp_port}  dst_port=${tcp_port}  protocol=TCP
    clear stats
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia1_ip}
    should be true  ${result}
    
    sleep                  5
    start traffic  ${stream}
    sleep                  5
    #pause  FREZZEE!!
    stop traffic   ${stream}
    verify results   c   b
    delete traffic
    sleep  2
    rest remove policy on tenant                ${tenantX}      ${tenant2_polname}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    clear stats
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia1_ip}
    should not be true  ${result}
    
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    sleep  2                  
    verify results   c   a
    delete traffic


T103 policy add/remove redirect(next-hop) from src-vns to dest-tenant
    [Tags]  smoke  feature    T103   nhg
    
    ${dst_dict}=  Create Dictionary  tenant  ${tenantX}
    ${src_dict}=  Create Dictionary  segment  ${vnsX2}  tenant  ${tenantX}
    ${next_hop}=  Create Dictionary  next-hop-group  ${next-hop-grp}
    rest add policy                         ${tenantX}      ${tenant2_polname}  
    rest add nexthop group  ${tenantX}  ${next-hop-grp}
    rest add nexthopGroup ip  ${tenantX}  ${next-hop-grp}  ${next-hop-ip}
    rest add policy item example  tenant=${tenantX}  polname=${tenant2_polname}  seqnum=10  action=next-hop  srcdata=${src_dict}  dstdata=${dst_dict}  next-hop=${next_hop}
    rest apply policy on tenant             ${tenantX}      ${tenant2_polname}
    ${redirect-host}=  L3 add host  src_ip=${next-hop-ip}  gw_ip=${next-hop-gw}  port_name=b
    #pause      FREEZZEEEE!
    L3 start hosts  port_name=b
    ${result}=  L3 chk gw arp
    should be true  ${result}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}  src_port=${tcp_port}  dst_port=${tcp_port}  protocol=TCP
    clear stats
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia1_ipsubnet}
    should be true  ${result}
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia2_ipsubnet}
    should be true  ${result}
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia3_ipsubnet}
    should be true  ${result}
    
    sleep                  5
    start traffic  ${stream}
    sleep                  5
    #pause  FREZZEE!!
    stop traffic   ${stream}
    verify results   c   b
    delete traffic
    sleep  2
    rest remove policy on tenant                ${tenantX}      ${tenant2_polname}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    clear stats
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia1_ipsubnet}
    should not be true  ${result}
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia2_ipsubnet}
    should not be true  ${result}
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia3_ipsubnet}
    should not be true  ${result}
    
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    sleep  2                  
    verify results   c   a
    delete traffic

T104 policy add/remove redirect(next-hop) from src-vns to dest-vns
    [Tags]  smoke  feature    T104    nhg
    ${dst_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX}
    ${src_dict}=  Create Dictionary  segment  ${vnsX2}  tenant  ${tenantX}
    ${next_hop}=  Create Dictionary  next-hop-group  ${next-hop-grp}
    rest add policy                         ${tenantX}      ${tenant2_polname}  
    rest add nexthop group  ${tenantX}  ${next-hop-grp}
    rest add nexthopGroup ip  ${tenantX}  ${next-hop-grp}  ${next-hop-ip}
    rest add policy item example  tenant=${tenantX}  polname=${tenant2_polname}  seqnum=10  action=next-hop  srcdata=${src_dict}  dstdata=${dst_dict}  next-hop=${next_hop}
    rest apply policy on tenant             ${tenantX}      ${tenant2_polname}
    ${redirect-host}=  L3 add host  src_ip=${next-hop-ip}  gw_ip=${next-hop-gw}  port_name=b
    #pause      FREEZZEEEE!
    L3 start hosts  port_name=b
    ${result}=  L3 chk gw arp
    should be true  ${result}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}  src_port=${tcp_port}  dst_port=${tcp_port}  protocol=TCP
    clear stats
    sleep                  5
    start traffic  ${stream}
    sleep                  5
    #pause  FREZZEE!!
    stop traffic   ${stream}
    verify results   c   b
    delete traffic
    sleep  2
    rest remove policy on tenant                ${tenantX}      ${tenant2_polname}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    sleep  2                  
    verify results   c   a
    delete traffic




######  **  ANY need more investigation  **  ########   
T105 policy add/remove redirect(next-hop) from src-vns to any
    [Tags]  feature    T105    nhg
    #${dst_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX}
    ${src_dict}=  Create Dictionary  segment  ${vnsX2}  tenant  ${tenantX}
    ${next_hop}=  Create Dictionary  next-hop-group  ${next-hop-grp}
    rest add policy                         ${tenantX}      ${tenant2_polname}  
    rest add nexthop group  ${tenantX}  ${next-hop-grp}
    rest add nexthopGroup ip  ${tenantX}  ${next-hop-grp}  ${next-hop-ip}
    rest add policy item example  tenant=${tenantX}  polname=${tenant2_polname}  seqnum=10  action=next-hop  srcdata=${src_dict}  next-hop=${next_hop}
    rest apply policy on tenant             ${tenantX}      ${tenant2_polname}
    ${redirect-host}=  L3 add host  src_ip=${next-hop-ip}  gw_ip=${next-hop-gw}  port_name=b
    #pause      FREEZZEEEE!
    L3 start hosts  port_name=b
    ${result}=  L3 chk gw arp
    should be true  ${result}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}  src_port=${tcp_port}  dst_port=${tcp_port}  protocol=TCP
    clear stats
    sleep                  5
    start traffic  ${stream}
    sleep                  5
    #pause  FREZZEE!!
    stop traffic   ${stream}
    verify results   c   b
    delete traffic
    sleep  2
    rest remove policy on tenant                ${tenantX}      ${tenant2_polname}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    sleep  2                  
    verify results   c   a
    delete traffic


######  **  ANY need more investigation  **  ########   
T106 policy add/remove redirect(next-hop) from any to dest-ip
    [Tags]  feature    T106   nhg
    ${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}
    #${src_dict}=  Create Dictionary  segment  ${vnsX3}  tenant  ${tenantX}
    ${next_hop}=  Create Dictionary  next-hop-group  ${next-hop-grp}
    rest add policy                         ${tenantX}      ${tenant2_polname}  
    rest add nexthop group  ${tenantX}  ${next-hop-grp}
    rest add nexthopGroup ip  ${tenantX}  ${next-hop-grp}  ${next-hop-ip}
    rest add policy item example  tenant=${tenantX}  polname=${tenant2_polname}  seqnum=10  action=next-hop  dstdata=${dst_dict}  next-hop=${next_hop}
    rest apply policy on tenant             ${tenantX}      ${tenant2_polname}
    ${redirect-host}=  L3 add host  src_ip=${next-hop-ip}  gw_ip=${next-hop-gw}  port_name=b
    #pause      FREEZZEEEE!
    L3 start hosts  port_name=b
    ${result}=  L3 chk gw arp
    should be true  ${result}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}  src_port=${tcp_port}  dst_port=${tcp_port}  protocol=TCP
    clear stats
    sleep                  5
    start traffic  ${stream}
    sleep                  5
    #pause  FREZZEE!!
    stop traffic   ${stream}
    verify results   c   b
    delete traffic
    sleep  2
    rest remove policy on tenant                ${tenantX}      ${tenant2_polname}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    sleep  2                  
    verify results   c   a
    delete traffic


######  **  ANY need more investigation  **  ########   
T107 policy add/remove redirect(next-hop) from any to dest-tenant
    [Tags]  feature    nhg    T107
    ${dst_dict}=  Create Dictionary  tenant  ${tenantX}
    #${src_dict}=  Create Dictionary  segment  ${vnsX3}  tenant  ${tenantX}
    ${next_hop}=  Create Dictionary  next-hop-group  ${next-hop-grp}
    rest add policy                         ${tenantX}      ${tenant2_polname}  
    rest add nexthop group  ${tenantX}  ${next-hop-grp}
    rest add nexthopGroup ip  ${tenantX}  ${next-hop-grp}  ${next-hop-ip}
    rest add policy item example  tenant=${tenantX}  polname=${tenant2_polname}  seqnum=10  action=next-hop   dstdata=${dst_dict}  next-hop=${next_hop}
    rest apply policy on tenant             ${tenantX}      ${tenant2_polname}
    ${redirect-host}=  L3 add host  src_ip=${next-hop-ip}  gw_ip=${next-hop-gw}  port_name=b
    #pause      FREEZZEEEE!
    L3 start hosts  port_name=b
    ${result}=  L3 chk gw arp
    should be true  ${result}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}  src_port=${tcp_port}  dst_port=${tcp_port}  protocol=TCP
    clear stats
    sleep                  5
    start traffic  ${stream}
    sleep                  5
    #pause  FREZZEE!!
    stop traffic   ${stream}
    verify results   c   b
    delete traffic
    sleep  2
    rest remove policy on tenant                ${tenantX}      ${tenant2_polname}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    sleep  2                  
    verify results   c   a
    delete traffic
    

    
######  **  ANY need more investigation  **  ########   
T108 policy add/remove redirect(next-hop) from any to dest-vns
    [Tags]  feature    T108    nhg
    ${dst_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX}
    #${src_dict}=  Create Dictionary  segment  ${vnsX3}  tenant  ${tenantX}
    
    ${next_hop}=  Create Dictionary  next-hop-group  ${next-hop-grp}
    rest add policy                         ${tenantX}      ${tenant2_polname}  
    rest add nexthop group  ${tenantX}  ${next-hop-grp}
    rest add nexthopGroup ip  ${tenantX}  ${next-hop-grp}  ${next-hop-ip}
    rest add policy item example  tenant=${tenantX}  polname=${tenant2_polname}  seqnum=10  action=next-hop  dstdata=${dst_dict}  next-hop=${next_hop}
    rest apply policy on tenant             ${tenantX}      ${tenant2_polname}
    ${redirect-host}=  L3 add host  src_ip=${next-hop-ip}  gw_ip=${next-hop-gw}  port_name=b
    #pause      FREEZZEEEE!
    L3 start hosts  port_name=b
    ${result}=  L3 chk gw arp
    should be true  ${result}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}  src_port=${tcp_port}  dst_port=${tcp_port}  protocol=TCP
    clear stats
    sleep                  5
    start traffic  ${stream}
    sleep                  5
    #pause  FREZZEE!!
    stop traffic   ${stream}
    verify results   c   b
    delete traffic
    sleep  2
    rest remove policy on tenant                ${tenantX}      ${tenant2_polname}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    sleep  2                  
    verify results   c   a
    delete traffic
    
    

    
######  **  ANY need more investigation  **  ########   
T109 policy add/remove redirect(next-hop) from any to any
    [Tags]  feature    nhg    T109
    #${dst_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX}
    #${src_dict}=  Create Dictionary  segment  ${vnsX3}  tenant  ${tenantX}
    
    ${next_hop}=  Create Dictionary  next-hop-group  ${next-hop-grp}
    rest add policy                         ${tenantX}      ${tenant2_polname}  
    rest add nexthop group  ${tenantX}  ${next-hop-grp}
    rest add nexthopGroup ip  ${tenantX}  ${next-hop-grp}  ${next-hop-ip}
    rest add policy item example  tenant=${tenantX}  polname=${tenant2_polname}  seqnum=10  action=next-hop   next-hop=${next_hop}
    rest apply policy on tenant             ${tenantX}      ${tenant2_polname}
    ${redirect-host}=  L3 add host  src_ip=${next-hop-ip}  gw_ip=${next-hop-gw}  port_name=b
    #pause      FREEZZEEEE!
    L3 start hosts  port_name=b
    ${result}=  L3 chk gw arp
    should be true  ${result}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}  src_port=${tcp_port}  dst_port=${tcp_port}  protocol=TCP
    clear stats
    sleep                  5
    start traffic  ${stream}
    sleep                  5
    #pause  FREZZEE!!
    stop traffic   ${stream}
    verify results   c   b
    delete traffic
    sleep  2
    rest remove policy on tenant                ${tenantX}      ${tenant2_polname}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    sleep  2                  
    verify results   c   a
    delete traffic

    
##Below are for ip and port combination specified at tenant interface
##-------------------------------------##

T110 policy add/remove redirect(next-hop) from src-ip-port to dest-ip-port
    [Tags]  feature  nhg   T110
    ${src_dict}=  Create Dictionary  cidr  ${ixia3_ip}  port  ${tcp_port}
    ${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}  port  ${tcp_port}
    
    ${next_hop}=  Create Dictionary  next-hop-group  ${next-hop-grp}
    rest add policy                         ${tenantX}      ${tenant2_polname}  
    rest add nexthop group  ${tenantX}  ${next-hop-grp}
    rest add nexthopGroup ip  ${tenantX}  ${next-hop-grp}  ${next-hop-ip}
    rest add policy item example  tenant=${tenantX}  polname=${tenant2_polname}  seqnum=10  action=next-hop  srcdata=${src_dict}  dstdata=${dst_dict}  next-hop=${next_hop}
    rest apply policy on tenant             ${tenantX}      ${tenant2_polname}
    ${redirect-host}=  L3 add host  src_ip=${next-hop-ip}  gw_ip=${next-hop-gw}  port_name=b
    #pause      FREEZZEEEE!
    L3 start hosts  port_name=b
    ${result}=  L3 chk gw arp
    should be true  ${result}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    ...                     protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia1_ip}
    should be true  ${result}
    sleep                  5
    start traffic  ${stream}
    sleep                  5
    #pause  FREZZEE!!
    stop traffic   ${stream}
    verify results   c   b
    delete traffic
    sleep  2
    rest remove policy on tenant                ${tenantX}      ${tenant2_polname}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    ...                     protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia1_ip}
    should not be true  ${result}
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    sleep  2                  
    verify results   c   a
    delete traffic


    

T111 policy add/remove redirect(next-hop) from src-ip-port to dest-vns
    [Tags]  smoke  feature  T111  nhg
    ${dst_dict}=  Create Dictionary  segment  ${vnsX1}  tenant  ${tenantX}
    ${src_dict}=  Create Dictionary  cidr  ${ixia3_ip}  port  ${tcp_port}
    
    ${next_hop}=  Create Dictionary  next-hop-group  ${next-hop-grp}
    rest add policy                         ${tenantX}      ${tenant2_polname}  
    rest add nexthop group  ${tenantX}  ${next-hop-grp}
    rest add nexthopGroup ip  ${tenantX}  ${next-hop-grp}  ${next-hop-ip}
    rest add policy item example  tenant=${tenantX}  polname=${tenant2_polname}  seqnum=10  action=next-hop  srcdata=${src_dict}  dstdata=${dst_dict}  next-hop=${next_hop}
    rest apply policy on tenant             ${tenantX}      ${tenant2_polname}
    ${redirect-host}=  L3 add host  src_ip=${next-hop-ip}  gw_ip=${next-hop-gw}  port_name=b
    #pause      FREEZZEEEE!
    L3 start hosts  port_name=b
    ${result}=  L3 chk gw arp
    should be true  ${result}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    ...                     protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    sleep                  5
    start traffic  ${stream}
    sleep                  5
    #pause  FREZZEE!!
    stop traffic   ${stream}
    verify results   c   b
    delete traffic
    sleep  2
    rest remove policy on tenant                ${tenantX}      ${tenant2_polname}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    ...                     protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    sleep  2                  
    verify results   c   a
    delete traffic
    
    
    

T112 policy add/remove redirect(next-hop) from src-ip-port to dest-tenant
    [Tags]  smoke  feature  T112  nhg
    ${dst_dict}=  Create Dictionary  tenant  ${tenantX}
    ${src_dict}=  Create Dictionary  cidr  ${ixia3_ip}  port  ${tcp_port}
    
    ${next_hop}=  Create Dictionary  next-hop-group  ${next-hop-grp}
    rest add policy                         ${tenantX}      ${tenant2_polname}  
    rest add nexthop group  ${tenantX}  ${next-hop-grp}
    rest add nexthopGroup ip  ${tenantX}  ${next-hop-grp}  ${next-hop-ip}
    rest add policy item example  tenant=${tenantX}  polname=${tenant2_polname}  seqnum=10  action=next-hop  srcdata=${src_dict}  dstdata=${dst_dict}  next-hop=${next_hop}
    rest apply policy on tenant             ${tenantX}      ${tenant2_polname}
    ${redirect-host}=  L3 add host  src_ip=${next-hop-ip}  gw_ip=${next-hop-gw}  port_name=b
    #pause      FREEZZEEEE!
    L3 start hosts  port_name=b
    ${result}=  L3 chk gw arp
    should be true  ${result}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    ...                     protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia1_ipsubnet}
    should be true  ${result}
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia2_ipsubnet}
    should be true  ${result}
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia3_ipsubnet}
    should be true  ${result}
    sleep                  5
    start traffic  ${stream}
    sleep                  5
    #pause  FREZZEE!!
    stop traffic   ${stream}
    verify results   c   b
    delete traffic
    sleep  2
    rest remove policy on tenant                ${tenantX}      ${tenant2_polname}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    ...                     protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia1_ipsubnet}
    should not be true  ${result}
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia2_ipsubnet}
    should not be true  ${result}
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia3_ipsubnet}
    should not be true  ${result}
    
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    sleep  2                  
    verify results   c   a
    delete traffic
    
    
    
######  **  ANY need more investigation  **  ########   
T113 policy add/remove redirect(next-hop) from src-ip-port to any
    [Tags]  feature  T113  nhg
    #${dst_dict}=  Create Dictionary  tenant  ${tenantX}
    ${src_dict}=  Create Dictionary  cidr  ${ixia3_ip}  port  ${tcp_port}
    
    ${next_hop}=  Create Dictionary  next-hop-group  ${next-hop-grp}
    rest add policy                         ${tenantX}      ${tenant2_polname}  
    rest add nexthop group  ${tenantX}  ${next-hop-grp}
    rest add nexthopGroup ip  ${tenantX}  ${next-hop-grp}  ${next-hop-ip}
    rest add policy item example  tenant=${tenantX}  polname=${tenant2_polname}  seqnum=10  action=next-hop  srcdata=${src_dict}  next-hop=${next_hop}
    rest apply policy on tenant             ${tenantX}      ${tenant2_polname}
    ${redirect-host}=  L3 add host  src_ip=${next-hop-ip}  gw_ip=${next-hop-gw}  port_name=b
    #pause      FREEZZEEEE!
    L3 start hosts  port_name=b
    ${result}=  L3 chk gw arp
    should be true  ${result}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    ...                     protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    sleep                  5
    start traffic  ${stream}
    sleep                  5
    #pause  FREZZEE!!
    stop traffic   ${stream}
    verify results   c   b
    delete traffic
    sleep  2
    rest remove policy on tenant                ${tenantX}      ${tenant2_polname}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    ...                     protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    sleep  2                  
    verify results   c   a
    delete traffic
    
######  **  ANY need more investigation  **  ########   

T114 policy add/remove redirect(next-hop) from src-tenant to dest-ip-port
    [Tags]  smoke  feature  T114  nhg
    ${src_dict}=  Create Dictionary  tenant  ${tenantX}
    ${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}  port  ${tcp_port}
    
    ${next_hop}=  Create Dictionary  next-hop-group  ${next-hop-grp}
    rest add policy                         ${tenantX}      ${tenant2_polname}  
    rest add nexthop group  ${tenantX}  ${next-hop-grp}
    rest add nexthopGroup ip  ${tenantX}  ${next-hop-grp}  ${next-hop-ip}
    rest add policy item example  tenant=${tenantX}  polname=${tenant2_polname}  seqnum=10  action=next-hop  srcdata=${src_dict}  dstdata=${dst_dict}  next-hop=${next_hop}
    rest apply policy on tenant             ${tenantX}      ${tenant2_polname}
    ${redirect-host}=  L3 add host  src_ip=${next-hop-ip}  gw_ip=${next-hop-gw}  port_name=b
    #pause      FREEZZEEEE!
    L3 start hosts  port_name=b
    ${result}=  L3 chk gw arp
    should be true  ${result}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    ...                     protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia1_ip}
    should be true  ${result}
    sleep                  5
    start traffic  ${stream}
    sleep                  5
    #pause  FREZZEE!!
    stop traffic   ${stream}
    verify results   c   b
    delete traffic
    sleep  2
    rest remove policy on tenant                ${tenantX}      ${tenant2_polname}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    ...                     protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    ${result}=  REST verify fwd icap table  ${leaf0-a}  ${ixia1_ip}
    should not be true  ${result}
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    sleep  2                  
    verify results   c   a
    delete traffic
    
    


T115 policy add/remove redirect(next-hop) from src-vns to dest-ip-port
    [Tags]  smoke  feature  nhg  T115
    ${src_dict}=  Create Dictionary  segment  ${vnsX3}  tenant  ${tenantX}
    ${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}  port  ${tcp_port}
    ${next_hop}=  Create Dictionary  next-hop-group  ${next-hop-grp}
    rest add policy                         ${tenantX}      ${tenant2_polname}  
    rest add nexthop group  ${tenantX}  ${next-hop-grp}
    rest add nexthopGroup ip  ${tenantX}  ${next-hop-grp}  ${next-hop-ip}
    rest add policy item example  tenant=${tenantX}  polname=${tenant2_polname}  seqnum=10  action=next-hop  srcdata=${src_dict}  dstdata=${dst_dict}  next-hop=${next_hop}
    rest apply policy on tenant             ${tenantX}      ${tenant2_polname}
    ${redirect-host}=  L3 add host  src_ip=${next-hop-ip}  gw_ip=${next-hop-gw}  port_name=b
    #pause      FREEZZEEEE!
    L3 start hosts  port_name=b
    ${result}=  L3 chk gw arp
    should be true  ${result}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    ...                     protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    sleep                  5
    start traffic  ${stream}
    sleep                  5
    #pause  FREZZEE!!
    stop traffic   ${stream}
    verify results   c   b
    delete traffic
    sleep  2
    rest remove policy on tenant                ${tenantX}      ${tenant2_polname}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    ...                     protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    sleep  2                  
    verify results   c   a
    delete traffic

######  **  ANY need more investigation  **  ########   
T116 policy add/remove redirect(next-hop) from any to dest-ip-port
    [Tags]  feature  nhg  T116
    ${dst_dict}=  Create Dictionary  cidr  ${ixia1_ip}  port  ${tcp_port}
    ${next_hop}=  Create Dictionary  next-hop-group  ${next-hop-grp}
    rest add policy                         ${tenantX}      ${tenant2_polname}  
    rest add nexthop group  ${tenantX}  ${next-hop-grp}
    rest add nexthopGroup ip  ${tenantX}  ${next-hop-grp}  ${next-hop-ip}
    rest add policy item example  tenant=${tenantX}  polname=${tenant2_polname}  seqnum=10  action=next-hop   dstdata=${dst_dict}  next-hop=${next_hop}
    rest apply policy on tenant             ${tenantX}      ${tenant2_polname}
    ${redirect-host}=  L3 add host  src_ip=${next-hop-ip}  gw_ip=${next-hop-gw}  port_name=b
    #pause      FREEZZEEEE!
    L3 start hosts  port_name=b
    ${result}=  L3 chk gw arp
    should be true  ${result}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    ...                     protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    sleep                  5
    start traffic  ${stream}
    sleep                  5
    #pause  FREZZEE!!
    stop traffic   ${stream}
    verify results   c   b
    delete traffic
    sleep  2
    rest remove policy on tenant                ${tenantX}      ${tenant2_polname}
    ${stream}=             L3 add  name=ix4-to-ix1  flow=c->a  src_ip=10.251.2.2  src_gw=10.251.2.1
    ...                     dst_ip=10.251.1.2  dst_gw=10.251.1.1  src_mac=${ixia1_mac}  dst_mac=${ixia3_mac}
    ...                     protocol=TCP  src_port=${tcp_port}  dst_port=${tcp_port}
    clear stats
    start traffic  ${stream}
    sleep                  5
    stop traffic   ${stream}
    sleep  2                  
    verify results   c   a
    delete traffic
    
    









* Keywords
verify stats true   [Arguments]  ${transmitted_frames}  ${received_frames}  ${stream}  ${stream_name}
    Sleep  1
    ${report}=  fetch port stats  stream=${stream}  
    ${tx_value}=  verify dict key  ${report}  ${stream_name}  ${transmitted_frames}
    ${rx_value}=  verify dict key  ${report}  ${stream_name}  ${received_frames}
    ${in_range}=  ixia verify traffic rate  ${tx_value}  ${rx_value}  10
    Should be true  ${in_range}
    
verify stats false   [Arguments]  ${transmitted_frames}  ${received_frames}  ${stream}  ${stream_name}
    Sleep  1
    ${report}=  fetch port stats  stream=${stream}  
    ${tx_value}=  verify dict key  ${report}  ${stream_name}  ${transmitted_frames}
    ${rx_value}=  verify dict key  ${report}  ${stream_name}  ${received_frames}
    ${in_range}=  ixia verify traffic rate  ${tx_value}  ${rx_value}  10
    Should not be true  ${in_range}


Policy vns interface  [Arguments]  ${seq}  ${action}  ${src}  ${dst} 
	#add inter tenant routing
	#mininet host config
	REST add policy								X		${tenant1_polname}		
	REST add policy item						X		${tenant1_polname}		${seq}		${action}		${src}		${dst}
	REST apply policy on vns					X		${vnsX1}				${tenant1_polname}

Policy vns interface any  [Arguments]  ${seq}  ${action}  ${src} 
	#add inter tenant routing
	#mininet host config
	REST add policy								X		${tenant1_polname}		
	REST add policy item						X		${tenant1_polname}		${seq}		${action}		${src}		
	REST apply policy on vns					X		${vnsX1}				${tenant1_polname}


test setup topology
	#T5 base suite setup
	REST add tenant 								X
	REST add tenant									Y
	REST add tenant									Z
	REST add tenant									system
	REST add vns									X							X1
	REST add vns									X							X2
	REST add vns									X							X3
	REST add vns									Y							Y1
	REST add vns									Z							Z1
	REST add router intf							X							X1
	REST add router intf							X							X2
	REST add router intf							X							X3
	REST add router intf							Y							Y1
	REST add router intf							Z							Z1
	REST add vns ip  								X							X1				10.251.1.1				24	
	REST add vns ip  								X							X2				10.251.2.1				24	
	REST add vns ip  								X							X3				10.251.3.1				24	
	REST add vns ip  								Y							Y1				10.252.1.1				24	
	REST add vns ip  								Z							Z1				10.253.1.1				24	
	REST add interface to vns						X							X1				leaf0-a					${ixia1}	-1
	REST add interface to vns						X							X2				leaf0-a					${ixia3}	-1
	REST add interface to vns						X							X3				leaf0-b					${ixia2}	-1
	REST add interface to vns						Y							Y1				leaf1-a					${ixia4}	-1
	REST add interface to vns						Z							Z1				leaf1-a					${ixia7}	-1
	
	REST add tenant routers intf to system			X
	REST add tenant routers intf to system			Y
	REST add tenant routers intf to system			Z
	REST add system intf to tenant routers 			X
	REST add system intf to tenant routers 			Y
	REST add system intf to tenant routers 			Z

	REST add static routes							X							0.0.0.0/0			 {"tenant": "system"}
	REST add static routes							Y							0.0.0.0/0			 {"tenant": "system"}
	REST add static routes							Z							0.0.0.0/0			 {"tenant": "system"}	
	

test teardown topology
	#delete fabric switch
	REST delete vns ip  							X							X1				10.251.1.1				24	
	REST delete vns ip  							X							X2				10.251.2.1				24	
	REST delete vns ip  							X							X3				10.251.3.1				24	
	REST delete vns ip  							Y							Y1				10.252.1.1				24	
	REST delete vns ip  							Z							Z1				10.253.1.1				24	
	REST delete vns									X							X1
	REST delete vns									X							X2
	REST delete vns									X							X3
	REST delete vns									Y							Y1
	REST delete vns									Z							Z1
	REST delete tenant								X
	REST delete tenant								Y
	REST delete tenant								Z
	REST delete tenant routers intf to system		X
	REST delete tenant routers intf to system		Y
	REST delete tenant routers intf to system		Z
	T5 base suite teardown
	

T5 base suite setup
	base suite setup
	#add fabric switch
	sleep 											5
	${result} = 									CLI verify controller		s1							c1		
	Should Be True									${result}
	${result} = 									CLI verify controller   	s1							c2
	Should Be True									${result}
	${result} = 									CLI verify controller       s2							c1
	Should Be True									${result}
	${result} = 									CLI verify controller       s2							c2
	Should Be True									${result}
	${result} = 									CLI verify controller       s3							c1
	Should Be True									${result}
	${result} = 									CLI verify controller       s3							c2
	Should Be True									${result}
	${result} = 									CLI verify controller       s4							c1
	Should Be True									${result}
	${result} = 									CLI verify controller       s4							c2
	Should Be True									${result}
	${result} = 									CLI verify controller       s5							c1
	Should Be True									${result}
	${result} = 									CLI verify controller       s5							c2
	Should Be True									${result}
	${result} = 									CLI verify controller       s6							c1
	Should Be True									${result}
	${result} = 									CLI verify controller       s6							c2
	Should Be True									${result}		


  
T5 base suite teardown
	#delete fabric switch
	base suite teardown  


verify results   [Arguments]  ${port_1}   ${port_2}  
   ${report}=  fetch port stats
   ${tx_value}=  verify dict key  ${report}  ${port_1}  transmitted_frames
   ${rx_value}=  verify dict key  ${report}  ${port_2}  received_frames
   ${in_range}=  ixia verify traffic rate  ${tx_value}  ${rx_value}  30
   Should be true  ${in_range}
   
   
#verify results   [Arguments]  ${transmitted_frames}  ${received_frames}  ${stream}  ${stream_name}
#    Sleep  5
#    ${report}=  fetch port stats  stream=${stream}  
#    ${tx_value}=  verify dict key  ${report}  ${stream_name}  ${transmitted_frames}
#    ${rx_value}=  verify dict key  ${report}  ${stream_name}  ${received_frames}
#    ${in_range}=  ixia verify traffic rate  ${tx_value}  ${rx_value}
#    Should be true  ${in_range}	
  	
add fabric switch
  rest add switch  spine0  
  rest add dpid  spine0  ${spine0_dpid}
  rest add fabric role  spine0  spine 
  rest add switch  spine1 
  rest add dpid  spine1  ${spine1_dpid}
  rest add fabric role  spine1  spine
  rest add switch  leaf0-a 
  rest add dpid  leaf0-a  ${leaf0a_dpid}
  rest add fabric role  leaf0-a  leaf
  rest add leaf group  leaf0-a  rack0
  rest add switch  leaf0-b 
  rest add dpid  leaf0-b  ${leaf0b_dpid}
  rest add fabric role  leaf0-b  leaf
  rest add leaf group  leaf0-b  rack0
  rest add switch  leaf1-a 
  rest add dpid  leaf1-a  ${leaf1a_dpid}
  rest add fabric role  leaf1-a  leaf
  rest add leaf group  leaf1-a  rack1
  rest add switch  leaf1-b 
  rest add dpid  leaf1-b  ${leaf1b_dpid}
  rest add fabric role  leaf1-b  leaf
  rest add leaf group  leaf1-b  rack1
  rest add switch  leaf2-a 
  rest add dpid  leaf2-a  ${leaf2a_dpid}
  rest add fabric role  leaf2-a  leaf
  rest add leaf group  leaf2-a  rack2
  rest add switch  leaf2-b 
  rest add dpid  leaf2-b  ${leaf2b_dpid}
  rest add fabric role  leaf2-b  leaf
  rest add leaf group  leaf2-b  rack2
  
delete fabric switch  
  rest delete fabric switch  spine0 
  rest delete fabric switch  spine1 
  rest delete fabric switch  leaf2-a 
  rest delete fabric switch  leaf2-b 
  rest delete fabric switch  leaf0-a 
  rest delete fabric switch  leaf0-b 
  rest delete fabric switch  leaf1-a 
  rest delete fabric switch  leaf1-b 


test teardown
  delete traffic
